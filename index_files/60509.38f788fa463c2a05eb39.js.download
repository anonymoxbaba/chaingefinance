(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[60509],{749028:(e,t,s)=>{"use strict";s.d(t,{isSignedExchangeAgreement:()=>a,saveExchangeAgreement:()=>o});var i=s(702598),r=s(296638);function o(e){return(0,i.fetch)("/exchange-agreement/",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then((e=>e.ok?e.json():e.json().then((t=>{throw new r.AggregateError((0,r.accumulateErrors)(t.errors,e.status))}))))}const n={};async function a(e){let t="/is-signed-exchange-agreement/";if(e.exchange&&(t+=`?exchange=${e.exchange}`,n[e.exchange]))return n[e.exchange];const s=await(0,i.fetch)(t);if(!s.ok){const e=await s.json();throw Error(e.detail)}const r=await s.json();return e.exchange&&(n[e.exchange]=r),r}},585627:(e,t,s)=>{"use strict";s.d(t,{solutionIds:()=>i})
;const i=JSON.parse('{"EXTENDED_HOURS":43000502023,"PRE_MARKET":43000502023,"POST_MARKET":43000502023,"SPREAD_CHARTS":43000502298,"ALERTS":43000520149,"ALERT_ON_STRATEGY":43000481368,"ALERT_WEBHOOK":43000529348,"ALERT_DESCRIPTION_PLACEHOLDER":43000531021,"ALERT_RECEIVE_NOTIFICATIONS_OH_PHONE":43000474389,"ALERT_USE_ALTERNATIVE_EMAIL":43000474394,"ALERT_WEBHOOK_CREDENTIALS":43000722015,"VOLUME_PROFILE":43000502040,"VOLUME_PROFILE_INDICATOR":43000557450,"RENKO":43000481040,"KAGI":43000502272,"LINE_BREAK":43000502273,"PNF":43000502276,"FINANCIAL_DATA":43000543506,"BROKER_RATING":43000542490,"CRYPTO_MARKET_CAP":43000540941,"CRYPTO_PAYMENT":43000485536,"ALERT_ON_SPREAD":43000478406,"ALERT_ON_LOG_SCALE":43000690942,"ALERT_ON_CUSTOM_SCRIPT":43000478415,"ALERT_FUNCTION":43000597494,"SMS_VERIFICATION":43000553429,"MAGNET_MODE":43000537270,"PRIVACY_SETTINGS":43000548335,"PUBLICATION_TYPE":43000609497,"SCRIPT_ACCESS":43000482573,"FREE_USER_FAQS":43000590947,"STRATEGY_UNREALISTIC_RESULTS":43000481029,"STRATEGY_FUTURE_DATA":43000614705,"STREAM_RULES":43000591348,"HOW_TO_USE_PAPER":43000516466,"HOW_TO_USE_CQG":43000516372,"HOW_TO_USE_OANDA":43000516375,"HOW_TO_USE_FOREXCOM":43000516374,"FAVORITE_IDEA":43000555216,"YOUTUBE_ERROR":43000612153,"AUTHORS_INSTRUCTIONS_PUBCLICATION":43000549951,"AUTHORS_INSTRUCTIONS_EDIT":43000614618,"SCRIPT_INSTRUCTIONS":43000482573,"BAR_REPLAY_UNAVAILABILITY":43000475470,"WHAT_IS_CBOE_BZX_EXCHANGE":43000473924,"GOPRO_UPGRADE_DESCRIPTION":43000473324,"GOPRO_DOWNGRADE_DESCRIPTION":43000485437,"GOPRO_RENEW_ANNUAL_MONTHLY_DESCRIPTION":43000644491,"FINANCIALS_OWNERSHIP":43000699479,"FINANCIALS_VALUATION_SUMMARY":43000699484,"FINANCIALS_VALUATION_RATIOS":43000699495,"FINANCIALS_GROWTH_AND_PROFITABILITY":43000699485,"FINANCIALS_REVENUE_TO_PROFIT_CONVERSION":43000699496,"FINANCIALS_REVENUE_BREAKDOWN_BY_SOURCE":43000699487,"FINANCIALS_REVENUE_BREAKDOWN_BY_COUNTRY":43000699497,"FINANCIALS_REVENUE_ESTIMATES":43000699489,"FINANCIALS_EARNINGS_ESTIMATES":43000699498,"FINANCIALS_DIVIDEND_SUMMARY":43000699500,"FINANCIALS_DIVIDEND_HISTORY":43000699501,"FINANCIALS_DEBT_LEVEL":43000699502,"FINANCIALS_POSITION":43000699503,"BROKERAGE_REVIEWS":43000591351,"CHANGE_SUBSCRIPTION":43000635806,"PINE_LIBRARY_INFO":43000638371,"HOW_TO_CREATE_A_STREAM":43000646171,"HOW_DO_I_UPDATE_DESKTOP_APP":43000647779,"TECHNICAL_RATINGS":43000614331,"BACKTESTING_WIDGET":43000562362,"BACKTESTING_NO_DATA":43000478450,"BACKEND_CONNECTIONS":43000694474,"DEEP_BACKTESTING_WIDGET":43000670566,"DEEP_BACKTESTING":43000666199,"DEEP_BACKTESTING_AVAILABLE_DATA":43000668210,"BETA_BROKERS":43000673434,"VIDEO_UPLOAD_FAILED":43000666607,"VIDEO_DEVICE_ACCESS":43000677209,"PUBLIC_INVITE_ONLY_SCRIPTS":43000614617,"PRIVATE_INVITE_ONLY_SCRIPTS":43000614617,"HOW_DOES_BRACKETS_MANAGEMENT_WORK":43000631987,"HOW_TO_SEE_THE_DEEPEST_HIST_DATA":43000687053,"I_CANT_SEE_ALL_HIST_DATA_ON_RES_LOWER_THAN_DAY":43000480679,"IDEAS_ON_CHART":43000694285,"GET_A_REFUND":43000485430,"USE_SETTLEMENT_AS_CLOSE_ON_DAILY_INTREVAL":43000685268,"ADJUST_FOR_CONTRACT_CHANGES":43000685266,"SWITCHING_CONTINUOUS_FUTURES_CONTRACTS":43000689313,"ADJUST_DATA_FOR_DIVIDENDS":43000590597,"WHY_IS_MY_ACCOUNT_BANNED":43000674726,"HOW_TO_PUBLISH_A_VIDEO_IDEA":43000476752,"WHAT_ARE_TRADINGVIEW_LIVE_STREAMS_BEST_PRACTICES":43000685377,"TELL_ME_MORE_ABOUT_THE_COMMUNITY_SCRIPTS":43000558522,"HOW_TO_POST_AWESOME_IDEAS_AND_GET_LOTS_OF_LIKES":43000603748,"ABOUT_EXPERT_PLAN":43000677382,"CONNECTIONS_LIMIT_EXCEEDED":43000693877,"ACCOUNT_RECOVERY":43000619597,"HOW_TO_SYNC_CHARTS_ON_LAYOUT":43000629992,"HOW_TO_SEE_BUILTIN_INDICATOR_SOURCE":43000481659,"HOW_CAN_I_GET_ACCESS_TO_STREAMS":43000685376,"MULTI_CHART_MODE":43000629990,"QUICK_SEARCH":43000659671,"WHATS_AN_INDICATOR":43000543626,"CHART_TYPES":43000703407,"DRAWING_TOOLS":43000703396,"CUSTOM_INTERVALS":43000543883,"CUSTOM_RANGE_BARS":43000474007,"CANDLESTICK_PATTERNS":43000584462,"MULTI_TIMEFRAME_CHARTS":43000502591,"BAR_REPLAY":43000712747,"PINE_SCRIPT":43000561836,"SCREENER_OVERVIEW":43000635796,"STREAMS_OBS_SETUP":43000639464,"AUTO_CHART_PATTERNS":43000690464,"HOW_TO_PROTECT_YOUR_ACCOUNT":43000582277,"PLUS_BUTTON":43000645256,"PLAN_UPGRADED_BUT_DATA_STILL_DELAYED":43000471705,"WHY_TAX_HAS_BEEN_ADDED_TO_MY_BILL":43000684741,"COMPARE_SYMBOLS_TOOL":43000543053,"SAVED_CHART":43000692404,"CUSTOM_INDICATOR":43000543048,"BIST_MIXED_SUBSCRIPTION":43000609137,"WHY_RENKO_NOT_WORK":43000711502,"ALERTS_SEPARATION_BY_TYPE":43000696403,"HOW_TO_SET_UP_ALERTS":43000595315,"PINE_SCRIPT_STRATEGIES":43000562362,"ECONOMIC_CALENDAR":43000707391,"SCRIPT_PUBLISHING_RULES":43000590599,"DIFFERENCE_BETWEEN_PRO_AND_NONPRO_PLANS":43000677382,"HOW_TO_USE_MINDS":43000690226,"HOW_TO_USE_TRADINGVIEW_CHAT":43000604448,"PAPER_COMPETITION":43000593579,"PAPER_COMPETITION_ACCOUNT":43000721315,"PAPER_COMPETITION_PRIZE":43000721317,"PAPER_COMPETITION_FREE_ACCOUNT":43000721310,"PUBLISHING_AND_UPDATING_IDEAS":43000591338,"USING_MINDS":43000696301,"PUBLISH_VIDEO_IDEA":43000476752,"STREAM_GUIDE":43000646171,"TAROT_DECK":43000724020,"VAT_NUMBER_GUIDE":43000721910,"AVAILABLE_COMPETITION_INSTRUMENTS":43000721311,"PINE_PERFORMANCE_PROFILER":43000725216,"PINE_LOGS_INFO":43000710876,"INDICATORS":43000474048,"CHART_DATA_EXPORT":43000537255,"TIME_PRICE_OPPORTUNITIES":43000713306,"TICK_INTERVALS":43000709225,"VOLUME_FOOTPRINT":43000726164,"VOLUME_CANDLES":43000724995,"HEIKIN_ASHI":43000619436,"HLC_AREA":43000709062,"BASELINE":43000690232,"HIGH_LOW":43000677196,"COLUMNS":43000673912}')
},691805:(e,t,s)=>{"use strict";s.d(t,{appendScript:()=>r});var i=s(503031);function r(e){const t=document.createElement("script");t.async=!0,t.src=e;const s=(0,i.getCspNonce)();return s&&t.setAttribute("nonce",s),document.head.appendChild(t),t}},261030:(e,t,s)=>{"use strict";s.d(t,{CookieSettings:()=>i,bannerPrivacyPreferenceKey:()=>p,checkBannerPrivacyPreferenceKey:()=>C,cookieSettingsChangeEvent:()=>d,cookieSettingsReady:()=>u,getCookieSetting:()=>V,hideBanner:()=>I,isBannerVisible:()=>R,notApplicateBanner:()=>x,setCookieSetting:()=>E,showBanner:()=>T});var i,r=s(251954),o=s(955273),n=s(49437),a=s(66974),l=s(181706);!function(e){e.Analytics="analytics",e.Advertising="advertising"}(i||(i={}));const d="cookie_settings_changed",u=(0,o.createDeferredPromise)(),h=window.location.hostname.split("."),c=(0,a.isLocal)()?"":"."+h.slice(1,h.length).join("."),_="cookieBanner",p=(0,a.isProd)()?"cookiePrivacyPreferenceBannerProduction":"cookiePrivacyPreferenceBannerLocal",S="accepted",m="ignored",y="notApplicable",v="cookiesSettings",g="localCookiesSettings",b="cookiePrivacyPreferenceBanner",f={[i.Analytics]:!1,[i.Advertising]:!1};function w(){return n.TVLocalStorage.removeItem(_)}function P(e){return n.TVLocalStorage.getItem(e)===S||n.TVLocalStorage.getItem(e)===y}function C(){return e=p,l.get(e)===S||l.get(e)===y;var e}function I(){A(S)}function T(){A(m)}function x(){A(y)}function A(e){l.set(p,e,3653,"/",c)}function R(){return l.get(p)===m}function E(e,t){f[e]=t,l.set((0,a.isProd)()?v:g,JSON.stringify(f),3653,"/",c),r.emit(d,e,t)}function V(e){return f[e]}function D(){return n.TVLocalStorage.removeItem(b)}!function(){const e=l.get((0,a.isProd)()?v:g),t=n.TVLocalStorage.getItem(b),s=n.TVLocalStorage.getItem(v);if(e){t&&s&&(D(),n.TVLocalStorage.removeItem(v)),P(_)&&w();try{const t=JSON.parse(e);f[i.Analytics]=(null==t?void 0:t[i.Analytics])||!1,f[i.Advertising]=(null==t?void 0:t[i.Advertising])||!1}catch(e){}}else if(P(_)&&(E(i.Analytics,!0),E(i.Advertising,!0),I(),w()),t&&s){const e=JSON.parse(s);A(t),E(i.Analytics,null==e?void 0:e[i.Analytics]),E(i.Advertising,null==e?void 0:e[i.Advertising]),D(),n.TVLocalStorage.removeItem(v)}}()},503031:(e,t,s)=>{"use strict";function i(){const e=document.querySelector("script[nonce]");if(null!==e)return e.getAttribute("nonce")||e.nonce}s.d(t,{getCspNonce:()=>i})},359663:(e,t,s)=>{"use strict";s.d(t,{FeatureToggleWatchedValue:()=>o});var i=s(125226),r=s(375397);class o extends r.WatchedValue{constructor(e,t){super(function(e,t){return(0,i.isFeatureEnabled)(e)}(e)),(0,i.onFeaturesStateChanged)().subscribe(this,(t=>{e===t&&this.setValue((0,i.isFeatureEnabled)(e))}))}destroy(){(0,i.onFeaturesStateChanged)().unsubscribeAll(this),super.destroy()}}},76107:(e,t,s)=>{"use strict";s.d(t,{getCSSProperty:()=>a,getCSSPropertyNumericValue:()=>l,getContentWidth:()=>o,getScrollbarWidth:()=>i,matchMediaMinMax:()=>r,setStyle:()=>n});const i=(()=>{let e;return()=>{var t;if(void 0===e){const s=document.createElement("div"),i=s.style;i.visibility="hidden",i.width="100px",i.msOverflowStyle="scrollbar",
document.body.appendChild(s);const r=s.offsetWidth;s.style.overflow="scroll";const o=document.createElement("div");o.style.width="100%",s.appendChild(o);const n=o.offsetWidth;null===(t=s.parentNode)||void 0===t||t.removeChild(s),e=r-n}return e}})();function r(e,t){return t===1/0?window.matchMedia(`(min-width: ${e}px)`):window.matchMedia(`(min-width: ${e}px) and (max-width: ${t}px)`)}function o(e){return l(e,"width")-l(e,"padding-left")-l(e,"padding-right")}function n(e,t,s){null!==e&&e.style.setProperty(t,s)}function a(e,t){return getComputedStyle(e,null).getPropertyValue(t)}function l(e,t){return parseInt(a(e,t))}},875049:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var i=s(345848);const r={filterNamesMap:{script_type:"Indicators and Strategies","script_type-indicators":"Indicators","script_type-strategies":"Strategies",stream:"All Markets","stream-stocks":"Stocks","stream-indices":"Indices","stream-commodities":"Commodities","stream-currencies":"Currencies","stream-bitcoin":"Bitcoin","interval-all":"All Intervals","interval-m":"Short Term","interval-h":"Medium Term","interval-dwm":"Long Term","sort-unmoderated":"Unmoderated","sort-trending":"Trending","sort-discussed":"Most Discussed","sort-viewed":"Most Viewed","sort-agreed":"Most Agreed","sort-suggested":"Suggested","sort-recent":"All Ideas","time-day":"Today","time-week":"This Week","time-month":"This Month","time-all":"All Time","by-everyone":"Everyone","by-following":"Following","by-me":"My Ideas"},goProFeaturesMap:{customIntervals:"Add Custom Interval",intradaySpread:"Inraday Spread",kagiRenko:"Japanese Intraday Chart",alerts:{prefix:"New Alerts Limit",widget:"Widget",chart:"Chart Header"},multipleCharts:"Multiple Charts Layout",savedChartsLimit:"Save Chart Limit",studyLimit:"Studies Limit",multipleWatchLists:{prefix:"Watchlists",new:"Create New List",rename:"Rename List",saveAs:"Save List As"},importWatchlist:"Watchlists Import Watchlist",exportWatchlist:"Watchlists Export Watchlist",BATSExchangePopup:"BATS Exchange Popup",DataQualityPopup:"Data Quality Popup",FreeDelayPopup:"Free Delay Popup",proRTProduct:"Volume Profile",studyOnStudy:"Unlimited Study on Study"},trackFeature:{savedChartsLimit:!0,BATSExchangePopup:!0,FreeDelayPopup:!0,DataQualityPopup:!0,intradaySpread:!0,studyOnStudy:!0},trackGoPro:function(e,t,s){s&&!t&&(t=s,s=null);var o=r.goProFeaturesMap[t];if(o){if(s){if("string"==typeof o)return;o="{0} {1}".format(o.prefix,o[s])}(0,i.trackEvent)(e,o)}}},o=r},405117:(e,t,s)=>{"use strict";s.d(t,{trackGoProFeature:()=>r});var i=s(875049);function r(e,t){i.default.trackGoPro("Gopro Features",e,t)}},192914:(e,t,s)=>{"use strict";s.d(t,{MarketStatusModel:()=>c});var i=s(650151),r=s(375397),o=s(643322),n=s(975179),a=s(814771),l=s(870045);class d{constructor(e,t){this._utcTime=new r.WatchedValue(null),this._expired=new r.WatchedValue(!1),this._sessionSpec=new r.WatchedValue(null),this._sessionSpecCache=null,this._utcDayStart=new Date(0),this._timeoutId=null,this._expiredBySymbolInfoTypespecs=!1,this._expiredByQuotesTypespecs=null,
this._marketStatusSpawn=e.spawn(),this._quotesUpdate=t,this._quotesUpdate.subscribe(this,this._onQuotesUpdate)}destroy(){this._marketStatusSpawn.destroy(),this._clearTimeoutIfNeeded(),this._quotesUpdate.unsubscribeAll(this)}reset(){this._expiredBySymbolInfoTypespecs=!1,this._expiredByQuotesTypespecs=null,this._utcTime.setValue(null),this._expired.setValue(!1)}utcTime(){return this._utcTime.readonly()}expired(){return this._expired.readonly()}utcDayStart(){return this._utcDayStart}sessionSpec(){return this._sessionSpec.readonly()}setSymbolInfo(e){var t;if(this._clearTimeoutIfNeeded(),null===e||!(0,n.isFuturesContractSymbol)(e)||void 0===e.expiration)return this._utcTime.setValue(null),void this._expired.setValue(!1);null!==this._sessionSpecCache&&this._sessionSpecCache.timezone===e.timezone&&this._sessionSpecCache.session===e.session&&this._sessionSpecCache.corrections===e.corrections&&this._sessionSpecCache.holidays===e.session_holidays||(this._sessionSpecCache={timezone:e.timezone,session:e.session,corrections:e.corrections,holidays:e.session_holidays,spec:new a.SessionSpec(e.timezone,e.session,e.session_holidays,e.corrections)},this._sessionSpec.setValue(null));const s=this._sessionSpecCache.spec;this._utcDayStart=function(e){const t=Math.floor(e/1e4)%1e4,s=Math.floor(e/100)%100-1,i=e%100;return new Date(Date.UTC(t,s,i))}(e.expiration);const i=s.bordersOfDailyBar(this._utcDayStart);if(null===i)return this._utcTime.setValue(null),this._expired.setValue(!1),void this._sessionSpec.setValue(s);const r=(0,l.get_timezone)(e.timezone);this._utcTime.setValue((0,l.cal_to_utc)(r,i.to)+1e3),this._sessionSpec.setValue(s),this._expiredBySymbolInfoTypespecs=Boolean(null===(t=e.typespecs)||void 0===t?void 0:t.includes("expired")),this._updateExpired()}_updateExpired(){this._clearTimeoutIfNeeded();const e=this._utcTime.value();if(null===e)return;if(this._expiredByQuotesTypespecs||this._expiredBySymbolInfoTypespecs)return void this._expired.setValue(!0);const t=window.ChartApiInstance.serverTime();let s;switch(this._marketStatusSpawn.value()){case"out_of_session":case"holiday":s=e-3e5-t;break;case"market":case"pre_market":case"post_market":s=e+3e5-t;break;default:s=e-t}s>0&&(this._timeoutId=setTimeout((()=>this._updateExpired()),Math.min(2e9,s))),this._expired.setValue(s<=0)}_clearTimeoutIfNeeded(){null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}_onQuotesUpdate(e,t){var s,i;let r=!1;if(null===this._expiredByQuotesTypespecs)this._expiredByQuotesTypespecs=Boolean(null===(s=e.values.typespecs)||void 0===s?void 0:s.includes("expired")),r=this._expiredByQuotesTypespecs;else if(void 0!==t.values.typespecs){const e=Boolean(null===(i=t.values.typespecs)||void 0===i?void 0:i.includes("expired"));r=this._expiredByQuotesTypespecs!==e,this._expiredByQuotesTypespecs=e}r&&null!==this._utcTime.value()&&this._updateExpired()}}function u(e){return window.ChartApiInstance.serverTime()/1e3-e}function h(e,t,s){return e<=s?t<=s?1/0:t/1e3:Math.min(e,t)/1e3}class c{constructor(e){var t,s
;this._currentSession=new r.WatchedValue(null),this._delistedByTypespecs=new r.WatchedValue(!1),this._sessionsSpec=null,this._nextSessionEdgeInternal=null,this._nextSessionEdge=new r.WatchedValue(null),this._recalcNextSessionEdgeTimerId=null,this._delay=0,this._futuresContractExpirationTime=null,this._quotesProvider=e,this._futuresContractExpirationTime=new d(this._currentSession.readonly(),e.quotesUpdate()),e.quoteSymbolChanged().subscribe(this,(()=>{(0,i.ensureNotNull)(this._futuresContractExpirationTime).reset(),this._nextSessionEdgeInternal=null,this._recalculateNextSessionEdge()})),this._marketStatus=(0,o.combine)(((e,t,s)=>null===e?e:t?"delisted":s?"expired":function(e){switch(e){case"market":return"market";case"pre_market":return"pre_market";case"post_market":return"post_market";case"out_of_session":return"out_of_session";case"holiday":return"holiday"}(0,i.ensureNever)(e)}(e)),this._currentSession.weakReference(),this._delistedByTypespecs.weakReference(),(null!==(s=null===(t=this._futuresContractExpirationTime)||void 0===t?void 0:t.expired())&&void 0!==s?s:new r.WatchedValue(!1)).weakReference()),e.quotesUpdate().subscribe(this,(e=>{var t;this._currentSession.setValue(null!==(t=null==e?void 0:e.values.current_session)&&void 0!==t?t:null)})),e.quoteSymbolChanged().subscribe(this,(()=>{this._currentSession.setValue(null)}))}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.quoteSymbolChanged().unsubscribeAll(this),null!==this._recalcNextSessionEdgeTimerId&&clearTimeout(this._recalcNextSessionEdgeTimerId),(0,i.ensureNotNull)(this._futuresContractExpirationTime).destroy(),this._marketStatus.destroy()}futuresContractExpirationTime(){return this._futuresContractExpirationTime}setSymbolInfo(e){var t,s,r,o,l,d;if((0,i.ensureNotNull)(this._futuresContractExpirationTime).setSymbolInfo(e),this._nextSessionEdgeInternal=null,null===e)return void(this._sessionsSpec=null);this._delay=(0,n.getSymbolDelaySeconds)(e);const u=new a.SessionSpec(e.timezone,null!==(t=e.session_display)&&void 0!==t?t:e.session,e.session_holidays,e.corrections);let h,c;const _=null===(s=e.subsessions)||void 0===s?void 0:s.find((e=>"premarket"===e.id)),p=null===(r=e.subsessions)||void 0===r?void 0:r.find((e=>"postmarket"===e.id));void 0!==_&&(h=new a.SessionSpec(e.timezone,null!==(o=_["session-display"])&&void 0!==o?o:_.session,e.session_holidays,_["session-correction"])),void 0!==p&&(c=new a.SessionSpec(e.timezone,null!==(l=p["session-display"])&&void 0!==l?l:p.session,e.session_holidays,p["session-correction"])),this._delistedByTypespecs.setValue(Boolean(null===(d=e.typespecs)||void 0===d?void 0:d.includes("discontinued"))),this._sessionsSpec={general:u,preMarket:h,postMarket:c},this._recalculateNextSessionEdge()}status(){return this._marketStatus}currentSession(){return this._currentSession}nextSessionEdge(){return this._nextSessionEdge}_getNextSessionEdgeInternal(){var e;if(null===this._sessionsSpec||"24x7"===this._sessionsSpec.general.spec())return null;const t=1e3*u(this._delay)
;if(null===this._nextSessionEdgeInternal||(null!==(e=this._nextSessionEdgeInternal.timestamp)&&void 0!==e?e:1/0)<=t/1e3){const{general:e,preMarket:s,postMarket:i}=this._sessionsSpec,r=(0,l.get_timezone)(e.timezone()),o=(0,l.utc_to_cal)(r,t),n=h((0,l.cal_to_utc)(r,e.alignToNearestSessionStart(o,1)),(0,l.cal_to_utc)(r,e.alignToNearestSessionEnd(o,1)),t),a=h(void 0!==s?(0,l.cal_to_utc)(r,s.alignToNearestSessionStart(o,1)):1/0,void 0!==s?(0,l.cal_to_utc)(r,s.alignToNearestSessionEnd(o,1)):1/0,t),d=h(void 0!==i?(0,l.cal_to_utc)(r,i.alignToNearestSessionStart(o,1)):1/0,void 0!==i?(0,l.cal_to_utc)(r,i.alignToNearestSessionEnd(o,1)):1/0,t);let c=Math.min(n,a,d);if(c===1/0){const t=u(this._delay),s=6e4,i=new Date(Math.round(new Date(1e3*t).getTime()/s)*s).getTime()+s,o=(0,l.utc_to_cal)(r,i),n=h((0,l.cal_to_utc)(r,e.alignToNearestSessionStart(o,1)),(0,l.cal_to_utc)(r,e.alignToNearestSessionEnd(o,1)),i),_=Math.min(n,a,d);_!==1/0?(this._nextSessionEdgeInternal={timestamp:c},c=_):this._nextSessionEdgeInternal={timestamp:null}}this._nextSessionEdgeInternal=c===d?{timestamp:c,status:"post_market"}:c===a?{timestamp:c,status:"pre_market"}:{timestamp:c}}return this._nextSessionEdgeInternal}_recalculateNextSessionEdge(){const e=this._getNextSessionEdgeInternal();if(null===e||null===e.timestamp)return void this._nextSessionEdge.setValue(null);const t={status:e.status,remainingSeconds:Math.max(0,e.timestamp-u(this._delay))};if(null===this._recalcNextSessionEdgeTimerId){const e=Number.isFinite(t.remainingSeconds)?Math.ceil(t.remainingSeconds%60):1;this._recalcNextSessionEdgeTimerId=setTimeout((()=>this._recalculateNextSessionEdgeByTimer()),1e3*e)}this._nextSessionEdge.setValue(t)}_recalculateNextSessionEdgeByTimer(){this._recalcNextSessionEdgeTimerId=null,this._recalculateNextSessionEdge()}}},525714:(e,t,s)=>{"use strict";s.d(t,{CRUCIAL_REALTIME_BATS:()=>h,DELAY_WITHOUT_AGREEMENT:()=>c,firstReplacedByBatsExchange:()=>_,getExchange:()=>f,isDelay:()=>S,isDelayForGuest:()=>v,isDelayWithoutMarketAgreement:()=>g,isEod:()=>p,isTVCalculatedPairSymbol:()=>b,isTickByTick:()=>y,witoutRealtime:()=>m});var i=s(650151),r=s(268552),o=s.n(r),n=s(778016),a=s(519073);const l=["DJ","JSE","BELEX"],d=["NZX"],u=["BIVA"],h=["AMEX","NASDAQ","NYSE"],c=["ICESG","TURQUOISE","TAIFEX","FINRA","FINRA_ATDS_BONDS","FINRA_BTDS_BONDS"];function _(e){const t=o().getExchanges(e.pro_name),s=o().getExchanges(e.full_name);for(let e=0;e<s.length;++e)if("BATS"===s[e].toUpperCase())return t[e];return null}function p(e,t){return o().hasEodSymbols(e.full_name)||6===t}function S(e){return void 0!==e&&e>0}function m(e){return"index"===e.type&&l.includes(e.listed_exchange)||"futures"===e.type&&d.includes(e.listed_exchange)||u.includes(e.listed_exchange)}function y(e,t){return!((0,n.enabled)("TICK_BY_TICK_PUSH_DATA")||S(e.delay)||p(e,t)||(0,a.hasCryptoTypespec)(e.typespecs||[]))}function v(e,t){return t.listed_exchange===e&&!window.is_authenticated}function g(e){return c.includes(e.listed_exchange)}function b(e){var t,s
;return null!==(s=null===(t=e.typespecs)||void 0===t?void 0:t.includes("tv-calculated-pair"))&&void 0!==s&&s}async function f(e){{const t=(0,i.ensureDefined)(window.pro);await new Promise((e=>{t.runOrUpdate(e)}));const s=t.getProduct(function(e){return`exchange-${e.pro_perm}`}(e)),r=function(e){let t;if(!window.pro)throw new Error("Pro module not defined");t=window.pro.getProductsByType(window.pro.PRODUCT_TYPES.exchange).find((t=>{var s;return Boolean(null===(s=t.included_exchanges)||void 0===s?void 0:s.includes(e))}));return t||null}(s.exchange||"");return r&&["cme-full","us-stocks","finra"].includes(r.exchange)?s:r||s}}},430597:(e,t,s)=>{"use strict";s.d(t,{extrapolateBarsFrontByCount:()=>o,extrapolateBarsFrontToTime:()=>r});var i=s(316767);function r(e,t,s,i,o=!1){if(t>s){const n=r(e,s,t,i,o);return n.count=-n.count,n}return n(e,t,1,((e,t)=>t>s||0!==i&&e>i),o)}function o(e,t,s,i=!1){const r=s<0?-1:1;return n(e,t,r,((e,t)=>e>=s*r),i)}function n(e,t,s,r,o){let n=0,a=t;e.moveTo(a);let l=0,d=Number.MAX_VALUE,u=!1,h=t;const c=[];for(;!r(n,a);){if(l>15)throw new Error("Internal error 0x10 while extrapolating.");const r=e.indexOfBar(a);if(r===i.SessionStage.PRE_SESSION&&1===s)a=e.startOfBar(0),e.moveTo(a);else if(r===i.SessionStage.PRE_SESSION&&-1===s)a=e.startOfBar(i.SessionStage.PRE_SESSION),e.moveTo(a);else if(r===i.SessionStage.POST_SESSION&&1===s)a=e.startOfBar(i.SessionStage.POST_SESSION),e.moveTo(a);else{if(r===i.SessionStage.POST_SESSION&&-1===s)throw new Error("Internal error 0x12 while extrapolating.");{const _=e.startOfBar(r);if(_>t&&s>0||t>_&&s<0){if(u&&d===_)throw new Error("Internal error 0x11 while extrapolating.");u=!0,d=_,l=0,n++,h=_,o&&c.push(h)}if(0===r&&-1===s)a=_-1;else{a=e.startOfBar(r+s);const t=e.startOfBar(i.SessionStage.POST_SESSION);a>t&&(e.moveTo(t),a=e.startOfBar(0))}}}l++}return{time:h,times:c,count:n}}},655988:(e,t,s)=>{"use strict";s.d(t,{ComputedTimePointWeights:()=>n});var i=s(828473);function r(e,t){for(let s=0;s<t;s+=1)e.push({timePointIndex:NaN,left:NaN,center:NaN,right:NaN})}class o{constructor(){this._invalidatedFromIndex=0,this._maxIndexWithWeight=null,this._items=[],this._weightsMap=new Map}setWeight(e,t){this._invalidatedFromIndex=Math.min(this._invalidatedFromIndex,e),this._weightsMap.set(e,t),null===this._maxIndexWithWeight?this._maxIndexWithWeight=e:this._maxIndexWithWeight=Math.max(this._maxIndexWithWeight,e)}deleteItemByIndex(e){this._weightsMap.delete(e)&&(this._invalidatedFromIndex=Math.min(this._invalidatedFromIndex,e))}totalWeight(e){if(null===this._maxIndexWithWeight)return e;const t=e%1>=.5?Math.ceil(e):Math.floor(e),s=e-t;if(t>=this._invalidatedFromIndex){const e=this._invalidatedFromIndex;let s=this._items[e-1];const i=Math.min(this._maxIndexWithWeight,t);this._createItems(i);for(let t=e;t<=i;++t)s=this._fillItem(t,s);this._invalidatedFromIndex=i+1}if(t>this._maxIndexWithWeight){return this._items[this._maxIndexWithWeight].barEndTotal+(t-this._maxIndexWithWeight-.5)+s}const i=this._items[t];return i.barCenterTotal+i.weight*s}rangeWeight(e,t){const s=[]
;if(null===this._maxIndexWithWeight)return[{index:e,barStartTotal:e-.5,barCenterTotal:e,barEndTotal:e+.5,weight:1}];if(e<this._invalidatedFromIndex){const i=Math.min(this._invalidatedFromIndex-1,t);for(let t=e;t<=i;t+=1)s.push(this._items[t])}if(t>=this._invalidatedFromIndex){const i=this._invalidatedFromIndex;let r=this._items[i-1];const o=Math.min(this._maxIndexWithWeight,t);this._createItems(o);for(let t=i;t<=o;++t)r=this._fillItem(t,r),t>=e&&s.push(r);this._invalidatedFromIndex=o+1}return 0===s.length&&s.push(this._items[this._maxIndexWithWeight]),s}index(e){if(null===this._maxIndexWithWeight)return e;if(0!==this._invalidatedFromIndex&&this._items[this._invalidatedFromIndex-1].barEndTotal-.001>=e){const t=(0,i.lowerbound)(this._items,e,((e,t)=>e.barEndTotal-.001<t),0,this._invalidatedFromIndex),s=this._items[t];return t+(e-s.barCenterTotal)/s.weight}if(this._invalidatedFromIndex<=this._maxIndexWithWeight){const t=this._invalidatedFromIndex;let s=this._items[t-1];this._createItems(this._maxIndexWithWeight);for(let i=t;i<=this._maxIndexWithWeight;++i)if(s=this._fillItem(i,s),s.barEndTotal>e)return this._invalidatedFromIndex=i+1,i+(e-s.barCenterTotal)/s.weight;this._invalidatedFromIndex=this._maxIndexWithWeight+1}const t=this._items[this._maxIndexWithWeight];return this._maxIndexWithWeight+.5+e-t.barEndTotal}state(e){return{maxIndexWithWeight:this._maxIndexWithWeight,items:this._items.slice(),weightsMap:Array.from(this._weightsMap.entries())}}restoreState(e){this._maxIndexWithWeight=e.maxIndexWithWeight,this._items=e.items.slice(),this._weightsMap=new Map(e.weightsMap)}_createItems(e){const t=e-(this._items.length-1);if(t>0){const e=this._items.length;this._items=this._items.concat(Array.from({length:t},((t,s)=>({barStartTotal:1,barCenterTotal:1,barEndTotal:1,weight:1,index:s+e}))))}}_fillItem(e,t){var s;const i=this._items[e],r=null!==(s=this._weightsMap.get(e))&&void 0!==s?s:1;return i.weight=r,i.barCenterTotal=void 0===t?0:t.barEndTotal+r/2,i.barStartTotal=i.barCenterTotal-r/2,i.barEndTotal=i.barCenterTotal+r/2,i}}class n{constructor(){this._baseIndex=0,this._preBaseIndexWeights=new o,this._postBaseIndexWeights=new o,this._weightsMap=new Map}setBaseIndex(e){this._baseIndex=e,this._preBaseIndexWeights=new o,this._postBaseIndexWeights=new o;for(const[e,t]of this._weightsMap)this.setWeight(e,t)}indexToTotalWeight(e){const t=e-this._baseIndex;return t<0?-this._preBaseIndexWeights.totalWeight(-t):this._postBaseIndexWeights.totalWeight(t)}totalWeightToIndex(e){return e<0?this._baseIndex-this._preBaseIndexWeights.index(-e):this._baseIndex+this._postBaseIndexWeights.index(e)}clear(){this._preBaseIndexWeights=new o,this._postBaseIndexWeights=new o,this._weightsMap.clear()}setWeight(e,t){const s=e-this._baseIndex;s<=0&&this._preBaseIndexWeights.setWeight(-s,t),s>=0&&this._postBaseIndexWeights.setWeight(s,t),this._weightsMap.set(e,t)}indexRangeToWeights(e,t,s){const i=e-this._baseIndex,o=t-this._baseIndex;let n=0;if(s=null!=s?s:[],i<0){const e=this._preBaseIndexWeights.rangeWeight(Math.max(1,-o),-i),t=e.length-s.length
;t>0&&r(s,t);for(let t=e.length-1;t>=0;t-=1){const i=e[t],r=s[n];r.center=-i.barCenterTotal,r.left=-i.barEndTotal,r.right=-i.barStartTotal,r.timePointIndex=this._baseIndex-i.index,n+=1}}if(o>=0){const e=this._postBaseIndexWeights.rangeWeight(Math.max(0,i),o),t=e.length+n-s.length;t>0&&r(s,t);for(const t of e){const e=s[n];e.center=t.barCenterTotal,e.left=t.barStartTotal,e.right=t.barEndTotal,e.timePointIndex=this._baseIndex+t.index,n+=1}}return s.slice(0,n)}moveData(e){const t=new Map;for(const s of e){const e=this._weightsMap.get(s.old);if(void 0!==e){t.set(s.new,e),this._weightsMap.delete(s.old);const i=s.old-this._baseIndex;i<=0&&this._preBaseIndexWeights.deleteItemByIndex(-i),i>=0&&this._postBaseIndexWeights.deleteItemByIndex(i)}}for(const[e,s]of t)this.setWeight(e,s)}state(e){return{type:"computed",state:{baseIndex:this._baseIndex,preBaseIndexWeights:this._preBaseIndexWeights.state(e),postBaseIndexWeights:this._postBaseIndexWeights.state(e),weightsMap:Array.from(this._weightsMap.entries())}}}restoreState(e){this._baseIndex=e.state.baseIndex,this._weightsMap=new Map(e.state.weightsMap),this._preBaseIndexWeights.restoreState(e.state.preBaseIndexWeights),this._postBaseIndexWeights.restoreState(e.state.postBaseIndexWeights)}needAdjustingOnDataRestoring(){return!0}}},198930:(e,t,s)=>{"use strict";s.d(t,{isLineToolState:()=>n,isMainSeriesState:()=>r,isStudyLineToolState:()=>a,isStudyState:()=>o});var i=s(627620);function r(e){return"MainSeries"===e.type}function o(e){return Boolean(e.type)&&e.type.toLowerCase().startsWith("study")}function n(e){return Boolean(e.type)&&(0,i.isLineToolName)(e.type)}function a(e){return Boolean(e.type)&&(0,i.isStudyLineToolName)(e.type)}},836808:(e,t,s)=>{"use strict";function i(e){return e<10?`0${e}`:e.toString()}s.d(t,{addLeadingZero:()=>i})},629714:(e,t,s)=>{"use strict";s.d(t,{LineToolStudyStatusView:()=>r});var i=s(32904);class r extends i.StatusView{constructor(e){super(e.statusProvider({}))}getSplitTitle(){return this._statusProvider.getSplitTitle()}}},850986:(e,t,s)=>{"use strict";s.d(t,{lineToolsStudyIds:()=>i});const i={LineToolAnchoredVWAP:"AnchoredVWAP@tv-basicstudies",LineToolRegressionTrend:"RegressionTrend@tv-basicstudies",LineToolFixedRangeVolumeProfile:"VbPFixed@tv-basicstudies",LineToolVbPFixed:"VbPFixed@tv-volumebyprice"};{const e={LineToolAnchoredVolumeProfile:"VbPAnchored@tv-basicstudies"};for(const[t,s]of Object.entries(e))i[t]=s}},475892:(e,t,s)=>{"use strict";s.d(t,{PriceDataSource:()=>a,isPriceDataSource:()=>n});var i=s(903424),r=s(942634),o=s(487945);function n(e){return e instanceof a}class a extends i.DataSource{constructor(e,t){super(t),this._formatterChanged=new r.Delegate,this._priceStepChanged=new r.Delegate,this._currencyChanged=new r.Delegate,this._unitChanged=new r.Delegate,this._priceRangeReadyChanged=new r.Delegate,this._priceStep=null,this._priceRangeReady=!0,this._model=e}base(){return 0}model(){return this._model}currencyChanged(){return this._currencyChanged}isCurrencySource(){return!0}isDisplayedInLegend(){return!0}unitChanged(){
return this._unitChanged}isUnitSource(){return!0}priceRange(e,t,s){return null}isDraggable(){return!0}priceLineColor(e){return e}formatterChanged(){return this._formatterChanged}priceStep(e){return this._priceStep}priceStepChanged(){return this._priceStepChanged}isIncludedInAutoScale(){return!0}correctScaleMargins(e){return e}priceRangeReady(){return this._priceRangeReady}priceRangeReadyChanged(){return this._priceRangeReadyChanged}disablePriceRangeReady(){const e=this.priceScale();null===e||e.isAutoScale()||e.mainSource()!==this||(this._priceRangeReady=!1,e.recalculatePriceRangeOnce()),this._priceRangeReadyChanged.fire(!1)}statusView(){return null}legendView(){return null}marketStatusModel(){return null}dataUpdatedModeModel(){return null}dataProblemModel(){return null}canHasAlertOnLineTools(){return!0}_enablePriceRangeReady(){this._priceRangeReady=!0,this._priceRangeReadyChanged.fire(!0)}_onSourceCurrencyChanged(){(0,o.isActingAsSymbolSource)(this)||this._currencyChanged.fire()}_onSourceUnitChanged(){(0,o.isActingAsSymbolSource)(this)||this._unitChanged.fire()}_onSourcePriceRangeReadyChanged(e){(0,o.isActingAsSymbolSource)(this)||e||this.disablePriceRangeReady()}}},16508:(e,t,s)=>{"use strict";s.d(t,{SeriesBase:()=>di});var i,r=s(316230),o=s(650151),n=s(638456),a=s(345848),l=s(251954),d=s(338619),u=s(955273),h=s(475892),c=s(779732),_=s(368628),p=s(55243),S=s(518439),m=s(704670),y=s(658843),v=s(975179);!function(e){e.Regular="regular",e.Extended="extended",e.PreMarket="premarket",e.PostMarket="postmarket"}(i||(i={}));var g=s(735211),b=s(540519),f=s(32904),w=s(444372),P=s(764829),C=s(257288),I=s(901110),T=s(745397),x=s(468302);const A=w.t(null,void 0,s(270963)),R=w.t(null,void 0,s(975546)),E=P.enabled("hide_unresolved_symbols_in_legend");class V extends I.StatusProviderBase{constructor(e,t,s){super(),this._series=e,this._statusViewProperties=t,this._options=s||{}}text(){return(0,T.generateTitleForGui)(this._getTitleGenerationOptions())}getSplitTitle(){return(0,T.generateSplitTitleForGui)(this._getTitleGenerationOptions())}bold(){return!1}size(){return this._statusViewProperties.childs().fontSize.value()+"px"}errorStatus(){const e=this._series.unsupportedResolutionState().value(),t=e?(0,x.getErrorFromUnsupportedResolutionState)(e):this._series.seriesErrorMessage();return null!==t?{error:t,title:e?R:A}:null}_getTitleGenerationOptions(){const e=this._series.symbolInfo(),t=this._statusViewProperties.childs(),s=this._series.symbolTextSourceProxyProperty().value();let i;t.showExchange.value()&&e&&(i=(0,v.getSymbolExchange)(e));const r=null!==null?null:void 0,o=this._series.getInputsProperties().state();return 17===this._series.style()&&(o.type=this._series.properties().childs().volFootprintStyle.childs().type.value()),{description:B(s,e),exchange:i,symbol:E&&null===e?"":this._series.symbol(),interval:t.showInterval.value()&&!this._options.hideResolution?this._series.interval():void 0,style:this._series.properties().childs().style.value(),inputs:o,boxSize:this._series.data().boxSize,
reversalAmount:this._series.data().reversalAmount,ticker:D(s,e),priceSource:r}}}function D(e,t){return"ticker-and-description"!==e?"":null!==t?t.name:void 0}function B(e,t){if(null!==t)return"ticker"===e?t.name:"long-description"===e&&void 0!==t.long_description?t.long_description:(0,C.getTranslatedSymbolDescription)({pro_name:t.pro_name||void 0,short_name:t.name||void 0,description:t.description||void 0,short_description:t.short_description||void 0,local_description:t.local_description||void 0,language:t.language||void 0})}class N extends f.StatusView{constructor(e,t,s){super(new V(e,t,s)),this._invalidated=!0,this._series=e,this._series.onRestarted().subscribe(this,this.update),this._series.dataEvents().symbolResolved().subscribe(this,this.update),this._series.dataEvents().completed().subscribe(this,this.update),this._series.boxSizeValue().subscribe(this.update.bind(this)),t.childs().symbolTextSource.listeners().subscribe(this,this.update)}getSeriesPrecision(){let e=4;const t=this._series.symbolInfo();return t&&t.pricescale&&(e=Math.round(Math.log(t.pricescale)/Math.log(10))),e}round(e){const t=this.getSeriesPrecision(),s=Math.round(e*Math.pow(10,t))/Math.pow(10,t);return s?s.toString():""}update(){this._invalidated=!0}text(){return this._updateImpl(),super.text()}bold(){return this._updateImpl(),super.bold()}size(){return this._updateImpl(),super.size()}getSplitTitle(){return this._updateImpl(),this._statusProvider.getSplitTitle()}_updateImpl(){this._invalidated&&(this._bold=this._statusProvider.bold(),this._size=this._statusProvider.size(),this._text=this._statusProvider.text(),this._invalidated=!1)}}var M=s(150335),L=s(49839),O=s(151848),k=s(419283),W=s(627620);const F=n.CheckMobile.any(),U=P.enabled("hide_resolution_in_legend");class H extends L.DataWindowView{constructor(e,t){super(),this._invalidated=!0,this._series=e,this._model=t,this.update()}update(){this._invalidated=!0}items(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items}series(){return this._series}_updateImpl(){var e,t;const s=this._getValuesProvider();this._valuesProvider!==s&&(this._valuesProvider=s,this._items=this._valuesProvider.getItems().map((e=>new L.DataWindowItem(e.id,e.title,"",e.unimportant))));const i=this._series.symbolInfo();if(i){const e=[i.name];if(U||e.push((0,O.translatedIntervalString)(this._series.interval())),(0,v.isEconomicSymbol)(i)){const t=(0,v.getSourceForEconomySymbol)(i);null!==t&&e.push(t)}else e.push((0,n.onWidget)()||"forex"===i.type?i.exchange:i.listed_exchange);this._header=e.join(` ${v.symbolTitleSeparator} `),this._title=i.description}else this._header=this._series.symbol();let r=this._model.crossHairSource().appliedIndex();P.enabled("use_last_visible_bar_value_in_legend")&&!(0,M.isNumber)(r)&&(r=null!==(t=null===(e=this._model.timeScale().visibleBarsStrictRange())||void 0===e?void 0:e.lastBar())&&void 0!==t?t:NaN);const o=this._valuesProvider.getValues(r);for(let e=0;e<o.length;++e){const t=o[e],s=this._items[e];s.setValue(t.value),s.setVisible(t.visible),s.setColor(t.color),
s.setTitle(t.title)}}_getValuesProvider(){return this._series.dataWindowValuesProvider()}_showLastPriceAndChangeOnly(){return F&&(null===this._model.crossHairSource().pane||(0,W.isLineToolName)(k.tool.value())||null!==this._model.lineBeingEdited())}}var G=s(272933);const j=w.t(null,void 0,s(872445));class q extends H{constructor(e,t){super(e,t),this._backgroundColorSpawn=t.backgroundTopColor().spawn(),this._backgroundColorSpawn.subscribe(this.update.bind(this));const s=t.properties().childs().paneProperties.childs().legendProperties.childs();this._visibilityProperty=(0,G.combineProperty)(((e,t,s,i)=>e||t||s||i),s.showBarChange.weakReference(),s.showSeriesOHLC.weakReference(),s.showVolume.weakReference(),s.showLastDayChange.weakReference()),this._visibilityProperty.subscribe(this,this.update)}areValuesVisible(){return this._visibilityProperty.value()}additional(){const e=this._series.dataPoweredBy();return null!==e&&e.length>0?w.t(null,void 0,s(957131))+" "+e:null}marketTitle(){const e=this._series.marketStatusModel().status().value();return this._showLastPriceAndChangeOnly()&&("pre_market"===e||"post_market"===e)?`${j}:`:""}destroy(){this._backgroundColorSpawn.destroy(),this._visibilityProperty.destroy()}_getValuesProvider(){return this._series.legendValuesProvider()}}var z=s(192914),Y=s(546821),$=s(378975),K=s(866554),X=s(430597),Q=s(79342);let Z=0;class J{constructor(e,t){this._extrapolatedData=[],this._cacheForFuture=!1,this._modelId=Z++,this._builderCache=null,this._uniqueId=(0,Q.randomHashN)(6),this._resolution=t,this._symbolInfo=e,this._valid=Boolean(e.timezone)&&Boolean(e.session),this._session=new K.SessionInfo(e.timezone,e.session,e.session_holidays,e.corrections)}syncSourceTarget(){return{uniqueId:this._uniqueId,resolution:this._resolution,symbolInfo:this._symbolInfo,session:this._session.state()}}getSymbolInfo(){return this._symbolInfo}getSession(){return this._session}getResolution(){return this._resolution}uniqueId(){return this._modelId}distance(e,t){if(!this.isValid())return{success:!1};if(e>t)return{success:!1};if(e===t)return{success:!0,result:0};let s=this._extrapolatedData.length,i=0!==s?this._extrapolatedData[0]:null,r=null!==i?this._extrapolatedData[s-1]:null;const o=e<t;if(1e3*e===i&&this._cacheForFuture===o||(this._extrapolatedData=[1e3*e],s=1,i=null,r=null),null===i||null!==r&&1e3*t>r){const i=(0,X.extrapolateBarsFrontToTime)(this.barBuilder(),r||1e3*e,1e3*t,2e3,!0);this._extrapolatedData=this._extrapolatedData.concat(i.times),s=this._extrapolatedData.length,this._cacheForFuture=o}if(r=this._extrapolatedData[s-1],r<1e3*t)return{success:!1};const n=this._extrapolatedData.indexOf(1e3*t);return-1===n?{success:!1}:{success:!0,result:n}}projectTime(e,t){if(!this.isValid())return e;let s=this._extrapolatedData.length,i=s>0?this._extrapolatedData[0]:null,r=null!==i?this._extrapolatedData[s-1]:null;const o=t>=0;1e3*e===i&&this._cacheForFuture===o||(this._extrapolatedData=[1e3*e],s=1,i=null,r=null);const n=Math.abs(t);if(null===i||n>=s){const i=(0,
X.extrapolateBarsFrontByCount)(this.barBuilder(),r||1e3*e,Math.sign(t)*(n-s+1),!0);this._extrapolatedData=this._extrapolatedData.concat(i.times),s=this._extrapolatedData.length,this._cacheForFuture=o}return s<n?e:this._extrapolatedData[n]/1e3}isValid(){return this._valid}dataSize(){return this._extrapolatedData.length}createNewModelWithResolution(e){return new J(this._symbolInfo,e)}barBuilder(){return null===this._builderCache&&(this._builderCache=(0,K.newBarBuilder)(this._resolution,this._session,this._session)),this._builderCache}}var ee=s(566238),te=s(525714),se=s(503679),ie=s(749028);async function re(e){var t,s;if(window.user.declared_status!==se.UserStatus.Pro)return!1;if(await(null===(t=window.pro)||void 0===t?void 0:t.updateShopConf())){const t=null===(s=window.pro)||void 0===s?void 0:s.getPaidExchangesForProfessional().map((e=>e.exchange.toUpperCase()));if(!(null==t?void 0:t.includes(e.listed_exchange.toUpperCase()))&&!(null==t?void 0:t.includes(e.pro_perm.toUpperCase())))return!1}return async function(e){try{return(await(0,ie.isSignedExchangeAgreement)({exchange:e.pro_perm})).response}catch(e){return!1}}(e)}var oe=s(268552),ne=s.n(oe);var ae=s(887744);const le=(0,d.getLogger)("Chart.Definitions.Series");function de(e,t){return"TickByTick"===e?{mode:e,updatePeriod:t}:{mode:e}}async function ue(e,t,s){const i=[];return(0,te.isDelay)(e.delay)?async function(e){const t=[];return(0,te.witoutRealtime)(e)?t.push(de("DelayNoRealtime")):(0,te.isDelayForGuest)("TFEX",e)?t.push(de("TFEXDelayForGuest")):(0,te.isDelayForGuest)("CHIXAU",e)?t.push(de("CHIXAuDelayForGuest")):(0,te.isDelayForGuest)("NGM",e)?t.push(de("NGMDelayForGuest")):(0,te.isDelayForGuest)("ICESG",e)?t.push(de("ICESGDelayForGuest")):(0,te.isDelayForGuest)("TAIFEX",e)?t.push(de("TAIFEXDelayForGuest")):(0,te.isDelayForGuest)("TURQUOISE",e)?t.push(de("TURQUOISEDelayForGuest")):(0,te.isDelayForGuest)("ADX",e)?t.push(de("ADXDelayForGuest")):(0,te.isDelayForGuest)("LUXSE",e)?t.push(de("LUXSEDelayForGuest")):(0,te.isDelayForGuest)("NSENG",e)?t.push(de("NSENGDelayForGuest")):(0,te.isDelayForGuest)("FINRA",e)?t.push(de("FINRADelayForGuest")):(0,te.isDelayForGuest)("TRADEGATE",e)?t.push(de("TRADEGATEDelayForGuest")):["BER","DUS","HAM","HAN","MUN"].some((t=>(0,te.isDelayForGuest)(t,e)))?t.push(de("DEForGuest")):["MIL"].some((t=>(0,te.isDelayForGuest)(t,e)))?t.push(de("MILDelayForGuest")):await re(e)?t.push(de("DelayToRealtime")):(0,te.isDelayWithoutMarketAgreement)(e)?t.push(de("DelayWithoutMarketAgreement")):t.push(de("DelayToRealtime")),t}(e):(0,te.isEod)(e,t)?(i.push(de("EOD")),i):((0,te.isTickByTick)(e,t)&&0!==s&&i.push(de("TickByTick",s)),function(e){return ne().hasBatsSymbols(e.full_name)}(e)&&i.push(de("BATSToRealtime")),(0,te.isTVCalculatedPairSymbol)(e)&&i.push(de("TvCalculatedPair")),i)}class he{constructor(e,t,s){this._dataUpdatedInfoStatus=new ee.WatchedObject(null),this._symbolInfo=e,this._status=t,this._updatePeriod=s,this._symbolInfo.subscribe(this._update.bind(this)),this._status.subscribe(this._update.bind(this)),
this._updatePeriod.subscribe(this._update.bind(this))}destroy(){this._symbolInfo.release(),this._status.release(),this._updatePeriod.release()}status(){return this._dataUpdatedInfoStatus.readonly()}symbolName(){const e=this._symbolInfo.value();return null!==e?e.name:""}time(){const e=this._symbolInfo.value(),t=null!==e&&e.delay&&e.delay>0?e.delay:900;return Math.round(t/60)}listedExchange(){const e=this._symbolInfo.value();return null!==e?e.listed_exchange:""}async description(){const e=this._symbolInfo.value();if(null===e)return"";let t={};try{t=(0,o.ensureNotNull)(await(0,te.getExchange)(e))}catch(e){le.logWarn(`Cannot get exchange ${(0,ae.errorToString)(e)}`)}return t.description||e.listed_exchange}exchange(){const e=this._symbolInfo.value();return null!==e?e.exchange:""}proName(){const e=this._symbolInfo.value();return null!==e?e.pro_name:""}country(){var e;return(null===(e=this._symbolInfo.value())||void 0===e?void 0:e.country)||""}proPerm(){const e=this._symbolInfo.value();return null!==e?e.pro_perm:""}firstReplacedByBatsExchange(){const e=this._symbolInfo.value();return e&&(0,te.firstReplacedByBatsExchange)(e)}isSpread(){const e=this._symbolInfo.value();return null!==e&&"spread"===e.type}async _update(){const e=this._symbolInfo.value();if(null===e)return void this._dataUpdatedInfoStatus.setValue(null);const t=this._status.value();if("string"==typeof t)return void this._dataUpdatedInfoStatus.setValue(null);if(2===t||1===t)return;const s=await ue(e,t,this._updatePeriod.value());0!==s.length?this._dataUpdatedInfoStatus.setValue(s):this._dataUpdatedInfoStatus.setValue(null)}}var ce=s(702598),_e=s(459423),pe=s(124829),Se=s(501867);const me=(0,d.getLogger)("Chart.DataProblemModel");class ye{constructor(e,t){this._mainDataProblem=new ee.WatchedObject(null),this._supportPortalProblems=new ee.WatchedObject([]),this._allDataProblems=new ee.WatchedObject([]),this._pushStreamHandler=null,this._destroyed=!1,this._quotesProvider=e,this._quotesProvider.quotesUpdate().subscribe(this,this._update.bind(this)),this._symbolInfo=t,this._symbolInfo.subscribe((e=>{e||this._mainDataProblem.setValue(null)})),this._mainDataProblem.subscribe((()=>this._updateAllDataProblems())),this._supportPortalProblems.subscribe((()=>this._updateAllDataProblems())),this._requestSupportPortalProblems()}destroy(){this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._symbolInfo.release(),null!==this._pushStreamHandler&&Se.pushStreamMultiplexer.off("support-portal-problem",this._pushStreamHandler),this._destroyed=!0}dataProblems(){return this._allDataProblems}_resetStatus(){this._mainDataProblem.setValue(null)}_update(e){void 0===e.values||void 0===e.values.data_problem?this._resetStatus():this._mainDataProblem.setValue((0,pe.clone)(e.values.data_problem))}_updateAllDataProblems(){const e=this._mainDataProblem.value(),t=this._supportPortalProblems.value();this._allDataProblems.setValue(null===e?t:[e,...t])}async _requestSupportPortalProblems(){{const e=await(0,
ce.fetch)(`${_e.supportPortalProblemsHost}/support/support-portal-problems/?language=${window.locale}`);if(this._destroyed)return;if(!e.ok)return void me.logWarn("Couldn't load support portal problems");const t=(await e.json()).issues,s=()=>{const e=t.filter((e=>e.show_on_chart&&!1!==e.is_active&&(void 0===e.language||e.language.some((e=>e===window.locale||"all"===e))))).map((e=>({severity:"low",title:e.title,text:e.description})));this._supportPortalProblems.setValue(e)};s(),this._pushStreamHandler=e=>{switch(e.action){case"created":t.push(e.data);break;case"modified":{const s=t.findIndex((t=>t.id===e.data.id));-1!==s?t[s]={...t[s],...e.data}:t.push(e.data);break}case"deleted":{const s=t.findIndex((t=>t.id===e.data.id));-1!==s&&t.splice(s,1);break}}s()},Se.pushStreamMultiplexer.on("support-portal-problem",this._pushStreamHandler)}}}var ve=s(463246),ge=s(432059),be=s(347808),fe=s(675490),we=s(870045),Pe=s(836808);function Ce(e,t=Date.now()/1e3){let s=Math.ceil(e-t);if(s<=0)return"";if(s<3600){const e=Math.floor(s/60),t=Math.ceil(s%60);return`${(0,Pe.addLeadingZero)(e)}:${(0,Pe.addLeadingZero)(t)}`}if(s<86400){const e=Math.floor(s/3600);s%=3600;const t=Math.floor(s/60);s%=60;const i=Math.ceil(s);return`${(0,Pe.addLeadingZero)(e)}:${(0,Pe.addLeadingZero)(t)}:${(0,Pe.addLeadingZero)(i)}`}{const i=new Date(1e3*e),r=new Date(1e3*t),o=we.get_year(i),n=we.get_year(r),a=we.get_month(i),l=we.get_month(r),d=we.get_day_of_month(r),u=Ie(i)-Ie(r)>=0?0:-1;let h=12*(o-n)+(a-l)+u;if(h>0){const t=we.get_days_in_month(l,n);!function(e,t){const s=we.get_day_of_month(e);e.setUTCMonth(we.get_month(e)+t),we.get_day_of_month(e)!==s&&e.setUTCDate(0)}(r,h);const s=we.get_days_in_month(we.get_month(r),we.get_year(r)),i=d!==t&&s===we.get_day_of_month(r)?t-d:0;let o=Math.ceil((e-r.getTime()/1e3)/86400)+i;return o>=s&&(h++,o=0),`${h}M ${o}d`}if(-1===u){if(we.get_days_in_month(l,n)-s/86400<1/24)return"1M 0d"}let c=Math.floor(s/86400);s%=86400;let _=Math.ceil(s/3600);return 24===_&&(_=0,c+=1),c===we.get_days_in_month(a,o)?"1M 0d":`${c}d ${_}h`}}function Ie(e){return 86400*e.getUTCDate()+3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds()}var Te=s(613438),xe=s(169532);const Ae=P.enabled("force_exchange_as_title"),Re=P.enabled("chart_style_hilo_last_price");const Ee={alwaysShowGlobalLast:!1,visibleOnHistoryOnly:!1,showCountdown:!0,showSymbolLabel:!0,useSolidBodyColor:!0};class Ve extends be.PriceAxisView{constructor(e,t,s){super(),this._previousCountdown="",this._source=e,this._model=t,this._options={...Ee,...s}}updateCountdown(){this._countdownText()!==this._previousCountdown&&(this.update((0,xe.sourceChangeEvent)(this._source.id())),this._model.updateSourcePriceScale(this._source))}_getSource(){return this._source}_getModel(){return this._model}_isCountdownEnabled(){return this._options.showCountdown}_countdownText(){{const e=this._source.barCloseTime();return null===e?"":Ce(e,this._currentTime()/1e3)}}_updateRendererData(e,t,s){var i;if(e.visible=!1,t.visible=!1,!this._source.isVisible())return;const r=this._source.properties().childs()
;if(!Re&&12===r.style.value())return;const n=this._model.timeScale().visibleBarsStrictRange(),a=this._source.data().last();if(null===n||null===a)return;if(this._options.visibleOnHistoryOnly&&n.contains(a.index))return;const l=this._model.properties().childs().scalesProperties.childs();let d=l.showSeriesLastValue.value(),u=this._isCountdownEnabled()&&r.showCountdown.value()&&(12===(h=r.style.value())?Re:(0,v.isTimeBasedStyle)(h))&&(this._options.alwaysShowGlobalLast||n.contains(a.index));var h;let c=this._options.showSymbolLabel&&l.showSymbolLabels.value();const _=l.seriesLastValueMode.value()===fe.PriceAxisLastValueMode.LastPriceAndPercentageValue,p=this._source.lastValueData(void 0,this._options.alwaysShowGlobalLast);if(p.noData)return;const S=8===r.style.value();if((d||u||c)&&S&&r.haStyle.childs().showRealLastPrice.value()){const e=this._source.lastValueData(void 0,!1),t=this._source.lastValueData(void 0,!0);e.noData||t.noData||e.index!==t.index||(d=!1,u=!1,c=!1)}const m=(0,ge.resetTransparency)(this._source.priceLineColor(p.color));if(this._options.useSolidBodyColor?(s.background=m,s.borderColor=void 0):(s.background=this._model.backgroundColorAtYPercentFromTop((null!==(i=s.fixedCoordinate)&&void 0!==i?i:s.coordinate)/(0,o.ensureNotNull)(this._model.paneForSource(this._source)).height()),s.borderColor=m),s.coordinate=p.coordinate,s.floatCoordinate=p.floatCoordinate,d||u){const t=this._axisFirstLineText(p,d);e.text=t,this._options.useSolidBodyColor?(s.textColor=this.generateTextColor(s.background),e.borderVisible=!1):(e.borderVisible=!0,s.textColor=m),e.textColor=s.textColor;const i=d&&_?(0,Te.getOppositeModePriceText)(this._source.priceScale(),p):"";e.secondLine=i,s.secondLineTextColor=s.textColor;const r=u?this._countdownText():"";this._previousCountdown=r,e.thirdLine=r,s.thirdLineTextColor=(0,ge.generateColor)(s.textColor,25),0===t.length&&0===i.length&&0===r.length||(e.visible=!0)}c&&(t.text=this._paneText(c),t.visible=t.text.length>0)}_paneText(e){let t="";const s=this._source.symbolInfo();return Ae?t=(0,v.displayedSymbolExchange)(s):e&&(t=(0,v.displayedSymbolName)(s)),t}_axisFirstLineText(e,t){return t?(0,Te.getCurrentModePriceText)(this._source.priceScale(),e):""}_currentTime(){return window.ChartApiInstance.serverTime()}}var De=s(35403),Be=s(175203),Ne=s(732634),Me=s(799878),Le=s(472051),Oe=s(19303);function ke(e){const[t]=function(e){const t=new Set;e.isSpread()&&t.add(Oe.DataSourceDangerReason.Spread);const s=e.symbolInfo();return"CRYPTOCAP"===(null==s?void 0:s.exchange)&&t.add(Oe.DataSourceDangerReason.CryptoCap),t}(e);return null!=t?t:null}var We=s(367637);const Fe={0:{background:"rgba(242, 54, 69, 0.15)",line:"#F23645"},1:{background:"rgba(255, 152, 0, 0.15)",line:"#FF9800"},2:{background:"rgba(8, 153, 129, 0.15)",line:"#089981"}};class Ue extends We.MediaCoordinatesPaneRenderer{constructor(){super(...arguments),this._data=null}setData(e){this._data=e}hitTest(){return null}_drawImpl(e){if(null===this._data)return;const t=Fe[this._data.predictionCode],s=e.context;s.fillStyle=t.background,
s.fillRect(Math.max(0,this._data.startX),0,e.mediaSize.width,e.mediaSize.height),s.strokeStyle=t.line,s.beginPath(),s.lineWidth=1;const i=Math.round(this._data.startX);s.moveTo(i,0),s.lineTo(i,e.mediaSize.height),s.stroke()}}class He{constructor(e,t,s,i){this._renderer=new Ue,this._startX=0,this._series=t,this._timeScale=e,this._lastKnownBarIndex=s,this._direction=i}update(){this._startX=this._timeScale.indexToCoordinate(this._lastKnownBarIndex)+.5*this._timeScale.barSpacing()+1}renderer(){const e=(0,_.barFunction)("close"),t=this._series.data().bars(),s=e((0,o.ensureNotNull)(t.valueAt(this._lastKnownBarIndex))),i=e((0,o.ensureNotNull)(t.last()).value);let r=0;i>s?r=1:i<s&&(r=2);let n=1;return 0!==this._direction&&(n=this._direction===r?2:0),this._renderer.setData({startX:this._startX,predictionCode:n}),this._renderer}}var Ge=s(354957),je=s(552279),qe=s(967805);class ze{renderer(e){return null}update(e){}static instance(){var e;return this._instance=null!==(e=this._instance)&&void 0!==e?e:new ze,this._instance}}ze._instance=null;var Ye=s(942634),$e=s(370407);class Ke{constructor(e){this._study=null,this._destroyStudy=null,this._onStatusChanged=new Ye.Delegate,this._series=e}destroy(){var e,t;null===(t=null===(e=this._study)||void 0===e?void 0:e.destroy)||void 0===t||t.call(e)}properties(){var e;return null===(e=this._study)||void 0===e?void 0:e.properties().childs()}paneViews(e){var t,s;return null!==(s=null===(t=this._study)||void 0===t?void 0:t.paneViews(e))&&void 0!==s?s:[]}stop(){var e;null===(e=this._study)||void 0===e||e.stop()}restart(){var e,t;null===(t=null===(e=this._study)||void 0===e?void 0:e.restart)||void 0===t||t.call(e)}moveData(e){var t,s;null===(s=null===(t=this._study)||void 0===t?void 0:t.moveData)||void 0===s||s.call(t,e)}clearData(){var e;null===(e=this._study)||void 0===e||e.clearData()}updateAllViews(e){var t;null===(t=this._study)||void 0===t||t.updateAllViews(e)}async syncStudy(e){var t,s;if(e===this.requiredStyle()){null===(t=this._destroyStudy)||void 0===t||t.call(this);const e=new AbortController;let s;this._destroyStudy=()=>{null==e||e.abort()};try{s=await this._createStudy(e.signal)}catch(e){return}this._study=s,this._applySeriesPropertiesToStudy(),s.properties().subscribe(this,this._applyStudyPropertiesToSeries),this._applyStudyPropertiesToSeries();const i=e=>{this._status=e,this._onStatusChanged.fire()};s.onStatusChanged().subscribe(this,i),i(s.status()),this._destroyStudy=()=>{var e;s.properties().unsubscribeAll(this),s.onStatusChanged().unsubscribeAll(this),s.stop(),null===(e=s.destroy)||void 0===e||e.call(s),this._status=void 0,this._onStatusChanged.fire(),this._study=null,this._destroyStudy=null},this._series.style()===this.requiredStyle()&&this._study.start()}else null===(s=this._destroyStudy)||void 0===s||s.call(this)}wasCompletedBefore(){var e;return Boolean(null===(e=this._study)||void 0===e?void 0:e.wasCompletedBefore())}status(){return this._status}onStatusChanged(){return this._onStatusChanged}legendValuesProvider(){return null}dataWindowValuesProvider(){return null}
state(e){return{}}restoreState(e,t){}priceRange(e,t){var s,i;return null!==(i=null===(s=this._study)||void 0===s?void 0:s.priceRange(e,t,{scaleSeriesOnly:!1,targetPriceScale:this._series.priceScale()}))&&void 0!==i?i:null}autoScaleInfo(e,t,s){var i;return null===(i=this._study)||void 0===i?void 0:i.autoScaleInfo(e,t,s)}requestMoreDataIndex(){return null}}var Xe=s(394954),Qe=s(872050),Ze=s(622864),Je=s(669763);class et extends Je.UndoCommand{constructor(e,t,i,r){super(new $e.TranslatedString("TPO Reset all splits and merges",w.t(null,void 0,s(602966)))),this._binding=e,this._splitsAndMerges=r}redo(){const e=this._binding.state(!1);e.splitsAndMerges={},this._binding.restoreState(e)}undo(){const e=this._binding.state(!1);e.splitsAndMerges=this._splitsAndMerges,this._binding.restoreState(e)}}function tt(e,t,s){"state"in e?(e.customFields&&(null==t||t.restoreStateCustomFields(e.customFields)),e.data&&s&&(null==t||t.restoreData(e.data))):null==t||t.restoreStateCustomFields(e)}class st extends Ke{constructor(){super(...arguments),this._state={},this._inputBarBuilder=null}bindToSeriesProperties(e){const t=e.childs().tpoStyle;t.subscribe(this,(()=>{null!==this._study&&this._study.properties().mergeAndFire((0,Xe.prepareStudyPropertiesState)(t.state()))}));const s="tpoStyle.levels";e.setThemedColors([{path:`${s}.pocColor`,colors:Qe.tpoThemedColors.poc},{path:`${s}.poorHighColor`,colors:Qe.tpoThemedColors.poorHigh},{path:`${s}.poorLowColor`,colors:Qe.tpoThemedColors.poorLow},{path:`${s}.singleprintsColor`,colors:Qe.tpoThemedColors.singleprints},{path:`${s}.vahColor`,colors:Qe.tpoThemedColors.vah},{path:`${s}.valColor`,colors:Qe.tpoThemedColors.val}])}requiredStyle(){return 18}state(e){var t,s,i,r,o;return e?null!==(s=null===(t=this._study)||void 0===t?void 0:t.state(!0))&&void 0!==s?s:null:null!==(r=null===(i=this._study)||void 0===i?void 0:i.stateCustomFields())&&void 0!==r?r:"state"in this._state?null!==(o=this._state.customFields)&&void 0!==o?o:{}:this._state}restoreState(e,t){this._state=e,this._withData=t,tt(e,this._study,t)}requestMoreDataIndex(){const e=this._series.symbolInfo(),t=this._series.bars().firstIndex(),s=this._series.model().timeScale().logicalRange(),i=this._series.syncModel();if(!e||null===t||!s||!i)return null;const r=Math.floor(s.left()),n=this._series.bars().search(r,S.PlotRowSearchMode.NearestRight);if(!n)return null;const a=this._series.properties().childs().tpoStyle.childs().inputs.childs(),l=function(e,t){switch(e){case"Day":return`${t}D`;case"Week":return`${t}W`;case"Month":return`${t}M`}(0,o.ensureNever)(e)}(a.period.value(),a.periodsNum.value());if(null===this._inputBarBuilder||this._inputBarBuilder.symbolInfo!==e||this._inputBarBuilder.inputResolution!==l){const t=new K.SessionInfo(e.timezone,e.session,e.session_holidays);this._inputBarBuilder={symbolInfo:e,inputResolution:l,barBuilder:(0,K.newBarBuilder)(l,t,t)}}const d=this._inputBarBuilder.barBuilder,u=1e3*n.value[0];d.moveTo(u);const h=d.startOfBar(0);return r-(0,X.extrapolateBarsFrontToTime)(i.barBuilder(),h,u,1e3).count}async _createStudy(e){
var t;const i=await(0,Ze.respectAbort)(e,Promise.all([s.e(52350),s.e(92013),s.e(88509),s.e(89052),s.e(18304)]).then(s.bind(s,997253))),r=await i.createTpoPeriodicStudy(this._series.model(),et.bind(this,this));if(e.aborted)throw r.stop(),null===(t=r.destroy)||void 0===t||t.call(r),(0,Ze.createAbortError)();return tt(this._state,r,this._withData),r.properties().childs().inputs.childs().ticksPerRow.subscribe(this,(e=>{this._series.properties().childs().tpoStyle.childs().inputs.childs().ticksPerRow.setValue(e.value())})),r}_applySeriesPropertiesToStudy(){var e;null===(e=this._study)||void 0===e||e.properties().mergeAndFire((0,Xe.prepareStudyPropertiesState)(this._series.properties().childs().tpoStyle.state()))}_applyStudyPropertiesToSeries(){const e=(0,o.ensureNotNull)(this._study).properties().childs().inputs.childs().ticksPerRow.value();this._series.properties().childs().tpoStyle.childs().inputs.childs().ticksPerRow.setValue(e)}}var it=s(79908);function rt(e,t,s){(null==e?void 0:e.customFields)&&(null==t||t.restoreStateCustomFields(e.customFields)),(null==e?void 0:e.data)&&s&&(null==t||t.restoreData(e.data))}class ot extends Ke{bindToSeriesProperties(e){const t=e.childs().volFootprintStyle,s=t.state();t.hasChild("bgColors")&&t.removeProperty("bgColors"),t.addChild("bgColors",new it.VolumeFootprintBgColorsProperty(s.bgColors)),t.childs().inputs.subscribe(this,(()=>{null!==this._study&&this._study.properties().childs().inputs.mergeAndFire(t.childs().inputs.state())}))}requiredStyle(){return 17}state(e){var t,s;return null!==(s=null===(t=this._study)||void 0===t?void 0:t.state(e))&&void 0!==s?s:null}restoreState(e,t){this._state=e,this._withData=t,rt(e,this._study,t)}async _createStudy(e){var t;const i=await(0,Ze.respectAbort)(e,Promise.all([s.e(62156),s.e(92013),s.e(88509),s.e(89052),s.e(55133)]).then(s.bind(s,586043))),r=await i.createVolumeFootprintStudy(this._series.model());if(e.aborted)throw r.stop(),null===(t=r.destroy)||void 0===t||t.call(r),(0,Ze.createAbortError)();return rt(this._state,r,this._withData),r}_applySeriesPropertiesToStudy(){var e;null===(e=this._study)||void 0===e||e.properties().childs().inputs.mergeAndFire(this._series.properties().childs().volFootprintStyle.childs().inputs.state())}_applyStudyPropertiesToSeries(){}}var nt=s(548544),at=s(843563),lt=s(316980);function dt(e,t,s){(null==e?void 0:e.data)&&s&&(null==t||t.restoreData(e.data))}class ut extends Ke{constructor(){super(...arguments),this._inputBarBuilder=null,this._legendValuesProvider=null,this._dataWindowValuesProvider=null}bindToSeriesProperties(e){e.childs().svpStyle.subscribe(this,(()=>{this._applySeriesPropertiesToStudy()}))}requiredStyle(){return 20}requestMoreDataIndex(){if(this._series.intervalObj().isDWM())return null;const e=this._series.symbolInfo(),t=this._series.bars().firstIndex(),s=this._series.model().timeScale().logicalRange(),i=this._series.syncModel();if(!e||null===t||!s||!i)return null;const r=Math.floor(s.left()),o=this._series.bars().search(r,S.PlotRowSearchMode.NearestRight);if(!o)return null
;if(null===this._inputBarBuilder||this._inputBarBuilder.symbolInfo!==e){const t=new K.SessionInfo(e.timezone,e.session,e.session_holidays);this._inputBarBuilder={symbolInfo:e,barBuilder:(0,K.newBarBuilder)("1D",t,t)}}const n=this._inputBarBuilder.barBuilder,a=1e3*o.value[0];n.moveTo(a);const l=n.startOfBar(0);return r-(0,X.extrapolateBarsFrontToTime)(i.barBuilder(),l,a,1e3).count}legendValuesProvider(){return this._legendValuesProvider}dataWindowValuesProvider(){return this._dataWindowValuesProvider}state(e){var t,s;return null!==(s=null===(t=this._study)||void 0===t?void 0:t.state(e))&&void 0!==s?s:null}restoreState(e,t){this._state=e,this._withData=t,dt(e,this._study,t)}async _createStudy(e){var t;const i=await(0,Ze.respectAbort)(e,Promise.all([s.e(62156),s.e(92013),s.e(88509),s.e(89052),s.e(39727)]).then(s.bind(s,2781))),r=await i.createSessionVolumeStudy(this._series.model());if(e.aborted)throw r.stop(),null===(t=r.destroy)||void 0===t||t.call(r),(0,Ze.createAbortError)();dt(this._state,r,this._withData);const o=this._series.model(),n=o.properties().childs().paneProperties.childs().legendProperties.childs().showSeriesOHLC;return this._legendValuesProvider=new at.StudyLegendValuesProvider(r,o,!0,n),this._dataWindowValuesProvider=new lt.StudyDataWindowValuesProvider(r,o),r}_applySeriesPropertiesToStudy(){var e;null===(e=this._study)||void 0===e||e.properties().mergeAndFire((0,nt.prepareStudyPropertiesState)(this._series.properties().childs().svpStyle.state()))}_applyStudyPropertiesToSeries(){}}class ht{constructor(e){this._onStatusChanged=new Ye.Delegate,this._bindings=[new st(e),new ot(e),new ut(e)],this._bindings.forEach((e=>e.onStatusChanged().subscribe(this,(()=>this._onStatusChanged.fire())))),this._series=e}destroy(){this._bindings.forEach((e=>e.destroy()))}bindToSeriesProperties(e){this._bindings.forEach((t=>t.bindToSeriesProperties(e)))}paneViews(e){return this._bindings.reduce(((t,s)=>t.concat(s.paneViews(e))),[])}stop(){this._bindings.forEach((e=>e.stop()))}restart(){var e;null===(e=this._activeBinding())||void 0===e||e.restart()}moveData(e){var t;null===(t=this._activeBinding())||void 0===t||t.moveData(e)}clearData(){this._bindings.forEach((e=>e.clearData()))}updateAllViews(e){this._bindings.forEach((t=>t.updateAllViews(e)))}syncStudy(e){this._bindings.forEach((t=>t.syncStudy(e)))}onStatusChanged(){return this._onStatusChanged}wasCompletedBefore(){var e,t;return null===(t=null===(e=this._activeBinding())||void 0===e?void 0:e.wasCompletedBefore())||void 0===t||t}dataWindowValuesProvider(){var e,t;return null!==(t=null===(e=this._activeBinding())||void 0===e?void 0:e.dataWindowValuesProvider())&&void 0!==t?t:null}legendValuesProvider(){var e,t;return null!==(t=null===(e=this._activeBinding())||void 0===e?void 0:e.legendValuesProvider())&&void 0!==t?t:null}status(){var e;return null===(e=this._activeBinding())||void 0===e?void 0:e.status()}priceRange(e,t){return(0,m.mergePriceRanges)(this._bindings.map((s=>s.priceRange(e,t))))}requestMoreDataIndex(){var e,t
;return null!==(t=null===(e=this._activeBinding())||void 0===e?void 0:e.requestMoreDataIndex())&&void 0!==t?t:null}getInputsInfoProperties(){var e,t;return null===(t=null===(e=this._activeBinding())||void 0===e?void 0:e.properties())||void 0===t?void 0:t.inputs}state(e){return this._bindings.reduce(((t,s)=>(t[s.requiredStyle()]=s.state(e),t)),{})}restoreState(e,t){for(const s of this._bindings){const i=e[s.requiredStyle()];i&&s.restoreState(i,t)}}autoScaleInfos(e,t,s){return this._bindings.map((i=>i.autoScaleInfo(e,t,s))).filter(pe.isExistent)}_activeBinding(){var e;return null!==(e=this._bindings.find((e=>e.requiredStyle()===this._series.style())))&&void 0!==e?e:null}}var ct=s(79200),_t=s(655988);class pt extends _t.ComputedTimePointWeights{constructor(e){super(),this._middleVolume=e,this._minValidVolume=.9*e}setVolume(e,t){this.setWeight(e,1+Math.log2(Math.max(t,this._minValidVolume)/this._middleVolume))}}class St extends be.PriceAxisView{constructor(e,t){super(),this._source=e,this._model=t}_updateRendererData(e,t,s){e.visible=!1;const i=this._source;if(!this._model.properties().childs().scalesProperties.childs().showSeriesPrevCloseValue.value())return;if(i.isDWM())return;const r=i.prevClose();if(null===r)return;const o=(0,ge.resetTransparency)(this._source.properties().childs().prevClosePriceLineColor.value());s.background=o,s.textColor=this.generateTextColor(o),s.coordinate=r.coordinate,e.text=(0,Te.getCurrentModePriceText)(i.priceScale(),r),e.visible=!0}}var mt=s(345159);class yt extends mt.HorizontalLinePaneView{constructor(e){super(),this._series=e,this._model=e.model()}}var vt=s(666574);class gt extends yt{constructor(e){super(e),this._lineRendererData.linestyle=vt.LINESTYLE_DOTTED}_updateImpl(){this._lineRendererData.visible=!1;const e=this._series.properties().childs();if(!e.showPrevClosePriceLine.value())return;if(this._series.isDWM())return;const t=this._series.prevClose();null!==t&&(this._lineRendererData.visible=!0,this._lineRendererData.y=t.coordinate,this._lineRendererData.color=e.prevClosePriceLineColor.value(),this._lineRendererData.linewidth=e.prevClosePriceLineWidth.value())}}var bt=s(449524),ft=s(559327),wt=s(286436),Pt=s(86441),Ct=s(836687),It=s(509078);class Tt{constructor(e,t){this._bars=[],this._invalidated=!0,this._isMarkersEnabled=(0,P.enabled)("source_selection_markers"),this._selectionData=null,this._blockSize=0,this._series=e,this._model=t,this._selectionIndexer=new Ct.SelectionIndexes(t.timeScale())}update(){this._invalidated=!0}nearestIndex(e,t){var s,i;return null!==(i=null===(s=this.bars().search(e,t))||void 0===s?void 0:s.index)&&void 0!==i?i:null}items(){return this._bars}_updateImpl(){if(this._bars=[],6===this._series.properties().childs().style.value()&&!this._series.data().boxSize)return;const e=this._series.priceScale(),t=this._model.timeScale();if(t.isEmpty()||e.isEmpty())return;const s=t.visibleStrictDataRange(this.bars());if(null===s)return;if(0===this.bars().size())return;if(this._series.data().bars().isEmpty())return;let i=s.firstBar()
;const r=s.lastBar(),n=this._series.firstValue();if(null===n)return;for(;i<=r;i++){if(null!==this.bars().valueAt(i))break}if(i>r)return;const a=this.bars().range(i,r),l={},d=this._series.properties().childs().style.value(),u=6===d?(0,o.ensureDefined)(this._series.data().boxSize):0;if(a.each(((e,t)=>{l.value=t;const s=this._barItem(l,t,e);return null===s||(l.previousValue=t,this._bars.push(s)),!1})),6===d&&(this._blockSize=(e.priceToCoordinate(0,n)-e.priceToCoordinate(500,n))/500*u),e.barPricesToCoordinates(this._bars,n),t.fillBarBorders(this._bars),this._model.selection().isSelected(this._series)){const s=this._selectionIndexer.indexes();this._selectionData={points:[],bgColors:[],visible:!0,barSpacing:t.barSpacing(),hittestResult:It.HitTarget.Regular};const i=(0,o.ensureNotNull)(this._model.paneForSource(this._series)).height();this._selectionData.hittestResult=It.HitTarget.Regular;for(let r=0;r<s.length;r++){const o=s[r],a=this._series.bars().valueAt(o);if(null===a)continue;const l=a[1],d=a[4];if(null==l||null==d)continue;const u=.5*(l+d),h=t.indexToCoordinate(o),c=e.priceToCoordinate(u,n);this._selectionData.points.push(new Pt.Point(h,c)),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(c/i))}}else this._selectionIndexer.clear()}_barItem(e,t,s){const i=t[1],r=t[2],o=t[3],n=t[4];if(void 0===i||void 0===r||void 0===o||void 0===n||null===i||null===r||null===o||null===n)return null;const a=this._series.barColorer(),l=this.isProjection(),d=a.barStyle(s,l,e);return{open:i,high:r,low:o,close:n,color:d.barColor,borderColor:d.barBorderColor,wickColor:d.barWickColor,isUp:d.isBarUp,hollow:null,center:NaN,left:NaN,right:NaN,timePointIndex:Math.round(s)}}}class xt extends Tt{bars(){return this._series.bars()}isProjection(){return!1}}class At extends Tt{bars(){return this._series.nsBars()}isProjection(){return!0}}class Rt extends At{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e=this._series.properties().childs(),t=e.rangeStyle.childs(),s={bars:this._bars,thinBars:t.thinBars.value(),dontDrawOpen:e.barStyle.childs().dontDrawOpen.value()};return new bt.PaneRendererBars(s)}}class Et extends At{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e=this._model.timeScale().barSpacing(),t={bars:this._bars,barWidth:(0,wt.optimalBarWidth)(e),barSpacing:this._model.timeScale().barSpacing(),bodyVisible:!0,borderVisible:!0,wickVisible:!0,isPriceScaleInverted:this._series.priceScale().isInverted()};return new ft.PaneRendererCandles(t)}_barItem(e,t,s){const i=super._barItem(e,t,s);if(null===i)return null;const r=this._series.barColorer().barStyle(s,!0,e);return i.wickColor=r.wickColor,i.hollow=null,i}}var Vt=s(336928);class Dt extends Ve{lastPrice(){return this._getSource().data().lastProjectionPrice}_updateRendererData(e,t,s){e.visible=!1,t.visible=!1;const i=this._getModel(),r=this._getSource(),n=r.priceScale(),a=i.timeScale(),l=this.lastPrice();if(a.isEmpty()||n.isEmpty()||void 0===l)return;const d=a.visibleBarsStrictRange();if(null===d)return
;const u=d.firstBar(),h=d.lastBar(),c=r.data(),_=c.search(h,S.PlotRowSearchMode.NearestLeft);if(null===_)return;const p=r.nearestIndex(u,S.PlotRowSearchMode.NearestRight);if(void 0===p)return;const m=r.model().properties().childs().scalesProperties.childs(),y=(0,o.ensureNotNull)(c.valueAt(p))[4];let v=s.background,g=m.showSeriesLastValue.value(),b=!1,f=!1,w=!1;const P=r.lastValueData(4,!1),C=r.properties().childs();if(8===C.style.value()&&C.haStyle.childs().showRealLastPrice.value()){const e=r.lastValueData(4,!0);if(e.noData||e.color===s.background||(v=(0,ge.resetTransparency)(e.color)),!e.noData&&!P.noData){const t=e.index===P.index;b=t&&m.showSymbolLabels.value(),f=m.seriesLastValueMode.value()===fe.PriceAxisLastValueMode.LastPriceAndPercentageValue,g=g&&t,w=t&&this._isCountdownEnabled()&&C.showCountdown.value()}}else{const e=r.barColorer().barStyle(_.index,!0);v=(0,ge.resetTransparency)(e.barColor)}if(s.background=v,s.textColor=this.generateTextColor(v),s.secondLineTextColor=s.textColor,s.thirdLineTextColor=(0,ge.generateColor)(s.textColor,25),s.coordinate=n.priceToCoordinate(l,y),e.visible=g||w,!P.noData){const s=r.priceScale().isPercentage();P.formattedPriceAbsolute=n.formatPriceAbsolute(l),P.formattedPricePercentage=n.formatPricePercentage(l,y,{signPositive:!0}),P.text=s?P.formattedPricePercentage:P.formattedPriceAbsolute,e.text=this._axisFirstLineText(P,g),e.secondLine=g&&f?s?P.formattedPriceAbsolute:P.formattedPricePercentage:"",e.thirdLine=w?this._countdownText():"",t.text=this._paneText(b)}t.visible=b}}var Bt=s(95370),Nt=s(960095);const Mt={light:{lineStyle:vt.LINESTYLE_DOTTED,lineWidth:1,backgroundColor:Nt.colorsPalette["color-tv-blue-50"],lineColor:Nt.colorsPalette["color-cold-gray-500"]},dark:{lineStyle:vt.LINESTYLE_DOTTED,lineWidth:1,backgroundColor:Nt.colorsPalette["color-tv-blue-a800"],lineColor:Nt.colorsPalette["color-cold-gray-500"]}};function Lt(e){return e?Mt.dark:Mt.light}class Ot extends mt.HorizontalLinePaneView{constructor(e,t,s){super(),this._model=e,this._isVisible=t.lineVisible,this._lineColor=t.lineColor,this._lineWidth=t.lineWidth,this._getValue=s}_updateImpl(){const e=this._lineRendererData;if(e.visible=!1,!this._isVisible.value())return;const t=this._model.mainSeries(),s=t.priceScale(),i=t.firstValue(),r=this._getValue();if(null===i||null===r)return;const o=Lt(this._model.dark().value()),n=this._lineColor.value()||o.lineColor,a=this._lineWidth.value()||o.lineWidth;e.visible=!0,e.y=s.priceToCoordinate(r,i),e.linestyle=o.lineStyle,e.linewidth=a,e.color=n}}class kt extends be.PriceAxisView{constructor(e,t,s,i){super(),this._model=e,this._label=t,this._isVisible=s.labelVisible,this._backgroundColor=s.lineColor,this._getValue=i}_updateRendererData(e,t,s){if(e.visible=!1,t.visible=!1,!this._isVisible.value())return;const i=this._model.mainSeries(),r=i.priceScale(),o=i.firstValue(),n=this._getValue();if(null===o||null===n)return;const a=Lt(this._model.dark().value()),l=(0,ge.resetTransparency)(this._backgroundColor.value()||a.backgroundColor);e.visible=!0,t.visible=!0,
e.text=r.formatPriceAbsolute(n),t.text=this._label,s.coordinate=r.priceToCoordinate(n,o),s.background=l,s.textColor=this.generateTextColor(l)}}class Wt extends Vt.PriceLineAxisView{constructor(e,t,s){super(),this._model=e,this._isLineVisible=t,this._getValue=s}_isVisible(){return this._isLineVisible.value()}_lineWidth(){return Lt(this._model.dark().value()).lineWidth}_lineStyle(){return Lt(this._model.dark().value()).lineStyle}_priceLineColor(e){return Lt(this._model.dark().value()).lineColor}_value(){const e=this._model.mainSeries(),t=e.priceScale(),s=e.firstValue(),i=this._getValue();if(null===s||null===i)return{noData:!0};const r=t.priceToCoordinate(i,s);return{noData:!1,floatCoordinate:r,coordinate:r,color:"",formattedPricePercentage:"",formattedPriceAbsolute:"",formattedPriceIndexedTo100:"",text:"",index:0}}}const Ft=w.t(null,void 0,s(778254)),Ut=w.t(null,void 0,s(165318));function Ht(e,t,s,i){const r=new Ot(e,s,i),o=new kt(e,s.label,s,i);return{paneView:r,panePriceAxisView:new Bt.PanePriceAxisView(o,t,e),priceAxisView:o,priceLineAxisView:new Wt(e,s.lineVisible,i)}}var Gt=s(65905);const jt={open:w.t(null,{context:"in_legend"},s(746728)),high:w.t(null,{context:"in_legend"},s(943253)),low:w.t(null,{context:"in_legend"},s(389923)),close:w.t(null,{context:"in_legend"},s(102696)),hl2:w.t(null,{context:"in_legend"},s(661372)),hlc3:w.t(null,{context:"in_legend"},s(255096)),ohlc4:w.t(null,{context:"in_legend"},s(394174))};class qt extends Gt.SeriesValuesProvider{constructor(e,t){super(e,t);const s=t.properties().childs().paneProperties.childs().legendProperties.childs();this._showBarChange=s.showBarChange,this._showLastDayChange=s.showLastDayChange,this._showSeriesOHLC=s.showSeriesOHLC,this._showVolume=s.showVolume,this._seriesStyle=e.properties().childs().style;const i=this._emptyValues[0],r=this._emptyValues[1],o=this._emptyValues[2];i.title=jt.open,r.title=jt.high,o.title=jt.low,i.unimportant=!0,r.unimportant=!0,o.unimportant=!0,this._emptyValues[6].title="",this._emptyValues[8].title="",this._emptyValues[4].title=""}getValues(e){var t,s,i;const r=super.getValues(e),o=this._series.style(),n=12!==o,a=this._showSeriesOHLC.value(),l=n&&this._showBarChange.value(),d=n&&this._showLastDayChange.value();if(this._showLastPriceAndChangeOnly()){const e=r[5];return e.visible=e.visible&&a,(t=r[8]).visible&&(t.visible=l),r[6].visible=!1,r}const u=12!==o&&16!==o,h=12!==o,c=this._series.intervalObj().is1Tick(),_=r[7];_.visible=_.visible&&this._showVolume.value();const p=(0,v.isPriceSourceStyle)(this._seriesStyle.value()),S=a&&!p,m=a&&p;if(r[0].visible=S&&u&&!c,r[1].visible=S&&!c,r[2].visible=S&&!c,r[3].visible=S&&h,r[3].title=c?"":jt.close,r[4].visible=m,(s=r[6]).visible&&(s.visible=l),(i=r[8]).visible&&(i.visible=d),16===o){const e=this._series.properties().childs().hlcAreaStyle.childs();r[1].color=e.highLineColor.value(),r[2].color=e.lowLineColor.value(),r[3].color=e.closeLineColor.value()}return r}}var zt=s(157504),Yt=s(882782);class $t{constructor(){this._data=null}setData(e){this._data=e}data(){return this._data}draw(e,t){
const s=this._data;if(null===s)return;const{horizontalPixelRatio:i,verticalPixelRatio:r}=t;e.save();const o=Math.max(1,Math.floor(i)),n=o%2/2,a=Math.round(s.center.x*i)+n,l=s.center.y*r;e.fillStyle=s.seriesLineColor,e.beginPath();const d=Math.max(2,1.5*s.seriesLineWidth)*i;e.arc(a,l,d,0,2*Math.PI,!1),e.fill(),e.fillStyle=s.fillColor,e.beginPath(),e.arc(a,l,s.radius*i,0,2*Math.PI,!1),e.fill(),e.lineWidth=o,e.strokeStyle=s.strokeColor,e.beginPath(),e.arc(a,l,s.radius*i+o/2,0,2*Math.PI,!1),e.stroke(),e.restore()}hitTest(e){return null}}function Kt(e){return e}const Xt=[{start:0,end:.25,startRadius:4,endRadius:10,startFillAlpha:.25,endFillAlpha:0,startStrokeAlpha:.4,endStrokeAlpha:.8,easing:Kt},{start:.25,end:.525,startRadius:10,endRadius:14,startFillAlpha:0,endFillAlpha:0,startStrokeAlpha:.8,endStrokeAlpha:0,easing:Kt},{start:.525,end:1,startRadius:14,endRadius:14,startFillAlpha:0,endFillAlpha:0,startStrokeAlpha:0,endStrokeAlpha:0,easing:Kt}];function Qt(e,t,s,i){const r=s+(i-s)*t;return(0,ge.applyTransparency)(e,(0,ge.alphaToTransparency)(r))}const Zt=(0,Nt.getHexColorByName)("color-minty-green-400"),Jt=(0,Nt.getHexColorByName)("color-ripe-red-500");function es(e,t,s){const i=e%2600/2600;let r;for(const e of Xt)if(i>=e.start&&i<=e.end){r=e;break}if(void 0===r)throw new Error("Last price animation internal logic error");const o=r.easing((i-r.start)/(r.end-r.start));return{fillColor:Qt(s,o,r.startFillAlpha,r.endFillAlpha),strokeColor:Qt(s,o,r.startStrokeAlpha,r.endStrokeAlpha),radius:(n=o,a=r.startRadius,l=r.endRadius,a+(l-a)*n)};var n,a,l}class ts{constructor(e){this._renderer=new $t,this._invalidated=!0,this._stageInvalidated=!0,this._startTime=performance.now(),this._endTime=this._startTime-1,this._prevRenderedPrice=null,this._series=e}update(e){if(this._invalidated=!0,"data-source-change"===e.type&&e.sourceId===this._series.id()&&e.realtime&&this._series.seriesLoaded()){const e=performance.now(),t=this._endTime-e;if(t>0)return void(t<650&&(this._endTime+=2600));this._startTime=e,this._endTime=e+2600}}invalidateStage(){this._stageInvalidated=!0}animationActive(){return performance.now()<=this._endTime}stopAnimation(){this._endTime=this._startTime-1}renderer(e){return this._invalidated?(this._updateImpl(e),this._invalidated=!1,this._stageInvalidated=!1):this._stageInvalidated&&(this._updateRendererDataStage(),this._stageInvalidated=!1),this._renderer}_updateImpl(e){this._renderer.setData(null);const t=this._series.model().timeScale(),s=t.visibleBarsStrictRange(),i=this._series.firstValue(),r=this._series.lastValueData(void 0,!0,!0);if(null===s||null===i||void 0===r.index||void 0===r.price||!s.contains(r.index))return;const o=new Pt.Point(t.indexToCoordinate(r.index),this._series.priceScale().priceToCoordinate(r.price,i)),n=r.color,a=this._series.properties().childs();let l;switch(this._series.style()){case 3:l=a.areaStyle.childs().linewidth.value();break;case 10:const t=a.baselineStyle,s=Math.round(e.mediaSize.height*(Math.abs(100-t.childs().baseLevelPercentage.value())/100))
;l=o.y<=s?t.childs().topLineWidth.value():t.childs().bottomLineWidth.value();break;case 14:l=a.lineWithMarkersStyle.childs().linewidth.value();break;case 15:l=a.steplineStyle.childs().linewidth.value();break;default:l=a.lineStyle.childs().linewidth.value()}this._lastBaseColor=null===this._prevRenderedPrice||this._prevRenderedPrice===r.price?n:this._prevRenderedPrice<r.price?Zt:Jt;const d=es(this._duration(),0,this._lastBaseColor);this._renderer.setData({seriesLineColor:n,seriesLineWidth:l,fillColor:d.fillColor,strokeColor:d.strokeColor,radius:d.radius,center:o}),this._prevRenderedPrice=r.price}_updateRendererDataStage(){const e=this._renderer.data();if(null!==e){const t=es(this._duration(),e.seriesLineColor,this._lastBaseColor);e.fillColor=t.fillColor,e.strokeColor=t.strokeColor,e.radius=t.radius}}_duration(){return this.animationActive()?performance.now()-this._startTime:2599}}var ss=s(219849),is=s(375397),rs=s(501372),os=s(124066),ns=s(395394);const as=P.enabled("chart_style_hilo_last_price");class ls extends yt{constructor(e){super(e),this._lineRendererData.linestyle=vt.LINESTYLE_DOTTED}_updateImpl(){this._lineRendererData.visible=!1;const e=this._series.properties().childs();if(!e.showPriceLine.value())return;if(!as&&12===e.style.value())return;const t=8===e.style.value()&&e.haStyle.childs().showRealLastPrice.value(),s=this._series.lastValueData(t?4:void 0,!0);if(s.noData)return;let i=s.coordinate;if(t){const e=this._series.firstValue(),t=this._series.data().lastProjectionPrice;if(null===e||void 0===t)return;i=this._series.priceScale().priceToCoordinate(t,e)}this._lineRendererData.visible=!0,this._lineRendererData.y=i,this._lineRendererData.color=this._series.priceLineColor(s.color),this._lineRendererData.linewidth=e.priceLineWidth.value()}}var ds=s(483275),us=s(733828),hs=s(982949),cs=s(112377),_s=s(161160),ps=s(665798);class Ss extends _s.PaneRendererSeriesBase{constructor(e){super(),this._barSpacing=1,this._barWidth=1,this._isPriceScaleInverted=!1,this._bars=e.bars,this._barSpacing=e.barSpacing,this._isPriceScaleInverted=e.isPriceScaleInverted}_drawImpl(e){const{context:t,horizontalPixelRatio:s,verticalPixelRatio:i}=e;t.save(),this._barWidth=Math.round(this._barSpacing*s),this._drawWicks(t,s,i),this._drawBorder(t,s,i),this._drawBars(t,s,i)}_getTolerance(){return(0,wt.interactionTolerance)().series+.5}_drawBars(e,t,s){let i="",r=null;const o=this._calculateBorderWidth(t);for(const n of this._bars){if(this._barWidth<=2*o)continue;let a=Math.round(Math.min(n.open,n.close)*s),l=Math.round(Math.max(n.open,n.close)*s),d=Math.round(n.center*t)-Math.floor(.5*this._barWidth),u=d+this._barWidth-1;if(n.color!==i){const t=n.color;e.fillStyle=t,i=t}null!==r&&(d=Math.max(r+1,d-1),d=Math.min(d,u)),r=u,d+=o,a+=o,u-=o,l-=o,a>l||e.fillRect(d,a,u-d+1,l-a+1)}}_drawBorder(e,t,s){const i=this._calculateBorderWidth(t);let r="",o=null;for(const n of this._bars){n.borderColor!==r&&(e.fillStyle=n.borderColor,r=n.borderColor);let a=Math.round(n.center*t)-Math.floor(.5*this._barWidth)
;const l=a+this._barWidth-1,d=Math.round(Math.min(n.open,n.close)*s),u=Math.round(Math.max(n.open,n.close)*s);if(null!==o&&(a=Math.max(o+1,a-1),a=Math.min(a,l)),this._barSpacing*t>2*i)(0,ps.fillRectInnerBorder)(e,a,d,l-a+1,u-d+1,i);else{const t=l-a+1;e.fillRect(a,d,t,u-d+1)}o=l}}_drawWicks(e,t,s){const i=this._bars;let r=Math.min(Math.floor(t),Math.floor(this._barSpacing*t));r=Math.max(Math.floor(t),Math.min(r,this._barWidth));const o=Math.floor(.5*r);let n="";for(const a of i){a.wickColor!==n&&(e.fillStyle=a.wickColor,n=a.wickColor);let i=Math.round(Math.min(a.open,a.close)*s),l=Math.round(Math.max(a.open,a.close)*s);this._isPriceScaleInverted&&([l,i]=[i,l]);const d=Math.round(a.high*s),u=Math.round(a.low*s),h=Math.round(t*a.center)-o,c=h+r-1-h+1;e.fillRect(h,d,c,i-d),u!==l&&e.fillRect(h,l+1,c,u-l-1)}}_calculateBorderWidth(e){let t=Math.floor(e);this._barWidth<=2*t&&(t=Math.floor(.5*(this._barWidth-1)));const s=Math.max(Math.floor(e),t);return this._barWidth<=2*s?Math.floor(e):s}}class ms extends xt{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={bars:this._bars,barSpacing:this._model.timeScale().barSpacing(),isPriceScaleInverted:this._series.priceScale().isInverted()},t=new hs.CompositeRenderer;return t.append(new Ss(e)),this._model.selection().isSelected(this._series)&&this._isMarkersEnabled&&this._selectionData&&t.append(new cs.SelectionRenderer(this._selectionData)),t}}class ys extends At{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={bars:this._bars,barSpacing:this._model.timeScale().barSpacing(),isPriceScaleInverted:this._series.priceScale().isInverted()};return new Ss(e)}}class vs extends xt{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={bars:this._bars,barSpacing:.9*this._model.timeScale().barSpacing(),isPriceScaleInverted:this._series.priceScale().isInverted()},t=new hs.CompositeRenderer;return t.append(new Ss(e)),this._model.selection().isSelected(this._series)&&this._isMarkersEnabled&&this._selectionData&&t.append(new cs.SelectionRenderer(this._selectionData)),t}}class gs extends At{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={bars:this._bars,barSpacing:.9*this._model.timeScale().barSpacing(),isPriceScaleInverted:this._series.priceScale().isInverted()};return new Ss(e)}}var bs,fs=s(203308);class ws extends _s.PaneRendererSeriesBase{constructor(e){super(),this._bars=e.bars,this._barSpacing=e.barSpacing,this._barLineWidth=Math.max(1,(0,wt.optimalBarWidth)(e.barSpacing,1))}_drawImpl(e){const{context:t,horizontalPixelRatio:s,verticalPixelRatio:i}=e;let r,o,n;t.save(),t.lineCap="square";const a=Math.floor(s)%2?1:0;for(const e of this._bars){const l=Math.round(s*this._barLineWidth*.5),d=Math.round(s*e.center-l),u=void 0===o||e.isUp?Math.round(i*e.high-l):o,h=2*l;let c;if(e.isTwoColorBar){const s=Math.round(i*e.additionalPrice-i*e.high+l),o=u+s,n=Math.round(i*e.low-i*e.additionalPrice+l),_=void 0!==r&&e.isUp?r:o+n;t.fillStyle=e.upColor,t.fillRect(d,u,h+a,s),
t.fillStyle=e.downColor,t.fillRect(d,o,h+a,_+l-o+1),c=_}else{const s=Math.round(i*e.low-i*e.high+l),o=void 0!==r&&e.isUp?r:u+s;t.fillStyle=e.color,t.fillRect(d,u,h+a,o+l-u+1),c=o}if(!e.combinedWithProjection){e.isTwoColorBar?t.fillStyle=e.isUp?e.downColor:e.upColor:t.fillStyle=e.color;const r=void 0===n?Math.round((e.center-this._barSpacing)*s+l):n+2*l,d=Math.round(e.center*s-l)-r+1,u=2*l+a;if(e.isUp)t.fillRect(r,c-l+1-a,d,u);else{const s=void 0===o?Math.round(e.open*i-l):o;t.fillRect(r,s,d,u)}}n=d,r=c,o=u}t.restore()}_getTolerance(){return(0,wt.interactionTolerance)().series+this._barLineWidth/4}}function Ps(e,t){const s={};return s.upColor=e.upColor,s.downColor=e.downColor,s.isTwoColorBar=e.isTwoColorBar,(0,fs.default)(t)&&(s.additionalPrice=t),s}class Cs extends xt{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()},t=new hs.CompositeRenderer;return t.append(new ws(e)),this._model.selection().isSelected(this._series)&&this._isMarkersEnabled&&this._selectionData&&t.append(new cs.SelectionRenderer(this._selectionData)),t}_barItem(e,t,s){const i=super._barItem(e,t,s);if(null===i)return null;const r=Ps(this._series.barColorer().barStyle(s,!1,e),t[6]);return{...i,...r}}}class Is extends At{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()};return new ws(e)}_barItem(e,t,s){const i=super._barItem(e,t,s);if(null===i)return null;const r=this._series.barColorer().barStyle(s,!0,e),n=t[6],a=Ps(r,n);return(0,fs.default)(n)&&i.timePointIndex===(0,o.ensureNotNull)(this.bars().lastIndex())&&(a.combinedWithProjection=!0),{...i,...a}}}!function(e){e[e.EllipseWidth=.9]="EllipseWidth",e[e.EllipseRadius=.95]="EllipseRadius",e[e.SimplifiedEllipseWidth=.86]="SimplifiedEllipseWidth"}(bs||(bs={}));class Ts extends _s.PaneRendererSeriesBase{constructor(e){super(),this._bars=e.bars,this._barSpacing=e.barSpacing,this._barWidth=e.barSpacing}_drawImpl(e){const{context:t,horizontalPixelRatio:s,verticalPixelRatio:i}=e;if(0===this._bars.length)return;t.save();const r=this._bars.reduce(((e,t)=>Math.max(e,(t.low-t.high)/t.additionalNum)),0);this._barSpacing>1&&r>=1?this._drawFillSigns(t,s,i):this._drawSimplified(t,s,i),t.restore()}_getTolerance(){return(0,wt.interactionTolerance)().series+this._barWidth/8}_drawBarCross(e,t,s,i){!function(e,t,s,i,r){e.moveTo(t,s),e.lineTo(t+i,s+r),e.moveTo(t+i,s),e.lineTo(t,s+r)}(e,t.center-.5*this._barWidth,t.high+i*s,this._barWidth,s)}_drawBarEllipse(e,t,s,i){!function(e,t,s,i,r){e.save(),e.translate(t+i/2,s+r/2),e.scale(i/2,r/2),e.moveTo(1,0),e.arc(0,0,bs.EllipseRadius,0,2*Math.PI,!1),e.restore()}(e,t.center-this._barWidth*bs.EllipseWidth*.5,t.high+i*s,this._barWidth*bs.EllipseWidth,s)}_drawFillSigns(e,t,s){e.scale(t,s),e.lineCap="butt",e.lineWidth=1;for(const t of this._bars){const s=(t.low-t.high)/t.additionalNum;if(t.isMergedBar&&(e.beginPath(),t.isUp?this._drawBarEllipse(e,t,s,t.additionalNum-1):this._drawBarCross(e,t,s,0),
e.strokeStyle=t.isUp?t.downColor:t.upColor,e.stroke()),e.beginPath(),t.isUp)for(let i=t.additionalNum-1-(t.isMergedBar?1:0);i>-1;i--)this._drawBarCross(e,t,s,i);else for(let i=t.isMergedBar?1:0;i<t.additionalNum;i++)this._drawBarEllipse(e,t,s,i);e.strokeStyle=t.color,e.stroke()}}_drawSimplified(e,t,s){for(const i of this._bars){const r=i.isUp?1:bs.SimplifiedEllipseWidth,o=(i.center-.5*this._barWidth*r)*t,n=(i.center+.5*this._barWidth*r)*t,a=Math.max(1,n-o);let l=i.high*s;const d=i.low*s,u=i.high*s;let h=Math.max(1,d-u);if(i.isMergedBar){e.fillStyle=i.isUp?i.downColor:i.upColor;const t=(i.low-i.high)/i.additionalNum,s=Math.max(1,Math.round(t));i.isUp?(e.fillRect(o,l,a,s),l+=s):(e.fillRect(o,l+a-s,a,s),h-=s)}e.fillStyle=i.color,e.fillRect(o,l,a,h)}}}function xs(e,t,s,i){const r={};return r.low=i-.5*t,r.high=s+.5*t,r.upColor=e.upColor,r.downColor=e.downColor,r.isMergedBar=e.isMergedBar,r.additionalNum=Math.round(1+(s-i)/t),r}class As extends xt{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()},t=new hs.CompositeRenderer;return t.append(new Ts(e)),this._model.selection().isSelected(this._series)&&this._isMarkersEnabled&&this._selectionData&&t.append(new cs.SelectionRenderer(this._selectionData)),t}_barItem(e,t,s){const i=super._barItem(e,t,s);if(null===i)return null;const r=xs(this._series.barColorer().barStyle(s,!1,e),(0,o.ensureDefined)(this._series.data().boxSize),i.high,i.low);return{...i,isUp:(0,o.ensureDefined)(i.isUp),...r}}}class Rs extends At{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={bars:this._bars,barSpacing:this._model.timeScale().barSpacing()};return new Ts(e)}_barItem(e,t,s){const i=super._barItem(e,t,s);if(null===i)return null;const r=xs(this._series.barColorer().barStyle(s,!0,e),(0,o.ensureDefined)(this._series.data().boxSize),i.high,i.low);return{...i,isUp:(0,o.ensureDefined)(i.isUp),...r}}}var Es=s(315641),Vs=s(309152),Ds=s(88854),Bs=s(452647),Ns=s(314218),Ms=s(836835);class Ls extends Ds.SeriesCandlesPaneView{renderer(){this._invalidated&&(this._updateImpl(null),this._invalidated=!1);const e=this._source.priceScale();if(!e)return null;const t=this._source.properties().childs().haStyle.childs(),s=this._model.timeScale().barSpacing(),i={bars:this._bars,barSpacing:s,bodyVisible:t.drawBody.value(),borderVisible:t.drawBorder.value(),borderColor:t.borderColor.value(),wickColor:t.wickColor.value(),barWidth:(0,wt.optimalBarWidth)(s),wickVisible:t.drawWick.value(),isPriceScaleInverted:e.isInverted()},r=new hs.CompositeRenderer;return r.append(new ft.PaneRendererCandles(i)),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&r.append(new cs.SelectionRenderer(this._selectionData)),r}}var Os=s(649171),ks=s(856122),Ws=s(293269),Fs=s(269734),Us=s(434396),Hs=(s(339709),s(519073)),Gs=s(725356),js=s(287741),qs=s(149109);class zs extends yt{constructor(e){super(e)}_updateImpl(){this._lineRendererData.visible=!1
;const e=this._series.priceScale().mode();if(!e.percentage&&!e.indexedTo100)return;const t=this._series.firstValue();null!==t&&(this._lineRendererData.visible=!0,this._lineRendererData.y=this._series.priceScale().priceToCoordinate(t,t),this._lineRendererData.color=this._series.properties().childs().baseLineColor.value())}}var Ys=s(643322),$s=s(757402);const Ks=P.enabled("price_scale_always_last_bar_value"),Xs=P.enabled("display_data_mode"),Qs=n.CheckMobile.any(),Zs=!P.enabled("hide_series_legend_item"),Js=P.enabled("hide_price_scale_global_last_bar_value"),ei=P.enabled("no_bars_status"),ti=P.enabled("charting_library_debug_mode"),si=P.enabled("chart_style_hilo_last_price"),ii=(0,d.getLogger)("Chart.Series");let ri=!1;const oi={countdownEnabled:!0,lastPriceAnimationEnabled:!0};function ni(e,t,s){return void 0===t?null:`${e}=${t} (${s?"changed":"unchanged"})`}function ai(e){const t=e.state();return t.data.forEach((e=>e.value.splice(7,1))),t}function li(e){const{seriesStatus:t,additionalStudyStatus:s}=e;if(b.seriesLoadingStatuses.has(t))return 2;if(s){if(4!==t&&s.type===$s.StudyStatusType.Error)return 13;if(b.seriesReadyStatuses.has(t)&&(s.type===$s.StudyStatusType.Loading||s.type===$s.StudyStatusType.Undefined))return 2}return t}class di extends h.PriceDataSource{constructor(e,t,n,l){var d,h,c;t.removeProperty("currencyId"),super(e,"_seriesId"),this.requestingStyleIsNotSupported=new Ye.Delegate,this.requestingStyleSupportRecovered=new Ye.Delegate,this._paneView=null,this._futureBarsPaneView=null,this._projectionBarsPaneView=null,this._waterlineView=null,this._priceLineView=null,this._gotoDateView=null,this._baseHorizontalLineView=null,this._priceStep=null,this._symbolInfo=new is.WatchedValue(null),this._isPrePostMarketPricesAvailableProperty=new y.Property(!1),this._isBackAdjustmentForbiddenProperty=new y.Property(!0),this._isSettlementAsCloseForbiddenProperty=new y.Property(!0),this._highLowPriceCache=new Map,this._averagePriceCache=new Map,this._prevClosePriceAxisView=null,this._priceScaleAboutToBeChanged=new Ye.Delegate,this._onRestarted=new Ye.Delegate,this._onStatusChanged=new Ye.Delegate,this._tagsChanged=new Ye.Delegate,this._intervalChanged=new Ye.Delegate,this._sessionIdChanged=new Ye.Delegate,this._requestMoreDataAvailable=!0,this._lineStyleLastPriceCirclePaneView=new ts(this),this._prevClosePriceLineView=null,this._dataPoweredBy=null,this._symbolResolvingActive=new is.WatchedValue(!1),this._predictBars=0,this._syncModel=null,this._data=null,this._lastCompleteFlags=null,this._haStyle={studyId:(0,o.ensureNotNull)((0,v.chartStyleStudyId)(8,!0))},this._renkoStyle={studyId:(0,o.ensureNotNull)((0,v.chartStyleStudyId)(4,!0))},this._pbStyle={studyId:(0,o.ensureNotNull)((0,v.chartStyleStudyId)(7,!0))},this._kagiStyle={studyId:(0,o.ensureNotNull)((0,v.chartStyleStudyId)(5,!0))},this._pnfStyle={studyId:(0,o.ensureNotNull)((0,v.chartStyleStudyId)(6,!0))},this._rangeStyle={studyId:(0,o.ensureNotNull)((0,v.chartStyleStudyId)(11,!0))},this._volFootprintStyle={studyId:(0,o.ensureNotNull)((0,v.chartStyleStudyId)(17,!0))},
this._tpoStyle={studyId:(0,o.ensureNotNull)((0,v.chartStyleStudyId)(18,!0))},this._svpStyle={studyId:(0,o.ensureNotNull)((0,v.chartStyleStudyId)(20,!0))},this._barColorerCache=null,this._boxSizeValue=new is.WatchedValue,this._base=100,this._pointValue=1,this._formattingDeps=null,this._defaultFormatter=new g.PriceFormatter({priceScale:this._base}),this._formatter=new g.PriceFormatter({priceScale:this._base}),this._ignoreMinMoveFormatter=new g.PriceFormatter({priceScale:this._base}),this._ignoreMinMovePriceStep=null,this._lastBarCloseTime=null,this._onSessionIdPropertyChangedBound=this._onSessionIdPropertyChanged.bind(this),this._ignoreSessionIdProxyPropertyChanges=!1,this._textSourceIsAlwaysTickerRestrictionEnabled=!1,this._lastPriceAnimationActive=!1,this._currentSession="out_of_session",this._onStyleChanged=new Ye.Delegate,this._intervalObj=null,this._obsoleteZOrder=0,this._seriesErrorMessage=null,this._seriesAlwaysFalseHibernatedVW=new is.WatchedValue(!1),this._styleToRecover=null,this._precomputedBarStyles=new WeakMap,this._doNotShowLastAvailableBar=!1,this._gotoDateResultCleared=!1,this._endOfDataPaneView=null,this._pendingTimeRange=null,this._replaySubscriber=new is.WatchedValue(null),this._symbolIntervalChanged=new Ye.Delegate,this._isReplayResolutionAvailableForUser=null,this._onInReplayStateChanged=new Ye.Delegate,this._replayExitedDueUnsupportedInterval=new Ye.Delegate,this._replayExitedDueUnsupportedSymbol=new Ye.Delegate,this._replayExitedDueUnavailableForUserInterval=new Ye.Delegate,this._onTimeFrameApplied=new Ye.Delegate,this._seriesLoaded=!1,this._seriesCompleted=!1,this._status=new is.WatchedValue({seriesStatus:0}),this._prevRequestedInterval="",this._isActingAsSymbolSource=new is.WatchedValue(!0),this._unsupportedResolutionState=new is.WatchedValue(null),this._countdownUpdateTimer=null,this._deferredDestroyed=(0,u.createDeferredPromise)(),this._volumePointWeights=null,this._studyBindings=null,this._updateTimeScaleTimePointWeights=()=>{this._model.timeScale().setTimePointWeights(19===this.style()?this._volumePointWeights:null)},this._seriesStatus=(0,Ys.combine)(li,this._status.weakReference()),this._studyBindings=new ht(this),this._studyBindings.onStatusChanged().subscribe(this,(()=>{var e;const t=this.status(),s=this._status.value(),i=null===(e=this._studyBindings)||void 0===e?void 0:e.status();this._updateStatus({...this._status.value(),additionalStudyStatus:i}),this.status()!==t&&(this._statusView.update(),this._model.updateSource(this)),(0,r.default)(s,this._status)||this._onStatusChanged.fire()})),this._seriesSource=new rs.SeriesDataSource(e.chartApi(),"s",l);const _=this._seriesSource.dataEvents();_.symbolResolved().subscribe(this,this._onSymbolResolved),_.symbolError().subscribe(this,this._onSymbolError),_.seriesTimeFrame().subscribe(this,this._onSeriesTimeFrame),_.seriesError().subscribe(this,this._onSeriesError),_.loading().subscribe(this,this._onSeriesLoading),_.completed().subscribe(this,this._onSeriesCompleted),_.dataUpdated().subscribe(this,this._onDataUpdated),
_.barReceived().subscribe(this,this._onBarReceived),_.unsupportedResolutionRequested().subscribe(this,this._onUnsupportedResolutionRequested),this._quotesProvider=new ve.QuotesProvider(void 0,e.collapsed().spawnOwnership()),this._quotesProvider.quotesUpdate().subscribe(this,this._onQuotesUpdate);const p=t.childs();if(t.hasChild("extendedHours")){(0,o.ensureDefined)(p.extendedHours).value()&&!t.hasChild("sessionId")&&t.addChild("sessionId",new y.Property("extended")),t.removeProperty("extendedHours")}t.hasChild("sessionId")||t.addChild("sessionId",new y.Property(i.Regular)),(0,qs.allChartStyles)().includes(p.style.value())||p.style.setValueSilently(2);const S=p.lineStyle.childs();if(p.lineStyle.hasChild("styleType")){let e,t;const s=S.styleType.value();0===s&&(t=14,e=p.lineWithMarkersStyle.childs()),1===s&&(t=15,e=p.steplineStyle.childs()),e&&(e.color.setValueSilently(S.color.value()),e.linestyle.setValueSilently(S.linestyle.value()),e.linewidth.setValueSilently(S.linewidth.value()),e.priceSource.setValueSilently(S.priceSource.value())),void 0!==t&&2===p.style.value()&&p.style.setValue(t),p.lineStyle.removeProperty("styleType")}null===(d=this._studyBindings)||void 0===d||d.bindToSeriesProperties(t),this._setProperties(t),this._sessionIdProxyProperty=new y.Property(p.sessionId.value()),p.sessionId.subscribe(this,(()=>this._updateSessionIdProxyProperty())),this._sessionIdProxyProperty.subscribe(this,this._onSessionIdProxyPropertyChanged),this._symbolTextSourceProxyProperty=new y.Property,this._recalcSymbolTextSourceProxyProperty(),p.statusViewStyle.childs().symbolTextSource.subscribe(this,this._recalcSymbolTextSourceProxyProperty),this._symbolTextSourceProxyProperty.subscribe(this,(()=>e.lightUpdate())),this._options=(0,pe.merge)((0,pe.clone)(oi),n),this._prevChartStyle=p.style.value(),this._priceAxisView=new Ve(this,e,{alwaysShowGlobalLast:!Js,showCountdown:n.countdownEnabled});let m=null;Ks||Js||(m=new Ve(this,e,{visibleOnHistoryOnly:!0,showSymbolLabel:!1,showCountdown:!1,alwaysShowGlobalLast:!1,useSolidBodyColor:!1})),this._priceLinePriceAxisView=new Vt.SeriesPriceLineAxisView(this),this._priceLineAxisViews=[this._priceLinePriceAxisView];const f=new Dt(this,e,{showCountdown:n.countdownEnabled});this._priceAxisViews=[this._priceAxisView,f],null!==m&&this._priceAxisViews.push(m),this._prevClosePriceAxisView=new St(this,e),this._priceAxisViews.unshift(this._prevClosePriceAxisView),this._prevClosePriceLineView=new gt(this),this._panePriceAxisView=new Bt.PanePriceAxisView(this._priceAxisView,this,e),this._historyPricePanePriceAxisView=null!==m?new Bt.PanePriceAxisView(m,this,e):null,this._projectionPriceAxisView=new Bt.PanePriceAxisView(f,this,e),this._labelPaneViews=[this._panePriceAxisView,this._projectionPriceAxisView],null!==this._historyPricePanePriceAxisView&&this._labelPaneViews.push(this._historyPricePanePriceAxisView),this._highLowAvgPaneViews=[],this._averagePaneViews=[],this._createHighLowAvgViews(),this._subscribeRestartToSessionIdChange(),p.visible.subscribe(this,this._updateLastPriceAnimationActive),
this._updateLastPriceAnimationActive(),p.minTick.subscribe(this,this._onFormatterPropsChanged),this._dataWindowView=new H(this,e),this._legendView=new q(this,e),this._statusView=new N(this,p.statusViewStyle),this._marketStatusModel=new z.MarketStatusModel(this._quotesProvider),this._dataUpdatedModeModel=Xs?new he(this._symbolInfo.spawn().ownership(),this._seriesStatus.spawn().ownership(),(0,G.createWVFromGetterAndSubscription)((()=>{var e;return null===(e=this._lastCompleteFlags)||void 0===e?void 0:e.rt_update_period}),_.completed()).ownership()):null,this._dataProblemModel=new ye(this._quotesProvider,this._symbolInfo.spawn().ownership()),p.backAdjustment.subscribe(this,(()=>{this.isStarted()&&this.restart()})),p.settlementAsClose.subscribe(this,(()=>{this.isDWM()&&this.isStarted()&&this.restart()})),this._symbolResolvingActive.subscribe((()=>e.realignLineTools())),this._intervalChanged.subscribe(this,(()=>e.realignLineTools())),this._intervalChanged.subscribe(this,(()=>this._checkChartStyle())),P.enabled("widget")||Promise.all([s.e(66476),s.e(75816),s.e(46445),s.e(93703),s.e(21356),s.e(62093),s.e(44524),s.e(46489),s.e(88015),s.e(61443),s.e(82321),s.e(62526),s.e(66849)]).then(s.bind(s,342837)).then((e=>{this._endOfDataPaneView=new e.EndOfDataLollipopPaneView(this)})),null===(h=this._studyBindings)||void 0===h||h.syncStudy(this.style()),Ge.alertsAvailable&&this._symbolResolvingActive.subscribe(this._updateAlertCreationAvailable.bind(this)),this.createPaneView(),this._properties.addExcludedKey("visible",1),this._properties.addExcludedKey("currencyId",1),this._futureBarsPaneView=null,this._priceLineView=null,this._baseHorizontalLineView=new zs(this);for(const[,e]of Object.entries(b.STYLE_SHORT_NAMES))null===(c=this._properties.child(`${e}Style`))||void 0===c||c.subscribe(this,(()=>this.invalidateBarStylesCache()));const w=p.renkoStyle.childs().inputs.childs();w.boxSize.subscribe(this,this.restart),w.style.subscribe(this,this.restart),w.atrLength.subscribe(this,this.restart),w.percentageLTP.subscribe(this,this.restart),w.wicks.subscribe(this,this.restart),w.sources.subscribe(this,this.restart),p.pbStyle.childs().inputs.childs().lb.subscribe(this,this.restart);const C=p.kagiStyle.childs().inputs.childs();C.reversalAmount.subscribe(this,this.restart),C.style.subscribe(this,this.restart),C.atrLength.subscribe(this,this.restart),C.percentageLTP.subscribe(this,this.restart);const I=p.pnfStyle.childs().inputs.childs();I.boxSize.subscribe(this,this.restart),I.reversalAmount.subscribe(this,this.restart),I.sources.subscribe(this,this.restart),I.style.subscribe(this,this.restart),I.atrLength.subscribe(this,this.restart),I.percentageLTP.subscribe(this,this.restart),I.oneStepBackBuilding.subscribe(this,this.restart),p.rangeStyle.childs().inputs.childs().phantomBars.subscribe(this,this.restart),this._isDWMProperty=new y.Property(this.isDWM()),this._onRestarted.subscribe(this,(()=>this._isDWMProperty.setValue(this.isDWM()))),p.dividendsAdjustment.subscribe(this,(()=>{const e=p.dividendsAdjustment.value();(0,
a.trackEvent)("Dividends adjust",!0===e?"On":"Off"),this.restart()})),this._dataPoweredBy=null,p.showCountdown.subscribe(this,this._onShowCountdownChanged),this._onShowCountdownChanged(p.showCountdown),this._recreatePriceFormattingDependencies(),p.lineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),p.lineWithMarkersStyle.childs().priceSource.subscribe(this,this._updateBarFunction),p.steplineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),p.areaStyle.childs().priceSource.subscribe(this,this._updateBarFunction),p.baselineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),p.columnStyle.childs().priceSource.subscribe(this,this._updateBarFunction),p.tpoStyle.childs().priceSource.listeners().subscribe(this,this._updateBarFunction),this._updateBarFunction(),this._isInReplay=(0,Ys.combine)((e=>null!==e),this._replaySubscriber.weakReference()),this._legendValuesProvider=new qt(this,this.model()),this._dataWindowValuesProvider=new Gt.SeriesValuesProvider(this,this.model())}setId(e){var t;super.setId(e),null===(t=(0,ct.getPersistentLogger)())||void 0===t||t.addPersistentLogEntry(`Set series Id to ${e}`,d.LOGLEVEL.INFO,"chart.series")}supportsPressedChunks(){return!0}pressedChunks(e,t){return this.data().pressedChunks(e,t)}seriesErrorMessage(){const{seriesStatus:e,additionalStudyStatus:t}=this._status.value();return this.isFailed()?this._seriesErrorMessage:b.seriesLoadingStatuses.has(e)?null:(null==t?void 0:t.type)===$s.StudyStatusType.Error?(0,$s.convertStudyStatusToString)({type:$s.StudyStatusType.Error,errorDescription:t.errorDescription},!0):null}destroy(){this._seriesStatus.destroy(),this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.destroy(),this.clearGotoDateResult(),this._legendView.destroy(),this._marketStatusModel.destroy(),this._studyBindings&&this._studyBindings.destroy(),null!==this._dataUpdatedModeModel&&this._dataUpdatedModeModel.destroy(),this._dataProblemModel.destroy(),this._paneView&&this._paneView.destroy&&this._paneView.destroy(),this._seriesSource.destroy(),this._quotesProvider.quotesUpdate().unsubscribeAll(this),this._quotesProvider.destroy(),this._model.timeScale().visibleBarsStrictRangeChanged().unsubscribeAll(this),this._unsubscribeRestartToSessionIdChange(),this._replayExitedDueUnsupportedInterval.destroy(),this._replayExitedDueUnsupportedSymbol.destroy(),this._replayExitedDueUnavailableForUserInterval.destroy(),this._onTimeFrameApplied.destroy(),this._deferredDestroyed.resolve(),this._properties.destroy(),this._isInReplay.destroy(),super.destroy()}isActingAsSymbolSource(){return this._isActingAsSymbolSource.readonly()}barColorer(){if(this._barColorerCache)return this._barColorerCache;let e=null;const t=this._model.dataSources();for(let s=t.length-1;s>=0;s--){const i=t[s];if((0,Us.isStudy)(i)&&i.hasBarColorer()&&!i.isSourceHidden()){const t=(0,o.ensureNotNull)(i.barColorer());null===e?e=t:e.pushBackBarColorer(t)}}return null===e?e=new Fs.SeriesBarColorer(this):e.pushBackBarColorer(new Fs.SeriesBarColorer(this)),
this._barColorerCache=e,e}createPaneView(){this._paneView=null,this._projectionBarsPaneView=null,this._waterlineView=null,this._priceLineView=this.hasClosePrice()?new ls(this):null;const e=this._properties.childs().style.value();switch(e){case 0:this._paneView=new Vs.SeriesBarsPaneView(this,this._model);break;case 17:case 19:case 1:this._paneView=new Ds.SeriesCandlesPaneView(this,this._model,1===e||19===e?1:.2);break;case 2:case 18:case 14:case 15:this._paneView=new Bs.SeriesLinePaneView(this,this._model);break;case 3:this._paneView=new Ns.SeriesAreaPaneView(this,this._model);break;case 16:this._paneView=new Ms.SeriesHLCAreaPaneView(this,this._model);break;case 8:this._paneView=new Ls(this,this._model);break;case 9:this._paneView=new Os.SeriesHollowCandlesPaneView(this,this._model);break;case 13:this._paneView=new Es.SeriesColumnsPaneView(this,this._model);break;case 10:{this._paneView=new ks.SeriesBaselinePaneView(this,this._model);const e=this._properties.childs().baselineStyle.childs();this._waterlineView=new ds.SeriesWaterlinePaneView({paneHeight:()=>this.priceScale().height(),color:()=>e.baselineColor.value(),baseLevelPercentage:()=>e.baseLevelPercentage.value()});break}case 12:this._paneView=new us.SeriesHiLoPaneView(this,this._model)}switch(e){case 4:this._paneView=new ms(this,this._model),this._projectionBarsPaneView=new ys(this,this._model);break;case 7:this._paneView=new vs(this,this._model),this._projectionBarsPaneView=new gs(this,this._model);break;case 5:this._paneView=new Cs(this,this._model),this._projectionBarsPaneView=new Is(this,this._model);break;case 6:this._paneView=new As(this,this._model),this._projectionBarsPaneView=new Rs(this,this._model)}if(11===e&&(this._properties.childs().rangeStyle.childs().barStyle.value()===Gs.RangeBarStyle.Bars?(this._paneView=new Vs.SeriesBarsPaneView(this,this._model),this._projectionBarsPaneView=new Rt(this,this._model)):(this._paneView=new Ds.SeriesCandlesPaneView(this,this._model),this._projectionBarsPaneView=new Et(this,this._model))),20===e&&(this._paneView=ze.instance()),null===this._paneView)throw Error("Unknown chart style assigned: "+e)}properties(){return this._properties}zorder(){return 0}quotesProvider(){return this._quotesProvider}currentSession(){return this._currentSession}syncModel(){if(!this._syncModel){const e=this.symbolInfo(),t=this.interval();if(!e||!t)return null;this._syncModel=new J(e,t)}return this._syncModel}labelPaneViews(){return this._labelPaneViews}topPaneViews(){const e=[];if(null!==this._gotoDateView&&e.push(this._gotoDateView),this._lastPriceAnimationActive){const t=this._lineStyleLastPriceCirclePaneView;t.animationActive()&&setTimeout((()=>this._model.invalidate(ss.InvalidationMask.cursor())),0),t.invalidateStage(),e.push(t)}return 0!==e.length?e:null}paneViews(e){var t,s;if(!this.properties().childs().visible.value()||!this._model.isSnapshot()&&!this._wasCompletedBefore())return null;const i=[(0,o.ensureNotNull)(this._baseHorizontalLineView),(0,o.ensureNotNull)(this._paneView)]
;return i.push(...null!==(s=null===(t=this._studyBindings)||void 0===t?void 0:t.paneViews(e))&&void 0!==s?s:[]),this._endOfDataPaneView&&i.push(this._endOfDataPaneView),this._futureBarsPaneView&&i.push(this._futureBarsPaneView),this._projectionBarsPaneView&&i.push(this._projectionBarsPaneView),null!==this._waterlineView&&i.push(this._waterlineView),i.push((0,o.ensureNotNull)(this._prevClosePriceLineView)),null!==this._priceLineView&&i.push(this._priceLineView),window.TradingView.printing&&this._lastPriceAnimationActive&&(this._lineStyleLastPriceCirclePaneView.stopAnimation(),i.push(this._lineStyleLastPriceCirclePaneView)),i.push(...this._highLowAvgPaneViews),i.push(...this._averagePaneViews),i}priceAxisViews(e,t){return e.findTargetPriceAxisViews(this,t,this._priceAxisViews,this._priceLineAxisViews)}clearHighLowPriceCache(){this._highLowPriceCache.clear()}clearAveragePriceCache(){this._averagePriceCache.clear()}priceScale(){return(0,o.ensureNotNull)(this._priceScale)}setPriceScale(e){this._priceScale!==e&&(this._priceScaleAboutToBeChanged.fire(),this._priceScale=e,this._properties.removeProperty("priceAxisProperties"),this._properties.addChild("priceAxisProperties",e.properties()),this._properties.childs().priceAxisProperties.childChanged(null,""),(0,l.emit)("series_event","price_scale_changed"),this._priceScaleChanged.fire(e))}priceScaleChanged(){return this._priceScaleChanged}priceScaleAboutToBeChanged(){return this._priceScaleAboutToBeChanged}applyPreferences(e){const t=(0,pe.clone)(e);this.priceScale().setMode({autoScale:t.priceAxisProperties.autoScale,percentage:t.priceAxisProperties.percentage,log:t.priceAxisProperties.log,lockScale:t.priceAxisProperties.lockScale}),this.setChartStyleWithIntervalIfNeeded(t.style);const{style:s,interval:i,...r}=t;this._properties.mergePreferences(r),this._properties.saveDefaults(),this.createPaneView(),this.invalidateBarStylesCache()}disconnect(){var e;null===(e=this._studyBindings)||void 0===e||e.stop(),this._seriesSource.stop(),this._predictBars=0,this._updateStatus({...this._status.value(),seriesStatus:0}),this._model.isSnapshot()||this._symbolInfo.setValue(null)}isStarted(){return this._seriesSource.isStarted()}isCompleted(){return this._seriesCompleted}restart(){var e;if(5===this._status.value().seriesStatus)return;this._seriesLoaded=!1,this._seriesCompleted=!1,this._lastCompleteFlags=null,this._onRestarted.fire(),this._setStatus(1),this._updateSymbolInfo(null);let t=this._properties.childs().interval.value();$.Interval.isEqual(t,this._prevRequestedInterval)&&this._notifyIntervalChanged(t);let s=null;this._pendingTimeRange&&(s=this._pendingTimeRange,this._pendingTimeRange=null),this._removeReplaySubscriber(),this._onBeforeModifySeries(this.getSymbolString(),t),this._onTimeFrameApplied.fire(s),t=(0,ns.getServerInterval)(t),this._data=null,this.model().recalcVisibleRangeStudies(c.RecalcVisibleRangeStudiesReason.SeriesRestart),this._seriesSource.modifySeries(this._getResolvingSymbolObject(),t,s),this._seriesSource.isStarted()||this._seriesSource.start(),
this._prevRequestedInterval=this.interval(),null===(e=this._studyBindings)||void 0===e||e.restart(),this.updateAllViews((0,xe.sourceChangeEvent)(this.id())),this._model.lightUpdate()}isSymbolInvalid(){return 4===this._status.value().seriesStatus}getSymbolString(){return(0,Yt.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject())}getAlertSymbolString(){return(0,Yt.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject(this.actualSymbol()))}invalidateBarStylesCache(e){ii.logDebug("Invalidate style cache starting from "+e),this._clearStylePlot(this.bars(),e),this._clearStylePlot(this.nsBars())}isLoading(){return b.seriesLoadingStatuses.has(this.statusWV().value())}isFailed(){const e=this.status();return 12===e||4===e||10===e||14===e}isStatusError(){return 12===this.status()}unsupportedResolutionState(){return this._unsupportedResolutionState.readonly()}actualSymbol(){return(0,v.actualSymbol)(this.symbolInfo(),this.symbol())}proSymbol(){return(0,v.proSymbol)(this.symbolInfo(),this.symbol())}onStyleChanged(){return this._onStyleChanged}style(){return this.properties().childs().style.value()}setStyle(e){this.setSymbolParams({style:e})}isRangeBasedStyle(){return(0,v.isRangeBasedStyle)(this.style())}symbolSameAsCurrent(e){return this.symbol()===e||(0,zt.symbolSameAsCurrent)(e,this.symbolInfo())}symbolSameAsResolved(e){return this._model.isSnapshot()?this.symbolSameAsCurrent(e):this._seriesSource.symbolSameAsResolved(e)}status(){return this._seriesStatus.value()}statusWV(){return this._seriesStatus}compositeStatusVW(){return this._status}symbol(){return this.properties().childs().symbol.value()}symbolChanged(){return this.properties().childs().symbol.listeners()}seriesSource(){return this._seriesSource}symbolInfo(){return this._symbolInfo.value()}symbolResolved(){return this.dataEvents().symbolResolved()}symbolResolvingActive(){return this._symbolResolvingActive}symbolHibernated(){return this._seriesAlwaysFalseHibernatedVW}getSymbolName(){var e,t;return null!==(t=null===(e=this.symbolInfo())||void 0===e?void 0:e.name)&&void 0!==t?t:""}firstValue(){const e=this.firstBar();return null===e?null:this._barFunction(e,0)}firstBar(){const e=this.model().timeScale().visibleBarsStrictRange();if(null===e)return null;const t=e.firstBar(),s=this.data().search(t,S.PlotRowSearchMode.NearestRight);return null!==s?s.value:null}formatter(e=!0){return e?this._formatter:this._ignoreMinMoveFormatter}defaultFormatter(){return this._defaultFormatter}priceStep(e=!0){return e?this._priceStep:this._ignoreMinMovePriceStep}bars(){return this.data().bars()}nsBars(){return this.data().nsBars()}interval(){return this.properties().childs().interval.value()}setInterval(e){this.setSymbolParams({interval:e})}intervalObj(){const e=this.interval();if(null!==this._intervalObj&&this._intervalObj.resolutionString===e)return this._intervalObj.interval;const t=$.Interval.parse(e);return this._intervalObj={resolutionString:e,interval:t},t}prevClose(){const e=this.priceScale();if(e.isEmpty()||this.data().isEmpty())return null
;const t=this.quotes(),s=this.firstValue();if(null===t||null===s)return null;const i=t.prev_close_price;return void 0===i?null:{coordinate:e.priceToCoordinate(i,s),floatCoordinate:e.priceToCoordinate(i,s),formattedPricePercentage:e.formatPricePercentage(i,s,{signPositive:!0}),formattedPriceAbsolute:e.formatPriceAbsolute(i),formattedPriceIndexedTo100:e.formatPriceIndexedTo100(i,s)}}priceLineColor(e){return this.properties().childs().priceLineColor.value()||e}hasClosePrice(){return si||12!==this.properties().childs().style.value()}lastValueData(e,t,s){var i;const r={noData:!0},o=this.priceScale();if(this.model().timeScale().isEmpty()||o.isEmpty()||this.data().isEmpty())return r;const n=this.model().timeScale().visibleBarsStrictRange(),a=this.firstValue();if(null===n||null===a)return r;let l,d;if(t){const e=this.data().bars().last();if(null===e)return r;l=e.value,d=e.index}else{const e=this.data().bars().search(n.lastBar(),S.PlotRowSearchMode.NearestLeft);if(null===e)return r;l=e.value,d=e.index}const u=null!==(i=void 0!==e?l[e]:this._barFunction(l,2))&&void 0!==i?i:NaN,h=this.barColorer().barStyle(d,!1),c=o.priceToCoordinate(u,a),_={...o.getFormattedValues(u,a,!0),noData:!1,color:h.barColor,floatCoordinate:c,coordinate:c,index:d};return s&&(_.price=u),_}isDWM(){return this.intervalObj().isDWM()}isPulse(){var e;const t=this.symbolInfo();return null!==t&&(null!==(e=t.resolutions)&&void 0!==e?e:[]).length>0}data(){var e;return null!==(e=this._data)&&void 0!==e?e:this._seriesSource.data()}clearData(){var e;(0,o.assert)(null===this._data,"Cannot clear loaded data"),null===(e=this._studyBindings)||void 0===e||e.clearData(),this._seriesSource.clearData()}nearestData(e,t){var s;return null!==(s=this.data().search(e,t))&&void 0!==s?s:void 0}nearestIndex(e,t){var s;return null===(s=this.nearestData(e,t))||void 0===s?void 0:s.index}nearestValue(e,t,s){var i;const r=this.nearestData(e,s);return null!==(i=null==r?void 0:r.value[t])&&void 0!==i?i:void 0}onSymbolIntervalChanged(){return this._symbolIntervalChanged}onIntervalChanged(){return this._intervalChanged}onStatusChanged(){return this._onStatusChanged}onRestarted(){return this._onRestarted}fixLastBar(e){if(!this._futureBarsPaneView){const t=this.bars().lastIndex();t&&(this._futureBarsPaneView=new He(this.model().timeScale(),this,t,e))}}requestMoreData(e){var t,s;if(!b.seriesReadyStatuses.has(this._status.value().seriesStatus))return;if(this._model.timeScale().isEmpty())return;const i=this._model.timeScale().visibleBarsStrictRange();if(null===i)return;if(0===this.bars().size())return;const r=i.lastBar()-(0,o.ensureNotNull)(this.data().last()).index;if(this._predictBars<r&&(this._predictBars=r,this._seriesSource.requestMoreTickmarks(r)),!this._requestMoreDataAvailable)return;const n=(0,o.ensureNotNull)(this.bars().firstIndex()),a=e||Math.max(n-i.firstBar(),n-(null!==(s=null===(t=this._studyBindings)||void 0===t?void 0:t.requestMoreDataIndex())&&void 0!==s?s:n));a<=0||(Number.isFinite(a)?(this._requestMoreDataAvailable=!1,this._seriesSource.requestMoreData(a),
this._setStatus(2)):ii.logWarn("requestMoreData: invalid bar count: "+a+", visible bars: ["+i.firstBar()+", "+i.lastBar()+"], last index: "+(0,o.ensureNotNull)(this.data().last()).index+", predicted bars: "+this._predictBars+", required bars:"+e))}isNeedRestart(e){return 5!==this._status.value().seriesStatus&&(void 0===e&&(e=this.properties().childs().style.value()),(0,v.styleChangeRequiresRestart)(this._prevChartStyle,e))}isStyleSupported(e){return!this.isInReplay().value()||(0,v.isStyleSupportedForReplay)(e)}sessionId(){return this.properties().childs().sessionId.value()}sessionIdChanged(){return this._sessionIdChanged}priceRange(e,t,s){var i,r;const n=this._priceScale;if(this.data().isEmpty()||!n)return null;if(n.isLockScale()){const e=this._model.mainSeriesScaleRatio();if(null!==e){const s=n.internalHeight()/(this.model().timeScale().barSpacing()/e),i=(0,o.ensureNotNull)(this.data().search(t,S.PlotRowSearchMode.NearestLeft)).value,r=((0,o.ensure)(i[2])+(0,o.ensure)(i[3]))/2;return new m.PriceRange(r-.5*s,r+.5*s)}}const a=this.priceSource();let l,d,u;if(null!==a?(l=this.data().bars().minMaxOnRangeCached(e,t,[{name:a,offset:0}]),d=this.data().nsBars().minMaxOnRangeCached(e,t,[{name:a,offset:0}])):(l=this.data().bars().minMaxOnRangeCached(e,t,[{name:"low",offset:0},{name:"high",offset:0}]),d=this.data().nsBars().minMaxOnRange(e,t,[{name:"low",offset:0},{name:"high",offset:0}])),l=(0,p.mergeMinMax)(l,d),null===l)u=new m.PriceRange(-.5,.5);else if(l.min===l.max){const e=5/(null!==(r=null===(i=this.symbolInfo())||void 0===i?void 0:i.pricescale)&&void 0!==r?r:100);u=new m.PriceRange(l.min-e,l.max+e)}else u=new m.PriceRange(l.min,l.max);return n.isLog()?new m.PriceRange(n.priceToLogical(u.minValue()),n.priceToLogical(u.maxValue())):u}autoScaleInfo(e,t,s){var i,r,o,n;let a={range:this.priceRange(e,t,{...s,scaleSeriesOnly:!0}),topPixelMargin:null===(r=null===(i=this._paneView)||void 0===i?void 0:i.topPixelMargin)||void 0===r?void 0:r.call(i),bottomPixelMargin:null===(n=null===(o=this._paneView)||void 0===o?void 0:o.bottomPixelMargin)||void 0===n?void 0:n.call(o)};if(!s.scaleSeriesOnly){const i=this._model.allStudies().filter((e=>e.isVisible())),r=(e,t)=>void 0===e?t:void 0===t?e:Math.max(e,t),o=i.map((i=>i.autoScaleInfo(e,t,{...s,forceOverlayOnly:!0})));this._studyBindings&&o.push(...this._studyBindings.autoScaleInfos(e,t,s));const n=(e,t)=>({range:e.range?t.range?e.range.merge(t.range):e.range:t.range,topPixelMargin:r(e.topPixelMargin,t.topPixelMargin),bottomPixelMargin:r(e.bottomPixelMargin,t.bottomPixelMargin)});a=o.reduce(n,a)}return a}onChartStyleChanged(){var e,t;this._updateBarFunction(),this.isNeedRestart()&&(this.data().clear(),this.model().timeScale().scrollToRealtime(!1),this.isInReplay().value()&&!(0,v.isStyleSupportedForReplay)(this.style())&&this._removeReplaySubscriber(),this.restart());const s=this.properties();this._prevChartStyle!==s.childs().style.value()&&(null===(e=this._studyBindings)||void 0===e||e.syncStudy(this.style())),this._prevChartStyle=s.childs().style.value(),
this._onStyleChanged.fire(s.childs().style.value()),this.invalidateBarStylesCache(),this._updateLastPriceAnimationActive(),(null===(t=this._styleToRecover)||void 0===t?void 0:t.originalStyle)!==this.style()&&(this._styleToRecover=null),this._updateTimeScaleTimePointWeights()}setChartStyleWithIntervalIfNeeded(e,t){const s=this.interval(),i=null!=t?t:(0,ns.getResolutionByChartStyle)(e,s,this._model.defaultResolutions()),r=$.Interval.isEqual(i,s);this.setSymbolParams({interval:r?void 0:i,style:e})}getInputsProperties(){var e;const t=this._properties.child(`${this.getStyleShortName()}Style`);return null!==(e=null==t?void 0:t.childs().inputs)&&void 0!==e?e:new y.Property}getInputsInfoProperties(){var e,t;const s=null===(e=this._studyBindings)||void 0===e?void 0:e.getInputsInfoProperties();if(s)return s;const i=this._properties.child(`${this.getStyleShortName()}Style`);return null!==(t=null==i?void 0:i.childs().inputInfo)&&void 0!==t?t:new y.Property}getSourceIcon(){return{type:"loadSvg",svgId:`series.${this.style()}`}}purgeSymbolInfo(){this._symbolInfo.setValue(null)}idForAlert(){return(0,Ne.getSeriesIdForAlert)(this.getSymbolString(),this.interval())}hasStateForAlert(){return super.hasStateForAlert()&&!(0,v.isEconomicSymbol)(this.symbolInfo())}stateForAlert(){var e;const t=this.idForAlert(),s=Me.FormattersSerializer.serialize(this._formatter);let r;const o=this.isDWM()?i.Regular:this.sessionIdProxyProperty().value(),n=this.symbolInfo();if(n&&n.subsessions&&n.subsessions.length>1){const t=null===(e=n.subsessions)||void 0===e?void 0:e.find((e=>e.id===o));t&&(r=(0,Le.translateSessionExtendedDescription)(t.description))}const a=this.properties().childs(),l={id:t,uniqueId:t,type:"MainSeries",proSymbol:this.proSymbol(),actualSymbol:this.actualSymbol(),symbolString:this.getSymbolString(),interval:this.interval(),style:a.style.value(),styleInputs:this.getInputsProperties().state(),sessionId:o,sessionDescription:r,dividendsAdjustment:a.dividendsAdjustment.value(),backAdjustment:a.backAdjustment.value()&&!this.isBackAdjustmentForbiddenProperty().value(),settlementAsClose:a.settlementAsClose.value()&&!this.isSettlementAsCloseForbiddenProperty().value(),boxSize:this.data().boxSize,reversalAmount:this.data().reversalAmount,isSpread:this.isSpread(),formatter:s},d=ke(this);return d&&(l.dangerReason=d),l}styleStudyInfos(){return{haStyle:this._haStyle,renkoStyle:this._renkoStyle,pbStyle:this._pbStyle,kagiStyle:this._kagiStyle,pnfStyle:this._pnfStyle,rangeStyle:this._rangeStyle,volFootprintStyle:this._volFootprintStyle,tpoStyle:this._tpoStyle,svpStyle:this._svpStyle}}dataEvents(){return this._seriesSource.dataEvents()}isSpread(){var e;return"spread"===(null===(e=this.symbolInfo())||void 0===e?void 0:e.type)}isYield(){const e=this.symbolInfo();return null!==e&&(0,Hs.isYield)(e)}dividendsAdjustmentProperty(){return this._properties.childs().dividendsAdjustment}sessionIdProxyProperty(){return this._sessionIdProxyProperty}symbolTextSourceProxyProperty(){return this._symbolTextSourceProxyProperty}
setTextSourceIsAlwaysTickerRestrictionEnabled(e){this._textSourceIsAlwaysTickerRestrictionEnabled=e,this._recalcSymbolTextSourceProxyProperty()}isDWMProperty(){return this._isDWMProperty}isPrePostMarketPricesAvailableProperty(){return this._isPrePostMarketPricesAvailableProperty}isSettlementAsCloseForbiddenProperty(){return this._isSettlementAsCloseForbiddenProperty}isBackAdjustmentForbiddenProperty(){return this._isBackAdjustmentForbiddenProperty}getStyleShortName(){const e=this.style(),t=b.STYLE_SHORT_NAMES[e];return(0,o.assert)(!!t,`Missed short name for style ${e}`),t}invalidateBarColorerCache(){this._barColorerCache=null,this.invalidateBarStylesCache()}replayExitedDueUnsupportedInterval(){return this._replayExitedDueUnsupportedInterval}replayExitedDueUnsupportedSymbol(){return this._replayExitedDueUnsupportedSymbol}replayExitedDueUnavailableForUserInterval(){return this._replayExitedDueUnavailableForUserInterval}onTimeFrameApplied(){return this._onTimeFrameApplied}onInReplayStateChanged(){return this._onInReplayStateChanged}dataWindowView(){return this._dataWindowView}statusView(){return Zs?this._statusView:null}legendView(){return this._legendView}marketStatusModel(){return this._marketStatusModel}isMainSeries(){return!0}dataUpdatedModeModel(){return this._dataUpdatedModeModel}dataProblemModel(){return this._dataProblemModel}setDefaultTimeframe(e){this._pendingTimeRange=e}loadDataTo(e){const t=this._properties.childs().interval.value();this._onTimeFrameApplied.fire(e),this._seriesSource.modifySeries(this._getResolvingSymbolObject(),(0,ns.getServerInterval)(t),e)}isInReplay(){return this._isInReplay}quotes(){return this.data().isEmpty()?null:this._quotesProvider.quotes()}base(){return this._base}pointValue(){return this._pointValue}barCloseTime(){return this._lastBarCloseTime}priceSource(){let e=null;const t=this._properties.childs();switch(t.style.value()){case 2:e=t.lineStyle.childs().priceSource.value();break;case 18:e=t.tpoStyle.childs().priceSource.value();break;case 14:e=t.lineWithMarkersStyle.childs().priceSource.value();break;case 15:e=t.steplineStyle.childs().priceSource.value();break;case 3:e=t.areaStyle.childs().priceSource.value();break;case 10:e=t.baselineStyle.childs().priceSource.value();break;case 13:e=t.columnStyle.childs().priceSource.value()}return e}updateAllViews(e){var t,s,i,r,o,n,a,l,d,u,h;null===(t=this._paneView)||void 0===t||t.update(e),this._dataWindowView.update(),this._legendView.update(),this._statusView.update(),this._averagePaneViews.forEach((t=>t.update(e))),this._highLowAvgPaneViews.forEach((t=>t.update(e))),this._labelPaneViews.forEach((t=>t.update(e))),this._priceAxisViews.forEach((t=>t.update(e))),this._priceLineAxisViews.forEach((t=>t.update(e))),null===(s=this._futureBarsPaneView)||void 0===s||s.update(e),null===(i=this._projectionBarsPaneView)||void 0===i||i.update(e),null===(r=this._waterlineView)||void 0===r||r.update(e),null===(o=this._prevClosePriceLineView)||void 0===o||o.update(e),null===(n=this._priceLineView)||void 0===n||n.update(e),
null===(a=this._gotoDateView)||void 0===a||a.update(e),null===(l=this._endOfDataPaneView)||void 0===l||l.update(e),null===(d=this._baseHorizontalLineView)||void 0===d||d.update(e);const c=this._model.activeStrategySource().value();null==c||c.updateAllViews(e),null===(u=this._model.replayStudyStrategy().value())||void 0===u||u.updateAllViews(e),this._lineStyleLastPriceCirclePaneView.update(e),null===(h=this._studyBindings)||void 0===h||h.updateAllViews(e)}styleStudyInfo(e){return this.styleStudyInfos()[e]}barFunction(){return this._barFunction}precomputedBarStyle(e){return this._precomputedBarStyles.get(e)}setPrecomputedBarStyle(e,t){this._precomputedBarStyles.set(e,t)}symbolParams(){return(0,zt.symbolParams)(this)}compareSymbolParams(e){return(0,zt.compareSymbolParams)(this,e,this._model.unitConversionEnabled())}setSymbolParams(e){const{symbol:t,currency:s,unit:i,style:r,interval:n}=e,{symbolChanged:a,intervalChanged:l,currencyChanged:d,unitChanged:u,styleChanged:h}=this.compareSymbolParams(e),c=[ni("symbol",t,a),ni("interval",n,l),ni("currency",s,d),ni("unit",i,u),ni("style",r,h)].filter((e=>null!==e)).join("; ");ii.logInfo(`Applying series symbol params: ${c}`);const _=this.properties().childs();void 0!==t&&_.symbol.setValue(t),void 0!==s&&_.currencyId.setValue(s),void 0!==i&&_.unitId.setValue(i),l&&_.interval.setValue((0,o.ensureDefined)(n)),void 0!==r&&h&&_.style.setValue(r);let p=!1;h&&(p=this.isNeedRestart(),this.onChartStyleChanged()),!p&&(a||l||d||u)&&this._applySymbolParamsChanges({symbolChanged:a,currencyChanged:d,unitChanged:u,intervalChanged:l,styleChanged:h}),(a||d||u)&&this.model().checkLineToolSelection()}setSymbol(e){this.setSymbolParams({symbol:e})}currency(){return this.properties().childs().currencyId.value()||null}setCurrency(e){this.setSymbolParams({currency:e})}isConvertedToOtherCurrency(){return(0,v.isConvertedToOtherCurrency)(this.symbolInfo())}unit(){return this.properties().childs().unitId.value()||null}setUnit(e){this.setSymbolParams({unit:e})}measureUnitId(){return(0,v.measureUnitId)(this.symbolInfo())}isConvertedToOtherUnit(){return(0,v.isConvertedToOtherUnit)(this.symbolInfo(),this._model.unitConversionEnabled())}valueAt(e,t){var s,i;return null!==(i=null===(s=this.data().search(e))||void 0===s?void 0:s.value[t])&&void 0!==i?i:null}symbolSource(){return this}barsProvider(){return this}title(e){return this.symbolTitle(e)}name(){return this.symbolTitle(js.TitleDisplayTarget.StatusLine)}symbolTitle(e,t,s,i="exchange"){let r=this.properties().childs().symbol.value();const o=this.symbolInfo();if(null!==o){const{type:e}=o;r=(0,v.symbolTitle)(o,t,"forex"===e?"exchange":i)}return s?r:`${r}, ${(0,O.translatedIntervalString)(this.properties().childs().interval.value())}`}setObsoleteZOrder(e){this._obsoleteZOrder=e}obsoleteZOrder(){return this._obsoleteZOrder}legendValuesProvider(){var e,t;return null!==(t=null===(e=this._studyBindings)||void 0===e?void 0:e.legendValuesProvider())&&void 0!==t?t:this._legendValuesProvider}dataWindowValuesProvider(){var e,t
;return null!==(t=null===(e=this._studyBindings)||void 0===e?void 0:e.dataWindowValuesProvider())&&void 0!==t?t:this._dataWindowValuesProvider}statusProvider(e){return new V(this,this.properties().childs().statusViewStyle,e)}moveItem(e,t,s){if(10===this.style()&&0===t){const t=this.priceScale(),s=this.properties().childs().baselineStyle,i=t.height(),r=100-e.y/i*100,o=r<0?0:Math.round(10*r)/10;s.childs().baseLevelPercentage.setValue(Math.max(Math.min(o,100),0))}}rerequestData(){this._applySymbolParamsChanges({force:!0})}switchToReplay(e,t){this._replaySubscriber.setValue(e),this._isReplayResolutionAvailableForUser=t,this._onInReplayStateChanged.fire(),e.modifySeries(this.getSymbolString(),this._properties.childs().interval.value()),this.rerequestData()}switchToRealtime(){this.isInReplay().value()&&(this._removeReplaySubscriber(),this.rerequestData())}async canChangeResolution(e){{if(!this.isInReplay().value())return!0;const t=await(0,o.ensureNotNull)(this._replaySubscriber.value()).canChangeSymbolParams(this.getSymbolString(),e);return t||this._replayExitedDueUnsupportedInterval.fire(),t}}async canChangeSymbol(e){{if(!this.isInReplay().value())return!0;const t=this._getExtendedSymbolObject(e);delete t["currency-id"],delete t["unit-id"];const s=(0,Yt.encodeExtendedSymbolOrGetSimpleSymbolString)(t),i=await(0,o.ensureNotNull)(this._replaySubscriber.value()).canChangeSymbolParams(s,this.interval());return i||this._replayExitedDueUnsupportedSymbol.fire(),i}}requestMoreDataAvailable(){return this._requestMoreDataAvailable}seriesLoaded(){return this._seriesLoaded}endOfData(){var e;return void 0!==(null===(e=this._lastCompleteFlags)||void 0===e?void 0:e.data_completed)}endOfDataType(){var e,t;return null!==(t=null===(e=this._lastCompleteFlags)||void 0===e?void 0:e.data_completed)&&void 0!==t?t:null}dataPoweredBy(){return this._dataPoweredBy}boxSizeValue(){return this._boxSizeValue}isUserDeletable(){return!1}changeTimeFrame(){(0,a.trackEvent)("GUI","Change timeframe")}onTagsChanged(){return this._tagsChanged}state(e){var t,s;const i=this.obsoleteZOrder();let r={type:"MainSeries",id:this.id(),zorder:i,haStyle:this._haStyle,renkoStyle:this._renkoStyle,pbStyle:this._pbStyle,kagiStyle:this._kagiStyle,pnfStyle:this._pnfStyle,rangeStyle:this._rangeStyle,volFootprintStyle:this._volFootprintStyle,tpoStyle:this._tpoStyle,svpStyle:this._svpStyle,formattingDeps:this._formattingDeps,studyBindings:null===(t=this._studyBindings)||void 0===t?void 0:t.state(!!e)};const o=this.properties().state();if(o.symbol=(0,v.symbolToSaveInState)(null!==(s=this.symbolInfo())&&void 0!==s?s:this._model.chartApi().lastSymbolResolveInfo(o.symbol),o.symbol),this._model.unitConversionEnabled()||(o.unitId=null),r.state=o,e){let e=this.bars();const t=this._model.timeScale().visibleExtendedDataRange(e,0);null!==t&&(e=e.range(t.firstBar(),t.lastBar())),r={...r,bars:ai(e),nsBars:ai(this.nsBars()),symbolInfo:this.symbolInfo(),rtPrice:this.data().lastProjectionPrice,boxSize:this.data().boxSize,reversalAmount:this.data().reversalAmount}}return r}restoreState(e,t){
var s,i,r;t&&this._setStatus(5),!this._model.unitConversionEnabled()&&e.state&&delete e.state.unitId,e.state&&$.Interval.isRange(e.state.interval)&&(e.state.style=11);const o=e.state;if(void 0!==o){const e=o.style,t=qe.chartStylePermissions.get(e);t&&!this._model.isSnapshot()&&(o.style=2,(0,je.runOrGoProWithoutSync)((()=>{o.style=e}),t.feature,{feature:t.featureName}))}if(this._properties.mergeAndFire(e.state),this._properties.hasChild("esdBreaksStyle")&&this._properties.removeProperty("esdBreaksStyle"),this._prevChartStyle=this.properties().childs().style.value(),this.createPaneView(),t){const t=e;this.restoreData(t.bars,t.nsBars,t.symbolInfo,t.rtPrice,t.boxSize,t.reversalAmount)}e.formattingDeps&&(this._formattingDeps=e.formattingDeps,this._recreatePriceFormattingDependencies()),null===(s=this._studyBindings)||void 0===s||s.restoreState(null!==(i=e.studyBindings)&&void 0!==i?i:{},t),null===(r=this._studyBindings)||void 0===r||r.syncStudy(this.style())}restoreData(e,t,s,i,r,o){this._updateStatus({seriesStatus:5}),this._data=new _.SeriesData,this._data.bars().restoreState(e),this._data.nsBars().restoreState(t),this._updateSymbolInfo(s),this._data.lastProjectionPrice=i,this._data.boxSize=r;const n=this.properties().childs();r||(6===n.style.value()?this._data.boxSize=n.pnfStyle.childs().inputs.childs().boxSize.value():4===n.style.value()&&(this._data.boxSize=n.renkoStyle.childs().inputs.childs().boxSize.value())),this._data.reversalAmount=o,o||5===n.style.value()&&(this._data.reversalAmount=n.kagiStyle.childs().inputs.childs().reversalAmount.value())}async setGotoDateResult(e,t){this._gotoDateResultCleared=!1;const i=await Promise.all([s.e(36778),s.e(4079)]).then(s.bind(s,739281));this._gotoDateResultCleared||(this._gotoDateView=new i.GotoDateView(this,e,t),this._gotoDateView.doNotShowLastAvailableBar(this._doNotShowLastAvailableBar),this._model.updateSource(this))}clearGotoDateResult(){this._gotoDateView=null,this._gotoDateResultCleared=!0}doNotShowLastAvailableBar(e){var t;this._doNotShowLastAvailableBar=e,null===(t=this._gotoDateView)||void 0===t||t.doNotShowLastAvailableBar(e)}dataUpdated(){return this.dataEvents().dataUpdated()}moveData(e){var t;this._seriesSource.moveData(e),null!==this._volumePointWeights&&this._volumePointWeights.moveData(e),null===(t=this._studyBindings)||void 0===t||t.moveData(e)}async seriesCreated(){const e=this._seriesSource.instanceId();if(null!==e)return e;const t=await Promise.race([this._deferredDestroyed.promise.then((()=>{})),this._model.isSnapshot()?Promise.resolve(null):new Promise((e=>{this.dataEvents().created().subscribe(this,e,!0)}))]);if(void 0===t)throw new Error("Series has been destroyed");return t}_updateBarFunction(){this._barFunction=(0,Ws.barFunctionByStyle)(this.style(),this.priceSource())}_setProperties(e){e.hasChild("timeframe")||e.merge({timeframe:""}),e.hasChild("shortName")||e.merge({shortName:""}),e.hasChild("currencyId")||e.addChild("currencyId",new y.Property(null)),e.hasChild("unitId")||e.addChild("unitId",new y.Property(null)),this._properties=e
;const t=e.childs();t.currencyId.subscribe(this,this._onCurrencyChanged),t.unitId.subscribe(this,this._onUnitChanged),t.timeframe.subscribe(this,this.changeTimeFrame),e.subscribe(this,this._onPropertiesChanged)}_updateSessionIdProxyProperty(e){const t=this._properties.childs().sessionId.value();let s=t;if(e){const e=this.symbolInfo();null!==e&&(s=e.subsession_id||t)}this._ignoreSessionIdProxyPropertyChanges=!0,this._sessionIdProxyProperty.setValue(s),this._ignoreSessionIdProxyPropertyChanges=!1}_onSessionIdProxyPropertyChanged(){this._ignoreSessionIdProxyPropertyChanges||this._properties.childs().sessionId.setValue(this._sessionIdProxyProperty.value()),this._updateLastPriceAnimationActive()}_onSymbolResolved(e){this._seriesErrorMessage=null,this._updateSymbolInfo(e),this._model.updateSource(this),this._model.onWidget()||((0,a.trackEvent)("Symbol",e.listed_exchange,e.name),(0,a.trackEvent)("Symbol Type",e.type,e.listed_exchange));const t=e.minmov/e.pricescale,s=this.properties().childs();4===s.style.value()&&s.renkoStyle.childs().inputs.childs().boxSize.value()<t?s.renkoStyle.childs().inputs.merge({boxSize:t}):6===s.style.value()&&s.pnfStyle.childs().inputs.childs().boxSize.value()<t?s.pnfStyle.childs().inputs.merge({boxSize:t}):5===s.style.value()&&s.kagiStyle.childs().inputs.childs().reversalAmount.value()<t&&s.kagiStyle.childs().inputs.merge({reversalAmount:t}),this._checkChartStyle(),this._formattingDeps={format:e.format,pricescale:e.pricescale,minmov:e.minmov,fractional:e.fractional,minmove2:e.minmove2,variable_tick_size:e.variable_tick_size}}_onSymbolError(e){this._setStatus(4),this._properties.childs().shortName.setValue(this._properties.childs().symbol.value()),this._model.clearAllStudies(),this.updateAllViews((0,xe.sourceChangeEvent)(this.id())),this._model.updateSource(this),e!==os.permissionDenied&&this._model.resetTimeScale(),this._sendTelemetryCounter("symbol_error",this._getTelemetryAdditionalData(e,!1)),this._symbolResolvingActive.setValue(!1)}_sendTelemetryCounter(e,t){void 0===t&&(t=this._getTelemetryAdditionalData());const s=Object.assign({count:1},{additional:t});Be.telemetry.sendChartReport(e,s)}_getTelemetryAdditionalData(e,t){t=void 0===t||t;const s={symbol:this.actualSymbol()};return t&&(s.resolution=this.interval()),void 0!==e&&(s.reason=e),s}_onSeriesTimeFrame(e,t,s,i,r){const o=(0,v.isSingleValueBasedStyle)(this.style())?e+.5:e;let n=t;if(void 0===r)null!==s&&"period-back"!==s.type||(n+=this._model.studyAwareDefaultRightOffset());else if(r.applyDefaultRightMargin)n+=this._model.studyAwareDefaultRightOffset();else if(r.percentRightMargin){const e=t-o+1,s=Math.max(0,Math.min(.99,r.percentRightMargin/100));n+=s*e/(1-s)}this._model.setTimeViewport(o,n)}_onSeriesError(e){let t=e.error;const s=e.ctx;if(s){const e={};Object.keys(s).forEach((t=>{e[t]=s[t].toString()})),t=t.format(e)}ti&&ii.logNormal("Error reason: "+t),this._seriesErrorMessage=t;const i=ei&&this.symbolInfo()?10:4;this._setStatus(i),this._seriesLoaded=!0,this._sendTelemetryCounter("series_error",this._getTelemetryAdditionalData(t)),
this._enablePriceRangeReady()}_onSeriesLoading(e){this._setStatus(2)}_onDataUpdated(e,t,s,i){var r;const n=this.symbolInfo();if(i&&n){let e=0,t=0;if((0,v.hasVolume)(n))for(const s of this.bars().fullRangeIterator()){const i=s.value[5];0!==i&&(e+=i,t+=1)}this._volumePointWeights=t>0?new pt(e/t):null,this._updateTimeScaleTimePointWeights()}if(null!==this._volumePointWeights){const e=t?this.bars().fullRangeIterator():s?this.bars().rangeIterator(s.index,(0,o.ensureNotNull)(this.bars().lastIndex())):null;if(null!==e)for(const t of e)this._volumePointWeights.setVolume(t.index,t.value[5])}t?this._requestMoreDataAvailable=!0:this._lastPriceAnimationActive&&this._seriesLoaded&&this._lineStyleLastPriceCirclePaneView.update((0,xe.sourceChangeEvent)(this.id())),this._lastBarCloseTime=e&&e.closeTime||null,this._boxSizeValue.setValue(this.data().boxSize),this._statusView.update(),this.clearAveragePriceCache(),this.clearHighLowPriceCache();const a=this.model(),l=(0,o.ensureNotNull)(a.paneForSource(this));a.recalculatePane(l,(0,xe.sourceChangeEvent)({sourceId:this.id(),realtime:!t,firstUpdatedTimePointIndex:null!==(r=null==s?void 0:s.index)&&void 0!==r?r:void 0})),a.updateSource(this)}_setStatus(e){const t={...this._status.value(),seriesStatus:e};this._updateStatus(t),this._statusView.update(),this.model().updateSource(this),this._onStatusChanged.fire()}_onBarReceived(e){this.model().recalcVisibleRangeStudies(c.RecalcVisibleRangeStudiesReason.DataUpdate)}_onUnsupportedResolutionRequested(){const e=(0,o.ensureNotNull)(this._getStateForUnsupportedResolution());this._seriesErrorMessage=e.reason,this._unsupportedResolutionState.setValue(e),this._setStatus(14),this._seriesLoaded=!0,this._seriesSource.clearData(),this._model.timeScale().points().clear(),this._enablePriceRangeReady()}_getStateForUnsupportedResolution(){const e=this.symbolInfo();if(null===e)return null;const t=this.interval(),s=(0,x.getResolutionUnsupportedReason)(e,t);if(null===s)return null;const i=e.name;if("less_than_frequency"!==s)return{ticker:i,reason:s,unsupportedResolution:t,applicableResolution:"D"};{const r=(0,o.ensureDefined)(e.data_frequency);let n=(0,ns.getApplicableIntervalForFrequency)(r,t);const a=this._model.defaultResolutions();if(!(a.includes(n)||window.is_authenticated&&window.user.is_pro)){const e=a.find((e=>(0,ns.compareResolutions)(e,n)>=0));n=null!=e?e:a[a.length-1]}return{ticker:i,reason:s,applicableResolution:n,unsupportedResolution:t}}}_recreateFormatter(){var e,t,s;this._defaultFormatter=(0,v.createSeriesFormatter)(null!==(e=this.symbolInfo())&&void 0!==e?e:this._formattingDeps,"default"),this._formatter=(0,v.createSeriesFormatter)(null!==(t=this.symbolInfo())&&void 0!==t?t:this._formattingDeps,this.properties().childs().minTick.value()),this._ignoreMinMoveFormatter=(0,v.createSeriesFormatter)(this.symbolInfo(),this.properties().childs().minTick.value(),!0),null===(s=this._priceScale)||void 0===s||s.updateFormatter(),this._formatterChanged.fire()}_recreatePriceStep(){const{minMove:e,priceScale:t}=(0,
v.getSeriesPriceFormattingState)(this.symbolInfo()),s=e/t;this._ignoreMinMovePriceStep=1/t,this._priceStep!==s&&(this._priceStep=s,this._priceStepChanged.fire())}_recreatePriceFormattingDependencies(){this._recreateFormatter(),this._recreatePriceStep()}_onQuotesUpdate(e,t){if(Qs){const e=void 0!==t.values.change||void 0!==t.values.change_percent;e&&this._legendView.update();const s=void 0!==t.values.prev_close_price;s&&((0,o.ensureNotNull)(this._prevClosePriceLineView).update((0,xe.sourceChangeEvent)(this.id())),(0,o.ensureNotNull)(this._prevClosePriceAxisView).update((0,xe.sourceChangeEvent)(this.id()))),(e||s)&&this.model().updateSource(this)}void 0!==e.values.current_session&&e.values.current_session!==this._currentSession&&(this._currentSession=e.values.current_session,this._updateLastPriceAnimationActive())}_updateIsPrePostMarketPricesForbiddenProperty(){const e=(0,v.symbolHasPreOrPostMarket)(this.symbolInfo())&&(this.isDWM()||(0,v.isRegularSessionId)(this.sessionIdProxyProperty().value()));this._isPrePostMarketPricesAvailableProperty.setValue(e)}_updateSettlementAsCloseForbiddenProperty(){var e;const t=this.isDWM()&&Boolean(null===(e=this.symbolInfo())||void 0===e?void 0:e.has_settlement);this._isSettlementAsCloseForbiddenProperty.setValue(!t)}_updateBackAdjustmentForbiddenProperty(){var e;const t=Boolean(null===(e=this.symbolInfo())||void 0===e?void 0:e.has_backadjustment);this._isBackAdjustmentForbiddenProperty.setValue(!t)}_removeReplaySubscriber(){{if(!this.isInReplay().value())return;const e=this._replaySubscriber.value();this._replaySubscriber.setValue(null),this._isReplayResolutionAvailableForUser=null,this._onInReplayStateChanged.fire(),null==e||e.destroy()}}_getSymbolForApi(){return this.symbol()}_getSymbolObject(e){const t=this._getExtendedSymbolObject(e),s=this.properties().childs().style.value();if(b.SYMBOL_STRING_DATA.hasOwnProperty(s)&&!b.chartStylesWithAttachedStudies.includes(s)){return{symbol:t,type:this.styleStudyInfo(this.getStyleShortName()+"Style").studyId+"!",inputs:this.getInputsProperties().state()}}return t}_getExtendedSymbolObject(e){const t={symbol:null!=e?e:this._getSymbolForApi()},s=this.properties().childs();null!==this.currency()&&(t["currency-id"]=this.currency());const i=this.unit();return this._model.unitConversionEnabled()&&null!==i&&(t["unit-id"]=i),this.isDWM()||(t.session=s.sessionId.value()),t.adjustment=s.dividendsAdjustment.value()?"dividends":"splits",s.backAdjustment.value()&&(t.backadjustment="default"),s.settlementAsClose.value()||(t["settlement-as-close"]=!1),t}_checkChartStyle(){const e=this.style();(0,v.isCloseBasedSymbol)(this.symbolInfo())||this.intervalObj().is1Tick()?(0,v.isSingleValueBasedStyle)(e)||(this.requestingStyleIsNotSupported.fire(),this._styleToRecover={correctedStyle:this.style(),originalStyle:e}):null!==this._styleToRecover&&(this.requestingStyleSupportRecovered.fire(this._styleToRecover.originalStyle),this._styleToRecover=null)}_updateSymbolInfo(e){if(this._symbolInfo.setValue(e),e){const t=this._properties.childs();t.shortName.setValue(e.name)
;const s=(0,v.extractSymbolNameFromSymbolInfo)(e,this.symbol());s&&t.symbol.setValue(s);const i=(0,v.symbolCurrency)(e),r=(0,v.symbolUnit)(e,this._model.unitConversionEnabled());"alwaysOff"===(0,Y.currencyUnitVisibilityProperty)().value()||i===t.currencyId.value()&&r===t.unitId.value()||this._model.fullUpdate(),t.currencyId.setValue(i),t.unitId.setValue(r),this._updateSessionIdProxyProperty(!0)}this._base=e?e.pricescale/e.minmov:100,this._pointValue=e&&e.pointvalue||1;const t=(0,Yt.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getExtendedSymbolObject());this._quotesProvider.setQuotesSessionSymbol(t),this._marketStatusModel.setSymbolInfo(e),e&&this._recreatePriceFormattingDependencies(),this._statusView.update(),this.priceScale().updateFormatter(),this._symbolResolvingActive.setValue(!e),this._updateIsPrePostMarketPricesForbiddenProperty(),this._dataPoweredBy=(0,De.getDataVendorString)(e),this._updateBackAdjustmentForbiddenProperty(),this._updateSettlementAsCloseForbiddenProperty()}_createHighLowAvgViews(){const e=this.properties().childs().highLowAvgPrice,t=this._getHighLowPrice.bind(this),s=function(e,t,s,i){const r=s.childs(),o=Ht(e,t,{label:Ft,labelVisible:r.highLowPriceLabelsVisible,lineVisible:r.highLowPriceLinesVisible,lineColor:r.highLowPriceLinesColor,lineWidth:r.highLowPriceLinesWidth},(()=>i(0))),n=Ht(e,t,{label:Ut,labelVisible:r.highLowPriceLabelsVisible,lineVisible:r.highLowPriceLinesVisible,lineColor:r.highLowPriceLinesColor,lineWidth:r.highLowPriceLinesWidth},(()=>i(1)));return{paneViews:[o.paneView,n.paneView],panePriceAxisViews:[o.panePriceAxisView,n.panePriceAxisView],priceAxisViews:[o.priceAxisView,n.priceAxisView],priceLineAxisViews:[o.priceLineAxisView,n.priceLineAxisView]}}(this._model,this,e,t);this._highLowAvgPaneViews.push(...s.paneViews),this._labelPaneViews.push(...s.panePriceAxisViews),this._priceAxisViews.push(...s.priceAxisViews),this._priceLineAxisViews.push(...s.priceLineAxisViews)}_createAverageViews(){}_getHighLowPrice(e){if(!this._highLowPriceCache.has(e)){const e=this._model.timeScale().visibleBarsStrictRange();if(null===e)return null;const t=function(e,t,s){return e.minMaxOnRangeCached(t,s,[{name:"low",offset:0},{name:"high",offset:0}])}(this._model.mainSeries().bars(),e.firstBar(),e.lastBar());if(null===t)return null;this._highLowPriceCache.set(1,t.min),this._highLowPriceCache.set(0,t.max)}return this._highLowPriceCache.get(e)}_getAveragePrice(e){return null}_onSeriesCompleted(e){var t;if(14===this._status.value().seriesStatus)return;this._sendTelemetryCounter("series_loaded",this._getTelemetryAdditionalData()),this._seriesErrorMessage=null;let i=e.updateMode;switch("pulsed"===i&&(i="delayed"),i){case"streaming":this._setStatus(3);break;case"endofday":this._setStatus(6);break;case"delayed":this._setStatus(8);break;case"replay":this._setStatus(11)}i.match(/delayed_streaming/)&&this._setStatus(9),this._lastCompleteFlags=null!==(t=e.flags)&&void 0!==t?t:null;const r=(0,o.ensureNotNull)(this._model.paneForSource(this));r.recalculatePriceScale(this.priceScale(),(0,
xe.sourceChangeEvent)(this.id()));const n=ss.InvalidationMask.full();if(null!==this._model.appliedTimeFrame().value()&&n.lockVisibleTimeRangeOnResize(),this._model.invalidate(n),!this.priceScale().isLockScale()||this.model().timeScale().isEmpty()||this._seriesLoaded||(this.model().timeScale().correctOffset(),this.model().timeScale().correctBarSpacing(),this.model().resetPriceScale(r,this.priceScale())),this._seriesLoaded=!0,this._seriesCompleted=!0,this.model().recalcVisibleRangeStudies(c.RecalcVisibleRangeStudiesReason.SeriesCompleted),this.model().recalcStudyBasedLineTools(),!ri){ri=!0;(0,s(975420).trackTiming)("Chart","Time to series",window.performance.now())}this.requestMoreData(),this._enablePriceRangeReady()}_notifyIntervalChanged(e){var t,s;const i={timeframe:null!==(t=this._pendingTimeRange)&&void 0!==t?t:void 0};this._intervalChanged.fire(e,i),this._pendingTimeRange=null!==(s=i.timeframe)&&void 0!==s?s:null}_onCurrencyChanged(){this._currencyChanged.fire()}_onUnitChanged(){this._unitChanged.fire()}async _applySymbolParamsChanges(e){this._lastCompleteFlags=null,this.clearGotoDateResult();const t=this.interval(),s=this.currency(),i=this.unit(),r=$.Interval.isRange(t);r&&this._properties.childs().rangeStyle.childs().inputs.childs().range.setValue($.Interval.parse(t).multiplier());const{symbolChanged:n,intervalChanged:a,currencyChanged:l,unitChanged:d,force:u}=e,h=a&&$.Interval.parse(t).isDWM()!=$.Interval.parse(t).isDWM();if((null!==s&&l||null!==i&&d)&&this.isInReplay().value()){const e=this.symbolInfo();(null===e||null!==s&&e.original_currency_id!==s||null!==i&&e.original_unit_id!==i)&&this._removeReplaySubscriber()}if(this._syncModel=null,this._prevRequestedInterval=t,5!==this._status.value().seriesStatus&&(!this._seriesSource.isStarted()||n||l||d||h)&&this._updateSymbolInfo(null),this.isInReplay().value()){const e=()=>this._removeReplaySubscriber();a&&(r||$.Interval.isTicks(t)?e():(0,o.ensureNotNull)(this._isReplayResolutionAvailableForUser)(t)?await this.canChangeResolution(t)||(e(),this._replayExitedDueUnsupportedInterval.fire()):(e(),this._replayExitedDueUnavailableForUserInterval.fire()))}if(5===this._status.value().seriesStatus)return void this._model.realignLineTools();this._setStatus(1),this._updateIsPrePostMarketPricesForbiddenProperty(),this._updateBackAdjustmentForbiddenProperty(),this._updateSettlementAsCloseForbiddenProperty(),this._symbolIntervalChanged.fire(),a&&this._notifyIntervalChanged(t),this._onRestarted.fire(),this._seriesLoaded=!1,this._seriesCompleted=!1,this._lineStyleLastPriceCirclePaneView.stopAnimation();let _=null;this._pendingTimeRange&&(_=this._pendingTimeRange,this._pendingTimeRange=null),this._onTimeFrameApplied.fire(_),this._onBeforeModifySeries(this.getSymbolString(),t);const p=this._shouldDefineNumberOfBarsForModifySeries(e)&&this._visibleBarsCount()||null;this.model().recalcVisibleRangeStudies(c.RecalcVisibleRangeStudiesReason.SeriesRestart),this._data=null,this._seriesSource.modifySeries(this._getResolvingSymbolObject(),(0,ns.getServerInterval)(t),_,u,p),
this._seriesSource.isStarted()||(this._predictBars=0,this._seriesSource.start()),(n||l||d)&&this.disablePriceRangeReady(),this.updateAllViews((0,xe.sourceChangeEvent)(this.id())),this._model.lightUpdate()}_onBeforeModifySeries(e,t){const s=this._replaySubscriber.value();null==s||s.modifySeries(e,t)}_getResolvingSymbolObject(){let e=this._getSymbolObject(this._symbolForResolve());const t=this._replaySubscriber.value();return t&&(e=t.generateReplaySymbol(e)),e}_onSessionIdPropertyChanged(){this._sessionIdChanged.fire(),this.isDWM()||(this.restart(),this._updateLastPriceAnimationActive())}_subscribeRestartToSessionIdChange(){this.properties().childs().sessionId.subscribe(this,this._onSessionIdPropertyChangedBound)}_unsubscribeRestartToSessionIdChange(){this.properties().childs().sessionId.unsubscribe(this,this._onSessionIdPropertyChangedBound)}_updateLastPriceAnimationActive(){if(!this._options.lastPriceAnimationEnabled||P.enabled("disable_pulse_animation"))return;const e=this._lastPriceAnimationActive,t=this.properties().childs(),s=t.style.value(),i=3===s||10===s||2===s||14===s||15===s;if(!this._model.isSnapshot()&&t.visible.value()&&i){const e=this.currentSession(),t=!(0,v.isRegularSessionId)(this.sessionIdProxyProperty().value())&&!this.isDWM();this._lastPriceAnimationActive="market"===e||t&&("pre_market"===e||"post_market"===e)}else this._lastPriceAnimationActive=!1;this._lastPriceAnimationActive&&e!==this._lastPriceAnimationActive&&this.model().invalidate(ss.InvalidationMask.cursor())}_onPropertiesChanged(e){const t=this._properties.childs();e!==t.symbol&&e!==t.interval&&e!==t.timeframe&&(this._tagsChanged.fire(),this.createPaneView(),this.updateAllViews((0,xe.sourceChangeEvent)(this._id)),this.model().updateSource(this),(0,l.emit)("series_properties_changed",this._id))}_recalcSymbolTextSourceProxyProperty(){this._textSourceIsAlwaysTickerRestrictionEnabled?this._symbolTextSourceProxyProperty.setValue("ticker"):this._symbolTextSourceProxyProperty.setValue(this._properties.childs().statusViewStyle.childs().symbolTextSource.value())}_clearStylePlot(e,t){if(0===e.size())return;if(void 0===t&&e!==this.nsBars())return void(this._precomputedBarStyles=new WeakMap);const s=null!=t?t:(0,o.ensureNotNull)(e.firstIndex()),i=(0,o.ensureNotNull)(e.lastIndex())+1;e.range(s,i).each(((e,t)=>(this._precomputedBarStyles.delete(t),!1)))}_visibleBarsCount(){const e=this._model.timeScale().visibleBarsStrictRange();return null==e?void 0:e.count()}_symbolForResolve(){var e;const t=this.symbol();return this._seriesSource.symbolSameAsResolved(t)&&null!==(e=this._seriesSource.resolvedSymbol())&&void 0!==e?e:t}_shouldDefineNumberOfBarsForModifySeries(e){return!1}_onShowCountdownChanged(e){e.value()?this._countdownUpdateTimer=this._model.setInterval((()=>{var e,t;return null===(t=(e=this._priceAxisView).updateCountdown)||void 0===t?void 0:t.call(e)}),500):null!==this._countdownUpdateTimer&&(this._model.clearInterval(this._countdownUpdateTimer),this._countdownUpdateTimer=null)}_onFormatterPropsChanged(){this._recreateFormatter(),
this._model.fullUpdate()}_updateStatus(e){14!==e.seriesStatus&&this._unsupportedResolutionState.setValue(null),this._status.setValue(e)}_wasCompletedBefore(){var e,t;return this.isCompleted()&&(null===(t=null===(e=this._studyBindings)||void 0===e?void 0:e.wasCompletedBefore())||void 0===t||t)}}},967805:(e,t,s)=>{"use strict";s.d(t,{chartStylePermissions:()=>i});const i=new Map([[18,{feature:"TPO_PERIODIC",featureName:"TPOChartStyle"}],[17,{feature:"VOLUME_FOOTPRINT",featureName:"volumeFootprint"}],[19,{feature:"VOLUME_CANDLES",featureName:"volumeCandles"}],[20,{feature:"SESSION_VOLUME_PROFILE",featureName:"SVPChartStyle"}]])},468302:(e,t,s)=>{"use strict";s.d(t,{getErrorFromUnsupportedResolutionState:()=>d,getResolutionUnsupportedReason:()=>u});var i=s(444372),r=s(378975),o=s(395394);const n=i.t(null,void 0,s(864818)),a=i.t(null,void 0,s(780254)),l=i.t(null,void 0,s(180185));function d(e,t=!1){const s=t?`<b>${e.ticker}</b>`:e.ticker;switch(e.reason){case"unsupported_intraday":{const e=t?"<b>D, W, M</b>":"D, W, M";return n.format({ticker:s,availableResolutions:e})}case"unsupported_ticks":return a.format({ticker:s});case"less_than_frequency":{const i=t?`<b>${e.applicableResolution}</b>`:e.applicableResolution;return l.format({ticker:s,resolution:i})}}}function u(e,t){if(null===e)return null;const s=e.data_frequency;if(void 0!==s){if((0,o.getApplicableIntervalForFrequency)(s,t)!==t)return"less_than_frequency"}return r.Interval.isIntraday(t)&&!e.has_intraday?"unsupported_intraday":r.Interval.isTicks(t)&&!e["is-tickbars-available"]?"unsupported_ticks":null}},548544:(e,t,s)=>{"use strict";s.d(t,{prepareStudyPropertiesState:()=>u,svpStylePreferencesDefault:()=>d});var i=s(125388),r=s(725356),o=s(497503),n=s(307801);const a={profilesSessions:"All",customSession:"0930-1600",customSessionTZ:"Exchange",volume:n.HHistVolumeMode.UpDown,vaVolume:70,extendPocRight:!1,extendVAHRight:!1,extendVALRight:!1,rowsLayout:"Number Of Rows",rows:24},l=Object.keys(a),d={...r.lineStyleDefault,inputs:a,volumeProfile:{visible:!0,valuesColor:"",showValues:!0,volumeColorUp:"",volumeColorDown:"",valueAreaColorUp:"",valueAreaColorDown:"",histogramBoxColor:"",placement:n.HHistDirection.LeftToRight,percentWidth:100},vah:{visible:!1,color:"",linestyle:o.LineStyle.Dashed,linewidth:2},val:{visible:!1,color:"",linestyle:o.LineStyle.Dashed,linewidth:2},poc:{visible:!1,color:"",linestyle:o.LineStyle.Solid,linewidth:2},developingPoc:{visible:!1,color:"",linestyle:o.LineStyle.Solid,linewidth:1},developingVA:{visible:!1,color:"",linestyle:o.LineStyle.Solid,linewidth:1}};function u(e){return{inputs:(0,i.pickFields)(e.inputs,l),styles:{developingPoc:{color:e.developingPoc.color,display:e.developingPoc.visible?15:0,linestyle:e.developingPoc.linestyle,linewidth:e.developingPoc.linewidth},developingVAHigh:{color:e.developingVA.color,display:e.developingVA.visible?15:0,linestyle:e.developingVA.linestyle,linewidth:e.developingVA.linewidth},developingVALow:{color:e.developingVA.color,display:e.developingVA.visible?15:0,linestyle:e.developingVA.linestyle,
linewidth:e.developingVA.linewidth}},graphics:{hhists:{histBars2:{colors:[e.volumeProfile.volumeColorUp,e.volumeProfile.volumeColorDown],direction:e.volumeProfile.placement,percentWidth:e.volumeProfile.percentWidth,showValues:e.volumeProfile.showValues,valuesColor:e.volumeProfile.valuesColor,visible:e.volumeProfile.visible},histBarsVA:{colors:[e.volumeProfile.valueAreaColorUp,e.volumeProfile.valueAreaColorDown],direction:e.volumeProfile.placement,percentWidth:e.volumeProfile.percentWidth,showValues:e.volumeProfile.showValues,valuesColor:e.volumeProfile.valuesColor,visible:e.volumeProfile.visible}},horizlines:{pocLines:{color:e.poc.color,style:e.poc.linestyle,visible:e.poc.visible,width:e.poc.linewidth},vahLines:{color:e.vah.color,style:e.vah.linestyle,visible:e.vah.visible,width:e.vah.linewidth},valLines:{color:e.val.color,style:e.val.linestyle,visible:e.val.visible,width:e.val.linewidth}},polygons:{histBoxBg:{color:e.volumeProfile.histogramBoxColor}}}}}},394954:(e,t,s)=>{"use strict";s.d(t,{prepareStudyPropertiesState:()=>a,tpoStylePreferencesDefault:()=>n});var i=s(725356),r=s(497503),o=s(307801);const n={...i.lineStyleDefault,styles:{splitByBlocks:!1},inputs:{period:"Day",periodsNum:1,rowSize:"Auto",ticksPerRow:100,vaPercent:70,blockSize:"30m",mergePoints:"",extendPoorHigh:!1,extendPoorLow:!1,extendPOC:!1,extendTpoVah:!1,extendTpoVal:!1,extendVolumePoc:!1,extendVolumeVah:!1,extendVolumeVal:!1,extendSingleprints:!1},tpo:{colors:{gradientColors:["","","",""]},showBlocks:!0,showLetters:!0,nonVaOpacity:30},levels:{showPOC:!0,pocColor:"",showPoorHigh:!1,poorHighColor:"",showPoorLow:!1,poorLowColor:"",showSingleprints:!1,singleprintsColor:"",showVAH:!0,vahColor:"",showVAL:!0,valColor:"",showMidpoint:!0,showOpenPrice:!1,showClosePrice:!1,initialBalanceRange:{levels:2,visible:!0}},volumeProfile:{visible:!0,valuesColor:"",showValues:!0,vah:{visible:!1,color:"",linestyle:r.LineStyle.Dashed,linewidth:2},val:{visible:!1,color:"",linestyle:r.LineStyle.Dashed,linewidth:2},poc:{visible:!1,color:"",linestyle:r.LineStyle.Solid,linewidth:2},volumeColor:"",valueAreaColor:"",placement:o.HHistDirection.LeftToRight}};function a(e){const t={...e.inputs};return"Auto"===t.rowSize&&delete t.ticksPerRow,{inputs:t,styles:{splitByBlocks:e.styles.splitByBlocks},graphics:{tpoBlockSets:{tpo:{colors:e.tpo.colors.gradientColors,showBlocks:e.tpo.showBlocks,showLetters:e.tpo.showLetters,nonVaOpacity:e.tpo.nonVaOpacity}},tpoLevels:{tpo:{tpoPoc:{visible:e.levels.showPOC,color:e.levels.pocColor},tpoMidpoint:{visible:e.levels.showMidpoint},tpoPoorHigh:{visible:e.levels.showPoorHigh,color:e.levels.poorHighColor},tpoPoorLow:{visible:e.levels.showPoorLow,color:e.levels.poorLowColor},tpoSingleprints:{visible:e.levels.showSingleprints,color:e.levels.singleprintsColor},tpoVal:{visible:e.levels.showVAL,color:e.levels.valColor},tpoVah:{visible:e.levels.showVAH,color:e.levels.vahColor},volumePoc:{visible:e.volumeProfile.poc.visible,style:e.volumeProfile.poc.linestyle,color:e.volumeProfile.poc.color,width:e.volumeProfile.poc.linewidth},volumeVah:{
visible:e.volumeProfile.vah.visible,style:e.volumeProfile.vah.linestyle,color:e.volumeProfile.vah.color,width:e.volumeProfile.vah.linewidth},volumeVal:{visible:e.volumeProfile.val.visible,style:e.volumeProfile.val.linestyle,color:e.volumeProfile.val.color,width:e.volumeProfile.val.linewidth}}},tpos:{tpo:{closePrice:{visible:e.levels.showClosePrice},openPrice:{visible:e.levels.showOpenPrice},initialBalanceRange:{...e.levels.initialBalanceRange}}},tpoVolumeRows:{tpo:{visible:e.volumeProfile.visible,valuesColor:e.volumeProfile.valuesColor,showValues:e.volumeProfile.showValues,direction:e.volumeProfile.placement,colors:{nonVa:e.volumeProfile.volumeColor,va:e.volumeProfile.valueAreaColor}}}}}}},79908:(e,t,s)=>{"use strict";s.d(t,{VolumeFootprintBgColorsProperty:()=>V,getBgColorsDefaults:()=>E});var i=s(822914),r=s(852290),o=s(650151),n=s(960095),a=s(331633),l=s(919346),d=s(658843);const u=(0,n.getHexColorByName)("color-cold-gray-200"),h=(0,n.getHexColorByName)("color-black"),c=(0,n.getHexColorByName)("color-tv-blue-200"),_=(0,n.getHexColorByName)("color-tv-blue-400"),p=(0,n.getHexColorByName)("color-tv-blue-600"),S=(0,n.getHexColorByName)("color-tv-blue-800"),m=(0,n.getHexColorByName)("color-tv-blue-a800"),y=(0,n.getHexColorByName)("color-ripe-red-200"),v=(0,n.getHexColorByName)("color-ripe-red-400"),g=(0,n.getHexColorByName)("color-ripe-red-600"),b=(0,n.getHexColorByName)("color-ripe-red-800"),f=(0,n.getHexColorByName)("color-ripe-red-a700"),w=(0,n.getHexColorByName)("color-ripe-red-a900"),P=(0,n.getHexColorByName)("color-minty-green-200"),C=(0,n.getHexColorByName)("color-minty-green-400"),I=(0,n.getHexColorByName)("color-minty-green-600"),T=(0,n.getHexColorByName)("color-minty-green-800"),x=(0,n.getHexColorByName)("color-minty-green-a900"),A=new Map([[l.StdTheme.Light,{adjBuyBgColors:[P,C,I,T],adjSellBgColors:[y,v,g,f],adjTotalBgColors:[c,_,p,S],buyBgColor:C,sellBgColor:v,totalBgColor:_,pocColor:h}],[l.StdTheme.Dark,{adjBuyBgColors:[x,T,I,C],adjSellBgColors:[w,b,g,v],adjTotalBgColors:[m,S,p,_],buyBgColor:T,sellBgColor:b,totalBgColor:S,pocColor:u}]]);function R(e){return e===l.StdTheme.Light?(0,o.ensureDefined)(A.get(l.StdTheme.Light)):(0,o.ensureDefined)(A.get(l.StdTheme.Dark))}function E(){return(0,i.default)(R(a.watchedTheme.value()))}class V extends d.Property{constructor(e){super((0,r.default)(E(),e)),this._onThemeChanged=e=>{let t=l.StdTheme.Dark,s=l.StdTheme.Light;e!==l.StdTheme.Dark&&(t=l.StdTheme.Light,s=l.StdTheme.Dark);const i=R(s),r=R(t),o=this.state(),n=this.childs(),a=(e,t)=>e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3];a(i.adjBuyBgColors,o.adjBuyBgColors)&&n.adjBuyBgColors.merge(r.adjBuyBgColors),a(i.adjSellBgColors,o.adjSellBgColors)&&n.adjSellBgColors.merge(r.adjSellBgColors),a(i.adjTotalBgColors,o.adjTotalBgColors)&&n.adjTotalBgColors.merge(r.adjTotalBgColors),i.buyBgColor===o.buyBgColor&&n.buyBgColor.merge(r.buyBgColor),i.sellBgColor===o.sellBgColor&&n.sellBgColor.merge(r.sellBgColor),i.totalBgColor===o.totalBgColor&&n.totalBgColor.merge(r.totalBgColor),
i.pocColor===o.pocColor&&n.pocColor.merge(r.pocColor)},a.watchedTheme.subscribe(this._onThemeChanged)}destroy(){super.destroy(),a.watchedTheme.unsubscribe(this._onThemeChanged)}}},901110:(e,t,s)=>{"use strict";s.d(t,{StatusProviderBase:()=>i});class i{size(){return"13px"}bold(){return!1}}},32904:(e,t,s)=>{"use strict";s.d(t,{StatusView:()=>i});class i{constructor(e){this._text="",this._color="",this._size="13px",this._bold=!1,this._statusProvider=e}text(){return this._text}getSplitTitle(){return[this._text]}bold(){return this._bold}size(){return this._size}}},879938:(e,t,s)=>{"use strict";function i(e,t="shift",s){return{studyConstructorAsyncGetter:e,colorRotationMode:t,colorRotationComparator:s}}s.d(t,{addStudyInfoToMap:()=>o,createStudyInfo:()=>i,getStudyClassName:()=>a,getStudyInfoByName:()=>n});const r=new Map;function o(e,t){r.set(e,t)}function n(e){return r.get(e)}function a(e){for(const[t,s]of r.entries())if(s.studyConstructor===e)return t;return null}},296842:(e,t,s)=>{"use strict";s.d(t,{fundamentalsPrefix:()=>i,isFundamentalStudyMetaInfo:()=>r,studyNameByMetaInfo:()=>o});const i="study_Internal$STD;Fund_";function r(e){return o(e)===i}function o(e){const t="study_"+(e.classId||e.shortId);return t.startsWith(i)?i:t}},170411:(e,t,s)=>{"use strict";s.d(t,{StudyStatusProviderBase:()=>l});var i=s(901110),r=s(757402),o=s(287741);const n={NONE:"Default"},a=!0;class l extends i.StatusProviderBase{constructor(e){super(),this._source=e}getSplitTitle(){return this._source.titleInParts(o.TitleDisplayTarget.StatusLine,!0,n,void 0,a)}text(){return this._source.isActualInterval()?this._source.isFailed()?`${this._source.title(o.TitleDisplayTarget.StatusLine,!0,n,void 0,a)}: ${this.sourceStatusText()}`:`${this._source.title(o.TitleDisplayTarget.StatusLine,!0,n,void 0,a)} ${this.sourceStatusText()}`:this._source.title(o.TitleDisplayTarget.StatusLine,!0,n,void 0,a)}sourceStatusText(){return(0,r.convertStudyStatusToString)(this._source.status(),!0)}errorStatus(){if(!this._source.isActualInterval()||this._source.isSymbolInvalid())return null;const e=this._source.status();return e.type===r.StudyStatusType.Error?{error:this.sourceStatusText(),solutionId:(0,r.studyStatusSolutionId)(e),title:(0,r.studyStatusTitle)(e),studyFeature:(0,r.studyStatusFeature)(e),stackTrace:(0,r.studyErrorStatusStackTrace)(e.errorDescription.stack_trace),editorError:e.errorDescription.editorError}:null}}},903262:(e,t,s)=>{"use strict";s.d(t,{StudyStatusView:()=>r});var i=s(32904);class r extends i.StatusView{constructor(e){super(e.statusProvider())}getSplitTitle(){return this._statusProvider.getSplitTitle()}update(){this._text=this._statusProvider.text()}}},872842:(e,t,s)=>{"use strict";s.d(t,{StudyStub:()=>P});var i=s(316230),r=s(650151),o=s(120984),n=s(375397),a=s(643322),l=s(322825),d=s(219849),u=s(903262),h=s(475892),c=s(735211),_=s(942634),p=s(658843),S=s(170411),m=s(287741);class y extends S.StudyStatusProviderBase{text(){
return this._source.isActualInterval()?`${this._source.title(m.TitleDisplayTarget.StatusLine)} ${this.sourceStatusText()}`:this._source.title(m.TitleDisplayTarget.StatusLine)}}var v=s(757402),g=s(198930),b=s(850723);class f{getItems(){return[]}getValues(e){return[]}}const w=new _.Delegate;class P extends h.PriceDataSource{constructor(e,t,s,i,r=null){super(e),this._priceStep=.01,this._origState=null,this._descriptor=null,this._status={type:v.StudyStatusType.Undefined},this._statusChanged=new _.Delegate,this._descriptorChanged=new _.Delegate,this._formatter=new c.PriceFormatter({priceScale:100}),this._showPineVersionInStatusLine=new n.WatchedValue(!1).spawn(),this._pineSourceCodeModel=null,(0,b.isStudyDescriptor)(t)?this._descriptor=t:this._origState=t,this._title=s,this._alwaysShowInLegend=i,this._studyMetaInfo=r;this._properties=new p.Property({visible:!0}),this._statusView=new u.StudyStatusView(this),r&&(0,l.isCountedUserScript)(r)&&(this._showPineVersionInStatusLine=(0,a.combine)((()=>(0,l.userScriptVersionsCount)(r.scriptIdPart)>1),(0,l.userScriptsOnLayout)().weakReference()),this._showPineVersionInStatusLine.subscribe((()=>e.updateSource(this))))}destroy(){var e,t,s;null===(t=null===(e=this._pineSourceCodeModel)||void 0===e?void 0:e.get())||void 0===t||t.destroy(),null===(s=this._pineSourceCodeModel)||void 0===s||s.destroy(),this._showPineVersionInStatusLine.destroy(),super.destroy()}barColorer(){return null}properties(){return this._properties}statusView(){return this._statusView}legendView(){return null}state(e){return this._origState}getDescriptor(){return null===this._descriptor?null:{descriptor:this._descriptor,title:this._title,isOverlay:Boolean(this._alwaysShowInLegend),id:this.id(),status:this._status}}updateDescriptor(e){(0,i.default)(this._descriptor,e)||(this._descriptor=e,this._descriptorChanged.fire())}onDescriptorChanged(){return this._descriptorChanged}metaInfo(){return this._studyMetaInfo}setStatus(e){const t=this.isDisplayedInLegend();if(this._status=e,this._statusChanged.fire(),this.isDisplayedInLegend()!==t){const e=this._model.paneForSource(this);if(e){const t=this._model.panes().indexOf(e),s=d.InvalidationMask.invalidateLegendWidgetLayout(t);this.model().invalidate(s)}}}formatter(){return this._formatter}name(){return this._title}title(){return this.titleInParts().join(" ")}titleInParts(){var e;const t=[this._title];return this._showPineVersionInStatusLine.value()&&t.push((0,r.ensureDefined)(null===(e=this._studyMetaInfo)||void 0===e?void 0:e.pine).version),t}isFailed(){return this._status.type===v.StudyStatusType.Error}isLoading(){return this._status.type===v.StudyStatusType.Loading}isDisplayedInLegend(){return this._alwaysShowInLegend||this.isFailed()}setFailed(e){this.setStatus({type:v.StudyStatusType.Error,errorDescription:{error:e}}),this._model.updateSource(this)}isSymbolInvalid(){return!1}isActualInterval(){return!0}onIsActualIntervalChange(){return w}start(){}status(){return this._status}onStatusChanged(){return this._statusChanged}firstValue(){return null}currency(){return null}
sessionId(){return this._model.mainSeries().sessionId()}sessionIdChanged(){return this._model.mainSeries().sessionIdChanged()}unit(){return null}symbolSource(){return this._model.mainSeries()}barsProvider(){return this._model.mainSeries()}legendValuesProvider(){return new f}statusProvider(e){return new y(this)}isRemovedByStudyTemplates(){return null!==this._origState&&(0,g.isStudyState)(this._origState)}pineSourceCodeModel(){return null!==this._descriptor&&"pine"===this._descriptor.type?(this._pineSourceCodeModel||(this._pineSourceCodeModel=new o.AsyncResourceWrapper(Promise.all([s.e(98410),s.e(87),s.e(6927),s.e(65836),s.e(89199)]).then(s.bind(s,437334)).then((e=>this._isDestroyed?null:new e.PineStubSourceCodeModel(this))))),this._pineSourceCodeModel.promise()):Promise.resolve(null)}}},472051:(e,t,s)=>{"use strict";s.d(t,{translateSessionDescription:()=>o,translateSessionExtendedDescription:()=>l,translateSessionShortDescription:()=>a});var i=s(444372);const r=new Map([["Premarket",i.t(null,{context:"sessions"},s(659330))],["Postmarket",i.t(null,{context:"sessions"},s(450434))],["Regular Trading Hours",i.t(null,{context:"sessions"},s(884246))],["Extended Trading Hours",i.t(null,{context:"sessions"},s(836862))],["Electronic Trading Hours",i.t(null,{context:"sessions"},s(34647))]]);function o(e){var t;return null!==(t=r.get(e))&&void 0!==t?t:e}const n=new Map([["Premarket",i.t(null,{context:"sessions"},s(346273))],["Postmarket",i.t(null,{context:"sessions"},s(207807))],["Regular Trading Hours",i.t(null,{context:"sessions"},s(692158))],["Extended Trading Hours",i.t(null,{context:"sessions"},s(8029))],["Electronic Trading Hours",i.t(null,{context:"sessions"},s(8029))]]);function a(e){var t;return null!==(t=n.get(e))&&void 0!==t?t:e}function l(e){var t;return null!==(t=r.get(e))&&void 0!==t?t:e}},322825:(e,t,s)=>{"use strict";s.d(t,{addUserScriptOnLayout:()=>l,isCountedUserScript:()=>h,removeUserScriptFromLayout:()=>d,userScriptVersionsCount:()=>a,userScriptsOnLayout:()=>u});var i=s(971417),r=s(566238),o=s(306060);const n=new r.WatchedObject([]);function a(e){return new Set(n.value().filter((t=>t.id===e)).map((e=>e.version))).size}function l(e,t){n.setValue([...n.value(),{id:e,version:t}])}function d(e,t){const s=n.value().findIndex((s=>s.id===e&&s.version===t));-1!==s&&n.value().splice(s,1),n.setValue(n.value(),!0)}function u(){return n.readonly()}function h(e){return!!e.pine&&o.Version.parse(e.pine.version).major()>=1&&(0,i.isCustomPineId)(e.scriptIdPart)}},120984:(e,t,s)=>{"use strict";s.d(t,{AsyncResourceWrapper:()=>i});class i{constructor(e,t){this._destroyed=!1,this._callbacks=[],this._resource={pendingResource:e},e.then((e=>{var t;if(this._destroyed)null===(t=this._destroyFn)||void 0===t||t.call(this,e);else{for(const t of this._callbacks)t(e);this._resource.resource=e}})).finally((()=>{this._callbacks=[]}))}destroy(){var e;this._resource.resource&&(null===(e=this._destroyFn)||void 0===e||e.call(this,this._resource.resource)),this._resource={pendingResource:Promise.reject("Resource is destroyed").catch((()=>{}))},
this._callbacks=[],this._destroyed=!0}callFunction(e){this._destroyed||(this._resource.resource?e(this._resource.resource):this._callbacks.push(e))}get(){return this._destroyed||!this._resource.resource?null:this._resource.resource}promise(){return this._resource.pendingResource}}},927094:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createNoticeDialog:()=>r,showNoticeDialog:()=>o});var i=s(444372);async function r(e){return(await Promise.all([s.e(57335),s.e(77476),s.e(42810),s.e(96645),s.e(10417),s.e(91797),s.e(61135),s.e(59355),s.e(86021),s.e(25977),s.e(46086),s.e(34834)]).then(s.bind(s,81684))).createDialog({width:400,destroyOnClose:!0,title:i.t(null,void 0,s(620748)),content:i.t(null,void 0,s(653497)),contentWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--no-border"><div class="tv-text"><p></p></div></div>',actionsWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--actions tv-dialog__section--no-border">',actions:[{name:"ok",type:"primary",text:i.t(null,void 0,s(819295)),method:"close",key:[13,32]}],...e})}function o(e){r(e).then((e=>e.open()))}},503679:(e,t,s)=>{"use strict";s.d(t,{DAYS_UNTIL_BLOCK:()=>o,UserStatus:()=>i,getDaysUntilBlock:()=>n,isUserLockedOut:()=>a});var i,r=s(199872);!function(e){e.NonPro="non_pro",e.Pro="pro"}(i||(i={}));const o=30,n=(0,r.memoize)((()=>{const e=window.user.declared_status_timestamp;if(!e)return null;const t=((new Date).getTime()-new Date(1e3*e).getTime())/1e3/24/60/60;return o-Math.floor(t)})),a=(0,r.memoize)((e=>{const t=null!=e?e:n();return Boolean(t&&t<0)}))},125388:(e,t,s)=>{"use strict";function i(e,t){const s=Object.create(Object.getPrototypeOf(e));for(const i of t)Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=e[i]);return s}s.d(t,{pickFields:()=>i})},993544:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"/></svg>'}}]);
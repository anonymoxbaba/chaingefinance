(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[10196],{406137:(e,t,n)=>{"use strict";n.d(t,{applyOverridesToStudyDefaults:()=>c});var r=n(650151),o=n(748947),i=n(338619);const s={line:o.LineStudyPlotStyle.Line,histogram:o.LineStudyPlotStyle.Histogram,cross:o.LineStudyPlotStyle.Cross,area:o.LineStudyPlotStyle.Area,columns:o.LineStudyPlotStyle.Columns,circles:o.LineStudyPlotStyle.Circles,line_with_breaks:o.LineStudyPlotStyle.LineWithBreaks,area_with_breaks:o.LineStudyPlotStyle.AreaWithBreaks,step_line:o.LineStudyPlotStyle.StepLine,step_line_with_breaks:o.LineStudyPlotStyle.StepLineWithBreaks,step_line_with_diamonds:o.LineStudyPlotStyle.StepLineWithDiamonds},l=(0,i.getLogger)("Chart.Model.StudyPropertiesOverrider");var a,u;function d(e,t,n,r){const o=n.split(".");if(0===o.length||0===o[0].length)return;const i=function(e){const t=e.split(":");return{name:t[0],type:2===t.length?t[1]:null}}(o[0]),s=i.name,d=i.type,c=null!==d,p=!c||"band"===d,f=!c||"area"===d,y=!c||"input"===d,h=!c||"plot"===d?u.getPlotIdByTitle(e,s):null,S=p?u.getBandIndexByName(e,s):null,v=f?u.getFilledAreaIdByTitle(e,s):null,g=y?u.getInputByName(e,s):null,P=t.hasOwnProperty(s);if((null!==h?1:0)+(null!==S?1:0)+(null!==v?1:0)+(null!==g?1:0)+(P?1:0)>1)return void l.logWarn(`Study '${e.description}' has ambiguous identifier '${s}'`);const I=o[1];if(null!==h){if(1===o.length)return void l.logWarn(`Path of sub-property of '${s}' plot for study '${e.description}' must be not empty`);const n=o.slice(1);a.applyPlotProperty(e,t,h,n,r)}else if(null!==g)a.applyInputValue(t,g,r);else if(null!==S){if(void 0===I)return void l.logWarn(`Property name of '${s}' band for study '${e.description}' must be set`);a.applyBandProperty(t,S,I,r)}else if(null!==v){if(void 0===I)return void l.logWarn(`Property name of '${s}' area for study '${e.description}' must be set`);a.applyFilledAreaProperty(t,v,I,r)}else P?a.setRootProperty(t,o,r):l.logWarn(`Study '${e.description}' has no plot or input '${s}'`)}function c(e,t,n){for(const r in e){if(!e.hasOwnProperty(r))continue;const o=r.indexOf(".");if(-1===o)continue;const i=r.substring(0,o),s=u.getMetaInfoByDescription(t,i);if(null===s){l.logWarn(`There is no such study ${i}`);continue}const a=n(s);null!==a?d(s,a,r.substring(o+1),e[r]):l.logWarn(`Cannot apply overrides for study ${i}`)}}!function(e){e.applyPlotProperty=function(e,t,n,i,a){if(void 0===t.styles)return void l.logWarn("Study does not have styles");const u=i[0];if("color"===u){const s=function(e,t,n){if(void 0===e.plots)return null;for(const r of e.plots){if(!(0,o.isPaletteColorerPlot)(r)||void 0===t.palettes)continue;const e=t.palettes[r.palette];if(r.target===n&&void 0!==e)return e}return null}(e,t,n);return void function(e,t,n,o,i){var s;void 0!==e.styles?null===t&&!isNaN(o)&&o>0?l.logWarn(`Study plot does not have color #${o}`):((0===o||isNaN(o))&&((0,r.ensureDefined)(e.styles[n]).color=String(i),o=0),null!==t&&((0,r.ensureDefined)(null===(s=t.colors)||void 0===s?void 0:s[o]).color=String(i))):l.logWarn("Study does not have styles")
}(t,s,n,i.length>1?parseInt(i[1]):NaN,a)}const d=t.styles[n];if(void 0!==d&&d.hasOwnProperty(u)){if("plottype"===u){const e=s[String(a)];if(void 0===e)return void l.logWarn(`Unsupported plot type for plot: ${a}`);a=e}d[u]=a}else l.logWarn(`Study plot does not have property '${u}'`)},e.applyBandProperty=function(e,t,n,r){if(void 0===e.bands)return void l.logWarn("Study does not have bands");const o=e.bands[t];if(void 0!==o&&o.hasOwnProperty(n)){if("plottype"===n){const e=s[String(r)];if(void 0===e)return void l.logWarn(`Unsupported plot type for band: ${r}`);r=e}o[n]=r}else l.logWarn(`Study band does not have property '${n}'`)},e.applyFilledAreaProperty=function(e,t,n,r){if(void 0===e.filledAreasStyle)return void l.logWarn("Study does not have areas");const o=e.filledAreasStyle[t];void 0!==o&&o.hasOwnProperty(n)?o[n]=r:l.logWarn(`Study area does not have property '${n}'`)},e.applyInputValue=function(e,t,n){void 0!==e.inputs&&e.inputs.hasOwnProperty(t)?e.inputs[t]=n:l.logWarn(`Study does not have input '${t}'`)},e.setRootProperty=function(e,t,n){if(0===t.length)return;let r=e;for(const e of t.slice(0,-1)){if(null==r||!r.hasOwnProperty(e))break;r=r[e]}const o=t[t.length-1];null!=r&&r.hasOwnProperty(o)?r[o]=n:l.logWarn(`Study does not have property ${t.join(".")}`)}}(a||(a={})),function(e){e.getInputByName=function(e,t){if(void 0===e.inputs)return null;t=t.toLowerCase();for(const n of e.inputs)if(n.name.toLowerCase()===t)return n.id;return null},e.getPlotIdByTitle=function(e,t){if(void 0===e.styles)return null;t=t.toLowerCase();for(const n in e.styles){const r=e.styles[n];if((void 0!==r&&void 0!==r.title?r.title:n).toLowerCase()===t)return n}return null},e.getFilledAreaIdByTitle=function(e,t){if(void 0===e.filledAreas)return null;t=t.toLowerCase();for(const n of e.filledAreas)if(n.title.toLowerCase()===t)return n.id;return null},e.getBandIndexByName=function(e,t){if(void 0===e.bands)return null;t=t.toLowerCase();for(let n=0;n<e.bands.length;++n)if(e.bands[n].name.toLowerCase()===t)return n;return null},e.getMetaInfoByDescription=function(e,t){t=t.toLowerCase();for(const n of e)if(n.description.toLowerCase()===t||n.shortDescription.toLowerCase()===t)return n;return null}}(u||(u={}))},625611:(e,t,n)=>{"use strict";n.d(t,{StudyMetaInfoBase:()=>v,replayStrategyStudyId:()=>S});var r=n(827147),o=n(650151),i=n(748947),s=n(218049),l=n(124829),a=n(211183),u=n(187700);const d=new Set(["CorrelationCoefficient@tv-basicstudies","Correlation - Log@tv-basicstudies-1"]),c=new Set([]),p=new Set(["line"]),f=new Map([["AnchoredVWAP@tv-basicstudies","linetoolanchoredvwap"],["RegressionTrend@tv-basicstudies","linetoolregressiontrend"],["VbPAnchored@tv-basicstudies","linetoolanchoredvp"]]),y=/^([^\$]+)\$\d+$/,h=["bool","color","time","text_area"],S="ReplayStrategy@tv-scripting";class v{constructor(e,t=!1){(0,l.merge)(this,{palettes:{},inputs:[],plots:[],graphics:{},defaults:{}}),(0,l.merge)(this,e);const n=e.fullId||e.id;(0,l.merge)(this,v.parseIdString(n)),this._updateInputDisplayDefaults(),this.useVersionFromMetaInfo=t}state(){const e={}
;for(const[t,n]of Object.entries(this))"useVersionFromMetaInfo"!==t&&this.hasOwnProperty(t)&&(e[t]=n,"id"===t&&(e[t]+="-"+this.version));return e}createDefaults(){if(this.defaults){const e=(0,l.clone)(this.defaults);e.precision="default";const t=v.getStudyPropertyRootName(this);(0,a.createDefaults)(t,e)}}removeDefaults(){(0,a.removeDefaults)(v.getStudyPropertyRootName(this))}isPlotForceOverlay(e){var t,n,r,o,s;const l=null===(t=this.styles)||void 0===t?void 0:t[e],a=this.plots.find((t=>t.id===e));return!!(null==l?void 0:l.forceOverlay)||a&&(0,i.isOhlcPlot)(a)&&(null===(r=null===(n=this.ohlcPlots)||void 0===n?void 0:n[a.target])||void 0===r?void 0:r.forceOverlay)||!!(null===(s=null===(o=this.ohlcPlots)||void 0===o?void 0:o[e])||void 0===s?void 0:s.forceOverlay)}hasForceOverlayPlots(){var e;return this.plots.some((e=>this.isPlotForceOverlay(e.id)))||Object.values(null!==(e=this.ohlcPlots)&&void 0!==e?e:{}).some((e=>!!(null==e?void 0:e.forceOverlay)))}static getSourceIdsByInputs(e,t){if(!Array.isArray(e)||!t)return[];const n=[];for(const o of e)if(v.isSourceInput(o)&&(0,r.default)(t[o.id])){const e=t[o.id];e.includes("$")&&n.push(e.split("$")[0])}return n}static isSourceInput(e){return Boolean(e.id&&(("source"===e.id||"src"===e.id)&&("text"===e.type||"source"===e.type)||"source"===e.type))}static getSourceInputIds(e){const t=[];for(const n of e.inputs)v.isSourceInput(n)&&t.push(n.id);return t}static setChildStudyMetaInfoPropertiesSourceId(e,t,n){for(const r of e.inputs){if(!v.isSourceInput(r))continue;const e=n.childs().inputs&&n.childs().inputs.childs()[r.id];if(e){const n=e.value(),r=y.exec(n);if(2===(null==r?void 0:r.length)){if("{pid}"===r[1]){const r=n.replace(/^[^\$]+/,t);e.setValue(r)}}}}}static patchSoSInputs(e,t){const n=e=>{const n=y.exec(e);if(2===(null==n?void 0:n.length)){const r=n[1],i=`${(0,o.ensureNotNull)(t(r))}`;return e.replace(/^[^\$]+/,i)}return e};for(const t in e)if(/in_[\d+]/.test(t)||"source"===t){const o=e[t];(0,r.default)(o)?e[t]=n(o):(0,s.isExtendedInput)(o)&&(0,s.isExtendedInputSource)(o)&&(o.v=n(o.v))}}static canBeChild(e){if((0,r.default)(e))return!0;if(!e)return!1;if(e.extra&&!v.isAllowedSourceInputsCount(e.extra.sourceInputsCount)||!0===e.canNotBeChild||!1===e.canBeChild||d.has(e.id))return!1;let t=0;for(const n of e.inputs)v.isSourceInput(n)&&(t+=1);return v.isAllowedSourceInputsCount(t)}static isAllowedSourceInputsCount(e){return e>0||1===e}static canHaveChildren(e){if(e){if(e.isTVScriptStrategy||e.TVScriptSourceCode&&(0,u.isStrategy)(e.TVScriptSourceCode))return!1;if(e.id&&!c.has(e.id)&&Array.isArray(e.plots))for(const t of e.plots)if(p.has(t.type))return!0}return!1}static getChildSourceInputTitles(e,t,n){var r;const o={};if(t.plots&&t.plots.length&&e.options&&e.options.length)for(const i of e.options){const e=i?+i.split("$")[1]:NaN,s=isFinite(e)&&t.plots[e];s&&p.has(s.type)&&(o[i]=t.styles&&t.styles[s.id]&&(null===(r=t.styles[s.id])||void 0===r?void 0:r.title)||s.id,n&&(o[i]=n+":â€‰"+o[i]))}return o}static canPlotBeSourceOfChildStudy(e){return p.has(e)}
static getStudyPropertyRootName(e){const t=f.get(e.id);if(void 0!==t)return t;let n="study_"+e.id;return e.pine&&e.pine.version&&(n+="_"+e.pine.version.replace(".","_")),n}static getStudyPropertyRootNameById(e){const t=f.get(e);return void 0!==t?t:"study_"+e}static isScriptStrategy(e){if(e.extra&&e.extra.kind)return"strategy"===e.extra.kind;if(!0===e.isTVScriptStrategy)return!0;const t=e.TVScriptSourceCode||e.scriptSource;return!!t&&(0,u.isStrategy)(t)}static isReplayStrategy(e){return e.id===S}static parseIdString(e){const t={};if(-1===e.indexOf("@"))t.shortId=e,t.packageId="tv-basicstudies",t.id=e+"@"+t.packageId,t.version=1;else{const n=e.split("@");t.shortId=n[0];const r=n[1].split("-");if(3===r.length)t.packageId=r.slice(0,2).join("-"),t.id=t.shortId+"@"+t.packageId,t.version=parseInt(r[2]);else if(1===r.length&&"decisionbar"===r[0])t.packageId="les-"+r[0],t.id=t.shortId+"@"+t.packageId,t.version=1;else{if(1!==r.length)throw new Error("unexpected study id:"+e);t.packageId="tv-"+r[0],t.id=t.shortId+"@"+t.packageId,t.version=1}}if(t.fullId=t.id+"-"+t.version,"tv-scripting"===t.packageId){const e=t.shortId;if(0===e.indexOf("Script$")||0===e.indexOf("StrategyScript$")){const n=e.indexOf("_");t.productId=n>=0?e.substring(0,n):t.packageId}else t.productId=t.packageId}else t.productId=t.packageId;return t}_updateInputDisplayDefaults(){this.inputs.filter((e=>void 0===e.display)).forEach((e=>{h.includes(e.type)?e.display=s.InputDisplayFlags.None:e.display=s.InputDisplayFlags.All}))}}},187700:(e,t,n)=>{var r;e=n.nmd(e),"undefined"!=typeof window&&(r=window.TVScript=window.TVScript||{}),(r=r||{}).Access={},r.Access.ACCESS_OPEN_NO_AUTH="open_no_auth",r.Access.ACCESS_CLOSED_NO_AUTH="closed_no_auth",r.Access.ACCESS_CLOSED_NEEDS_AUTH="closed_needs_auth",r.Access.MAP_ID_TO_NAME={1:r.Access.ACCESS_OPEN_NO_AUTH,2:r.Access.ACCESS_CLOSED_NO_AUTH,3:r.Access.ACCESS_CLOSED_NEEDS_AUTH},r.Access.MAP_NAME_TO_ID={},Object.keys(r.Access.MAP_ID_TO_NAME).forEach((function(e){r.Access.MAP_NAME_TO_ID[r.Access.MAP_ID_TO_NAME[e]]=e})),r.PinePrefix={},r.PinePrefix.USER="USER;",r.PinePrefix.PUB="PUB;",r.PinePrefix.STD="STD;",r.PinePrefix.TV="TV_",r.PinePrefix.EDGR="EDGR_",r.PineType={},r.PineType.UserSaved="PineType_UserSaved",r.PineType.UserPublished="PineType_UserPublished",r.PineType.BuiltIn="PineType_BuiltIn",r.PineType.Addon="PineType_Addon",r.Type=r.Type||function(){},r.Type.VOID="void",r.Type.INTEGER="integer",r.Type.FLOAT="float",r.Type.STRING="string",r.Type.BOOL="bool",r.Type.COLOR="color",r.Type.SERIES="series",r.Type.PLOT="plot",r.Type.HLINE="hline",r.Type.BARCOLOR="barcolor",r.Type.BGCOLOR="bgcolor",r.Type.PLOTSHAPES="plotshape",r.Type.PLOTCHARS="plotchar",r.Type.PLOTARROWS="plotarrow",r.Type.NA="na",r.Type.ARRAY="array",r.TranslatorDefaultVersion=1,r.TranslatorReferenceVersioningIntroduced=4,r.TranslatorLastVersion=5,r.pineType=function(e){
return e.startsWith(r.PinePrefix.USER)?r.PineType.UserSaved:e.startsWith(r.PinePrefix.PUB)?r.PineType.UserPublished:e.startsWith(r.PinePrefix.STD)||e.startsWith(r.PinePrefix.TV)||e.startsWith(r.PinePrefix.EDGR)?r.PineType.BuiltIn:r.PineType.Addon},r.patchILTemplate=function(e,t,n){var o=n||{};return r._patchTemplate(/<(in_\d+)>/g,e,t,o)},r.decorateQuotes=function(e){if(!e)return e;var t=/([^\\']+?)(')[^']*?/g,n="$1\\$2",r=e;return"'"==r.charAt(0)&&"'"==r.charAt(r.length-1)?"'"+(r=r.substr(1,r.length-2)).replace(t,n)+"'":r.replace(t,n)},r.patchInputs=function(e,t){var n={};for(var r in e)if(e.hasOwnProperty(r)){var o,i=e[r];o=i.isFake?{v:t[i.id],f:!0,t:i.type}:t[i.id],n[i.id]=o}return n},r._patchTemplate=function(e,t,n,o){var i=o||{};return t.replace(e,(function(e,t){for(var o=(t in i?i[t]:n.defaults.inputs[t]),s=0;s<n.inputs.length;++s)if(n.inputs[s].id===t)if("bool"===n.inputs[s].type)o=o?"1.0":"0.0";else if(["text","symbol","resolution","session"].indexOf(n.inputs[s].type)>=0)o="'"+r.decorateQuotes(o)+"'";else if("source"===n.inputs[s].type){var l=o.split("$");l[0]="'"+l[0]+"'",o="source("+l.join(",")+")"}return o}))},r.isStrategy=function(e){return/^\s*strategy\s*\(/m.test(e)};var o=/^\s*\/\/\s*?@version\s*?=\s*?(\S*?)\s*?$/gm,i=/^[0-9]+$/;r.extractVersion=function(e){o.lastIndex=0;var t=o.exec(e);if(null===t)return 1;var n=t[1],s=i.test(n)?Number(n):NaN;return isNaN(s)?1:Math.max(r.TranslatorDefaultVersion,Math.min(s,r.TranslatorLastVersion))},r.canUpgradeVersion=function(e){return e>=3&&e<r.TranslatorLastVersion},r.canDowngradeVersion=function(e){return e>=4&&e<=r.TranslatorLastVersion},e&&e.exports&&(e.exports=r)}}]);
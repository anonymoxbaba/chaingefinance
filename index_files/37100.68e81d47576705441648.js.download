"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[37100],{729030:(e,t,i)=>{i.d(t,{getSymbolData:()=>l});var n=i(702598),o=i(438874),s=i(250378),a=i(685503),r=i(159954);function l(e,t,i,l=!0,d=!1){const c=i.join(","),u=(0,o.getSymbolDataUrl)(t,c,l,d),h={signal:e,method:"GET",credentials:"include",headers:{Accept:"application/json"}};return(0,n.fetch)(u,h,{logOnErrorStatus:!1}).then((e=>{if(400===e.status){const{status:t,statusText:i}=e;return e.json().then((e=>{const n=e.errmsg;throw new s.BadRequestErrorResponse({status:t,statusText:i,error:n})}))}if(404===e.status){const{status:t,statusText:i}=e;return e.json().then((n=>{if("symbol_not_exists"===n.code){const e=n.errmsg;throw new r.SymbolDoesNotExistErrorResponse({status:t,statusText:i,error:e})}throw new a.HttpErrorResponse(e)}))}if(e.ok)return e.json().then((e=>e));throw new a.HttpErrorResponse(e)}))}},583912:(e,t,i)=>{i.d(t,{linking:()=>y});var n=i(12481),o=i(650151),s=i(375397),a=(i(764829),i(378975)),r=i(975179),l=i(338619),d=i(62802),c=i(588948),u=i(776734),h=i(149109),p=i(912445);const m=(0,l.getLogger)("Linking");class S{constructor(e,t,i){this.watchedSymbol=new s.WatchedValue,this.seriesShortSymbol=new s.WatchedValue,this.proSymbol=new s.WatchedValue,this.ensuredProSymbol=new s.WatchedValue,this.watchedInterval=new s.WatchedValue,this.watchedIntraday=new s.WatchedValue,this.watchedSeconds=new s.WatchedValue,this.watchedTicks=new s.WatchedValue,this.watchedDataFrequencyResolution=new s.WatchedValue,this.watchedRange=new s.WatchedValue,this.watchedSupportedResolutions=new s.WatchedValue,this.watchedSupportedChartStyles=new s.WatchedValue,this.symbolNamesList=new s.WatchedValue,this._chartWidgetCollection=null,this._chartWidgetBindingState=0,this._activeChartWidget=null,this._linkingGroupCharts=null,this._boundChartWidget=null,this._watchedSymbolListenerBound=this._watchedSymbolListener.bind(this),this._watchedIntervalListenerBound=this._watchedIntervalListener.bind(this),this._muted=!1,this.updateBoundChartWidget=()=>{const e=this._chartToBind();e!==this._boundChartWidget&&(null===e?this.unbindFromChartWidget():this.bindToChartWidget(e))},this._updateAllGroupChartWidgets=()=>{var e;null===(e=this._destroySymbolIntervalPropertySubscriptions)||void 0===e||e.call(this);const t=(0,o.ensureNotNull)(this._linkingGroupCharts).value(),i=[],n=[];for(const e of t){const t=e.symbolWV().spawn(),o=e.resolutionWV().spawn();t.subscribe(this._updateSymbolByProperty.bind(this,e)),o.subscribe(this._updateIntervalByProperty.bind(this,e)),i.push(t),n.push(o)}this._destroySymbolIntervalPropertySubscriptions=()=>{i.forEach((e=>e.destroy())),n.forEach((e=>e.destroy())),this._destroySymbolIntervalPropertySubscriptions=void 0};const s=this.watchedSymbol.value();t.length>1&&this._needApplySymbol(s)&&!this._muted&&this._setGroupSymbol(s);const a=this.watchedInterval.value();t.length>1&&this._needApplyInterval(a)&&!this._muted&&this._setGroupInterval(a),this.updateBoundChartWidget()},this._groupIndex=e;const n=(e,t)=>{e.subscribe((e=>{
i()===this&&t.setValue(e)}),{callWithLast:!0})};n(this.watchedSymbol,t.watchedSymbol),n(this.seriesShortSymbol,t.seriesShortSymbol),n(this.proSymbol,t.proSymbol),n(this.ensuredProSymbol,t.ensuredProSymbol),n(this.watchedInterval,t.watchedInterval),n(this.watchedIntraday,t.watchedIntraday),n(this.watchedSeconds,t.watchedSeconds),n(this.watchedTicks,t.watchedTicks),n(this.watchedDataFrequencyResolution,t.watchedDataFrequencyResolution),n(this.watchedRange,t.watchedRange),n(this.watchedSupportedResolutions,t.watchedSupportedResolutions),n(this.watchedSupportedChartStyles,t.watchedSupportedChartStyles),n(this.symbolNamesList,t.symbolNamesList),this.watchedSymbol.subscribe((e=>{this._boundChartWidget&&this._boundChartWidget.hasModel()&&this._mainSeries().symbolSameAsCurrent(e)||this.proSymbol.setValue(e)}),{callWithLast:!0})}mute(e){this._muted=e}bindToChartWidgetCollection(e){this.unbindFromChartWidgetCollection(),this._chartWidgetCollection=e,this._activeChartWidget=e.activeChartWidget.spawn(),this._activeChartWidget.subscribe(this.updateBoundChartWidget),this._linkingGroupCharts=e.linkingGroupsCharts(this._groupIndex).spawn(),this._linkingGroupCharts.subscribe(this._updateAllGroupChartWidgets),this.updateBoundChartWidget(),this._updateAllGroupChartWidgets()}unbindFromChartWidgetCollection(){var e,t,i;this.unbindFromChartWidget(),this._chartWidgetCollection=null,null===(e=this._activeChartWidget)||void 0===e||e.destroy(),this._activeChartWidget=null,null===(t=this._linkingGroupCharts)||void 0===t||t.destroy(),this._linkingGroupCharts=null,null===(i=this._destroySymbolIntervalPropertySubscriptions)||void 0===i||i.call(this)}bindToChartWidget(e){if(this.unbindFromChartWidget(),this._boundChartWidget=e,e.hasModel())return void this._onChartModelCreated(e.model());e.modelCreated().subscribe(this,this._onChartModelCreated,!0),this._chartWidgetBindingState=1;const t=e.properties().childs().mainSeriesProperties.childs();this.watchedSymbol.setValue(t.symbol.value()),this.watchedInterval.setValue(t.interval.value()),this._boundChartWidget.linkingGroupIndex().subscribe(this.updateBoundChartWidget)}unbindFromChartWidget(){const e=this._boundChartWidget;if(null!==e){switch(this._chartWidgetBindingState){case 1:e.modelCreated().unsubscribeAll(this);break;case 2:this.watchedSymbol.unsubscribe(this._watchedSymbolListenerBound);const t=this._mainSeries().dataEvents();t.symbolResolved().unsubscribeAll(this),t.symbolError().unsubscribeAll(this),this._mainSeries().onIntervalChanged().unsubscribeAll(this),this.watchedInterval.unsubscribe(this._watchedIntervalListenerBound),delete this.watchedSymbol.writeLock}e.linkingGroupIndex().unsubscribe(this.updateBoundChartWidget),this._boundChartWidget=null,this._chartWidgetBindingState=0}}boundChartWidget(){return this._boundChartWidget}_mainSeries(){if(!this._boundChartWidget)throw new Error("ChartWidget is undefined");return this._boundChartWidget.model().mainSeries()}_watchedSymbolListener(e){this._needApplySymbol(e)&&!this._muted&&(this._setGroupSymbol(e),this._sendSnowplowAnalytics())}
_updateSymbolByProperty(e,t){const i=this._symbolLock();i&&this._needApplySymbol(t)&&!this._muted&&this._setGroupSymbol(t),(i||e===this._boundChartWidget)&&this.watchedSymbol.setValue(t)}_watchedIntervalListener(e){const t=a.Interval.normalize(e);t&&this._needApplyInterval(t)&&!this._muted&&this._setGroupInterval(t)}_updateIntervalByProperty(e,t){const i=this._intervalLock(),n=a.Interval.normalize(t);i&&n&&this._needApplyInterval(n)&&!this._muted&&this._setGroupInterval(n),(i||e===this._boundChartWidget)&&this.watchedInterval.setValue(null!=n?n:t)}_sendSnowplowAnalytics(){if(window.user.do_not_track)return;const e=this._mainSeries(),t=()=>{e.dataEvents().symbolResolved().unsubscribe(this,i)},i=i=>{(0,u.getTracker)().then((e=>{if(null===e)return;const t=(0,o.ensureNotNull)(this._chartWidgetCollection),n=t.layout.value(),s=t.metaInfo.uid.value()||"";e.trackChartSymbols(i.pro_name,i.type,n,s)})),e.dataEvents().symbolError().unsubscribe(this,t)};e.dataEvents().symbolResolved().subscribe(this,i,!0),e.dataEvents().symbolError().subscribe(this,t,!0)}_updateSeriesSymbolInfo(){this.seriesShortSymbol.setValue((0,o.ensureNotNull)(this._boundChartWidget).getSymbol(!0));const e=this._mainSeries().symbolInfo();if(e){const t=e.pro_name||!1;this.proSymbol.setValue(t||this.watchedSymbol.value()),this.ensuredProSymbol.setValue(this.proSymbol.value()),e.aliases&&this.symbolNamesList.setValue(e.aliases);let i=(0,h.allChartStyles)();((0,r.isCloseBasedSymbol)(e)||this._mainSeries().intervalObj().is1Tick())&&(i=i.filter((e=>(0,r.isSingleValueBasedStyle)(e)))),this.watchedSupportedChartStyles.setValue(i),this.watchedIntraday.setValue(!!e.has_intraday),this.watchedSeconds.setValue(!!e.has_seconds),this.watchedTicks.setValue(!(0,r.isCloseBasedSymbol)(e)&&!!e["is-tickbars-available"]),this.watchedRange.setValue(!(0,r.isCloseBasedSymbol)(e));const n=e.data_frequency?e.data_frequency:void 0;this.watchedDataFrequencyResolution.setValue(n)}else this.watchedIntraday.setValue(!1),this.watchedSeconds.setValue(!1),this.watchedTicks.setValue(!1),this.watchedRange.setValue(!1),this._mainSeries().isFailed()&&this.ensuredProSymbol.setValue(this.proSymbol.value())}_onChartModelCreated(e){if(!this._boundChartWidget)throw new Error("ChartWidget is undefined");this._chartWidgetBindingState=2,this.watchedSymbol.setValue(this._boundChartWidget.symbolWV().value()),this.watchedSymbol.subscribe(this._watchedSymbolListenerBound);const t=e.mainSeries().dataEvents();t.symbolResolved().subscribe(this,this._updateSeriesSymbolInfo),t.symbolError().subscribe(this,this._updateSeriesSymbolInfo),e.mainSeries().onIntervalChanged().subscribe(this,this._updateSeriesSymbolInfo),this._updateSeriesSymbolInfo(),this.watchedInterval.setValue(this._boundChartWidget.resolutionWV().value()),this.watchedInterval.subscribe(this._watchedIntervalListenerBound),this._boundChartWidget.readOnly()&&(this.watchedSymbol.writeLock=!0)}_chartToBind(){var e;const t=this._chartWidgetCollection
;return null===t?null:t.activeChartWidget.value().linkingGroupIndex().value()===this._groupIndex?t.activeChartWidget.value():null!==this._boundChartWidget&&this._boundChartWidget.linkingGroupIndex().value()===this._groupIndex?this._boundChartWidget:null!==(e=t.getAll().find((e=>e.linkingGroupIndex().value()===this._groupIndex)))&&void 0!==e?e:null}_symbolLock(){var e;return!!(null===(e=this._chartWidgetCollection)||void 0===e?void 0:e.lock.symbol.value())}_intervalLock(){var e;return!!(null===(e=this._chartWidgetCollection)||void 0===e?void 0:e.lock.interval.value())}_chartsForLock(e){return(0===e?this._symbolLock():this._intervalLock())?(0,o.ensureNotNull)(this._linkingGroupCharts).value():this._boundChartWidget?[this._boundChartWidget]:[]}_setGroupSymbol(e){this.mute(!0),(0,o.ensureNotNull)(this._chartWidgetCollection).setSymbol(e,this._groupIndex,(0,o.ensureNotNull)(this._boundChartWidget)).finally((()=>{if(this._boundChartWidget){const t=this._boundChartWidget.model().mainSeries();t.symbolSameAsCurrent(e)||(this.watchedSymbol.setValue(t.symbol()),this.proSymbol.setValue(t.proSymbol()))}})),this.mute(!1)}_needApplySymbol(e){const t=this._chartsForLock(0),i=t.find((t=>t.hasModel()&&t.model().mainSeries().symbolInfo()&&t.model().mainSeries().symbolSameAsResolved(e)));if(i){const e=i.model().mainSeries();if(t.every((t=>e.symbolSameAsResolved(t.symbolWV().value()))))return!1}return t.some((t=>t.symbolWV().value()!==e))}_setGroupInterval(e){this.mute(!0),(0,o.ensureNotNull)(this._chartWidgetCollection).setResolution(e,this._groupIndex).finally((()=>{if(this._boundChartWidget){const t=this._boundChartWidget.resolutionWV().value();a.Interval.isEqual(t,e)||this.watchedInterval.setValue(t)}})),this.mute(!1)}_needApplyInterval(e){return this._chartsForLock(1).some((t=>!a.Interval.isEqual(t.resolutionWV().value(),e)))}}const y=new class{constructor(){this._watchedSymbol=new s.WatchedValue,this._seriesShortSymbol=new s.WatchedValue,this._proSymbol=new s.WatchedValue,this._ensuredProSymbol=new s.WatchedValue,this._watchedInterval=new s.WatchedValue,this._watchedIntraday=new s.WatchedValue,this._watchedSeconds=new s.WatchedValue,this._watchedTicks=new s.WatchedValue,this._watchedDataFrequencyResolution=new s.WatchedValue,this._watchedRange=new s.WatchedValue,this._watchedSupportedResolutions=new s.WatchedValue,this._watchedSupportedChartStyles=new s.WatchedValue([]),this._symbolNamesList=new s.WatchedValue,this._chartWidgetCollection=null,this._onSymbolLinkBound=this._onSymbolLink.bind(this),this._searchCharts=null,this._searchChartsLoadDebounced=null,this._selfEmit=!1,this._preventFeedBySymbol=!1,this._feedBySymbolDebounceCounter=0,this._linkingGroups=new Map,this._activeLinkingGroup=new s.WatchedValue,this._activeLinkingGroupIndex=null,this._updateLinkingGroups=()=>{(0,o.ensureNotNull)(this._chartWidgetCollection).allLinkingGroups().value().forEach((e=>this._linkingGroup(e))),this._linkingGroups.forEach((e=>e.updateBoundChartWidget()))},this._activeLinkingGroup.setValue(this._linkingGroup(null));const e=(e,t)=>{
e.subscribe((e=>t().setValue(e)),{callWithLast:!0})};e(this._watchedSymbol,(()=>this._activeLinkingGroup.value().watchedSymbol)),e(this._seriesShortSymbol,(()=>this._activeLinkingGroup.value().seriesShortSymbol)),e(this._proSymbol,(()=>this._activeLinkingGroup.value().proSymbol)),e(this._ensuredProSymbol,(()=>this._activeLinkingGroup.value().ensuredProSymbol)),e(this._watchedInterval,(()=>this._activeLinkingGroup.value().watchedInterval)),e(this._watchedIntraday,(()=>this._activeLinkingGroup.value().watchedIntraday)),e(this._watchedSeconds,(()=>this._activeLinkingGroup.value().watchedSeconds)),e(this._watchedTicks,(()=>this._activeLinkingGroup.value().watchedTicks)),e(this._watchedDataFrequencyResolution,(()=>this._activeLinkingGroup.value().watchedDataFrequencyResolution)),e(this._watchedRange,(()=>this._activeLinkingGroup.value().watchedRange)),e(this._watchedSupportedResolutions,(()=>this._activeLinkingGroup.value().watchedSupportedResolutions)),e(this._watchedSupportedChartStyles,(()=>this._activeLinkingGroup.value().watchedSupportedChartStyles)),e(this._symbolNamesList,(()=>this._activeLinkingGroup.value().symbolNamesList));const t=e=>{this._watchedSymbol.setValue(e.watchedSymbol.value()),this._seriesShortSymbol.setValue(e.seriesShortSymbol.value()),this._proSymbol.setValue(e.proSymbol.value()),this._ensuredProSymbol.setValue(e.ensuredProSymbol.value()),this._watchedInterval.setValue(e.watchedInterval.value()),this._watchedIntraday.setValue(e.watchedIntraday.value()),this._watchedSeconds.setValue(e.watchedSeconds.value()),this._watchedTicks.setValue(e.watchedTicks.value()),this._watchedDataFrequencyResolution.setValue(e.watchedDataFrequencyResolution.value()),this._watchedRange.setValue(e.watchedRange.value()),this._watchedSupportedResolutions.setValue(e.watchedSupportedResolutions.value()),this._watchedSupportedChartStyles.setValue(e.watchedSupportedChartStyles.value()),this._symbolNamesList.setValue(e.symbolNamesList.value())};this._activeLinkingGroup.subscribe(t),t(this._activeLinkingGroup.value()),(0,p.setMuteLinkingGroup)(((e,t)=>{this._linkingGroup(e).mute(t)}))}get symbol(){return this._watchedSymbol}get proSymbol(){return this._proSymbol.readonly()}get ensuredProSymbol(){return this._ensuredProSymbol.readonly()}get symbolNamesList(){return this._symbolNamesList.readonly()}get seriesShortSymbol(){return this._seriesShortSymbol.readonly()}get interval(){return this._watchedInterval}get intraday(){return this._watchedIntraday.readonly()}get seconds(){return this._watchedSeconds.readonly()}get ticks(){return this._watchedTicks.readonly()}get range(){return this._watchedRange.readonly()}get supportedResolutions(){return this._watchedSupportedResolutions.readonly()}get supportedChartStyles(){return this._watchedSupportedChartStyles.readonly()}get preventFeedBySymbol(){return this._preventFeedBySymbol}get dataFrequencyResolution(){return this._watchedDataFrequencyResolution.readonly()}activeLinkingGroup(){return this._activeLinkingGroup.readonly()}getChartWidget(){
return this.activeLinkingGroup().value().boundChartWidget()}bindToChartWidgetCollection(e){var t;null===(t=this._chartWidgetCollection)||void 0===t||t.onAboutToBeDestroyed.unsubscribeAll(this),this._unbindFromChartWidgetCollection(),this._chartWidgetCollection=e,this._chartWidgetCollection.onAboutToBeDestroyed.subscribe(this,this._unbindFromChartWidgetCollection),this._chartWidgetCollection.allLinkingGroups().subscribe(this._updateLinkingGroups),this._updateLinkingGroups(),this._activeLinkingGroupIndex=e.activeLinkingGroup().spawn(),this._activeLinkingGroupIndex.subscribe((e=>{this._activeLinkingGroup.setValue(this._linkingGroup(e))}),{callWithLast:!0}),this._linkingGroups.forEach((t=>t.bindToChartWidgetCollection(e)))}bindToSearchCharts(e){this.unbindFromSearchCharts(),this._searchCharts=e,e.onSearchBySymbol.subscribe(this,this._onSearchBySymbol),e.loadingSymbol.subscribe((e=>{!1===e&&(this._feedBySymbolDebounceCounter=0)})),this._watchedSymbol.subscribe(this._onSymbolLinkBound)}unbindFromSearchCharts(){this._searchCharts&&(this._searchCharts.onSearchBySymbol.unsubscribe(this,this._onSearchBySymbol),this._watchedSymbol.unsubscribe(this._onSymbolLinkBound),this._searchCharts=null)}setPreventFeedBySymbol(e){this._preventFeedBySymbol=e}setSymbolAndLogInitiator(e,t,i){(this.symbol.value()!==e||i)&&(m.logInfo(`Change linking symbol to ${e}, initiator: ${t}`),this.symbol.setValue(e,i))}_onSearchBySymbol(e){if(!e.resolved_symbol)throw new Error("no resolved_symbol");this._selfEmit=!0,this._watchedSymbol.setValue(e.resolved_symbol),this._selfEmit=!1}_onSymbolLink(e){if(!this._selfEmit){if(!this._searchCharts){const e="No search charts defined";throw m.logError(e),new Error(e)}this._preventFeedBySymbol||this._loadSearchCharts(e)}}_loadSearchCharts(e){if(!this._searchCharts){const e="No search charts defined";throw m.logError(e),new Error(e)}if(this._searchChartsLoadDebounced)return void(this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced(e)));const t=e=>this._searchCharts?(!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,n.default)(t,2e3),this._searchChartsLoadDebounced(e)):this._searchChartsLoadDebounced=null,this._searchCharts.feedBySymbol.call(this._searchCharts,e)):()=>{};!0===this._searchCharts.loadingSymbol.value()?this._feedBySymbolDebounceCounter<100&&(this._feedBySymbolDebounceCounter++,this._searchChartsLoadDebounced=(0,n.default)(t,2e3),this._searchChartsLoadDebounced(e)):this._searchCharts.feedBySymbol(e)}_linkingGroup(e){let t=this._linkingGroups.get(e);if(void 0===t){const i={watchedSymbol:this._watchedSymbol,seriesShortSymbol:this._seriesShortSymbol,proSymbol:this._proSymbol,ensuredProSymbol:this._ensuredProSymbol,watchedInterval:this._watchedInterval,watchedIntraday:this._watchedIntraday,watchedSeconds:this._watchedSeconds,watchedTicks:this._watchedTicks,watchedDataFrequencyResolution:this._watchedDataFrequencyResolution,
watchedRange:this._watchedRange,watchedSupportedResolutions:this._watchedSupportedResolutions,watchedSupportedChartStyles:this._watchedSupportedChartStyles,symbolNamesList:this._symbolNamesList};t=new S(e,i,(()=>this._activeLinkingGroup.value())),this._linkingGroups.set(e,t),this._chartWidgetCollection&&t.bindToChartWidgetCollection(this._chartWidgetCollection)}return t}_unbindFromChartWidgetCollection(){var e;null!==this._chartWidgetCollection&&(null===(e=this._activeLinkingGroupIndex)||void 0===e||e.destroy(),this._activeLinkingGroupIndex=null,this._linkingGroups.forEach((e=>e.unbindFromChartWidgetCollection())),this._chartWidgetCollection.allLinkingGroups().unsubscribe(this._updateLinkingGroups),this._chartWidgetCollection=null)}};{const e=(0,c.getFreshInitData)().symbolInfo,t=e?e.pro_symbol:d.getValue("editchart.model.symbol",window.DEFAULT_SYMBOL);y.setSymbolAndLogInitiator(t,"initial data")}window.TradingViewApi||(window.TradingViewApi={linking:y})},304986:(e,t,i)=>{i.d(t,{getThemeFromUserSettings:()=>s,saveThemeInUserSettings:()=>a});var n=i(62802),o=i(278855);function s(){return(0,o.getThemeFromCookie)()||(0,n.getValue)("current_theme.name")||null}function a(e){(0,o.setThemeToCookie)(e),(0,n.setValue)("current_theme.name",e,{forceFlush:!0})}},429874:(e,t,i)=>{i.r(t),i.d(t,{DEFAULT_THEME:()=>d.DEFAULT_THEME,extractThemeFromModel:()=>k,getCurrentTheme:()=>h,getStdTheme:()=>w,getStdThemeNames:()=>f,getStdThemedValue:()=>T,getTheme:()=>b,getThemeNames:()=>v,getThemedColor:()=>p,isPublicTheme:()=>u,isStdTheme:()=>P,isStdThemeName:()=>_,isStdThemedDefaultValue:()=>I,isThemeExist:()=>W,loadTheme:()=>m,removeTheme:()=>A,restoreTheme:()=>S,saveTheme:()=>C,savedThemeName:()=>y,syncTheme:()=>g,themes:()=>c.themes,translateStdThemeName:()=>L});var n=i(724377),o=i(211183),s=i(304986);const a=i(787703);var r=i(919346),l=i(331633),d=i(484400),c=i(994123);function u(e){return!e.isPrivate}function h(){return c.themes[l.watchedTheme.value()]||c.themes[d.DEFAULT_THEME]}function p(e){return h().getThemedColor(e)}async function m(e,t){const{themeName:i,standardTheme:n,syncState:s=!0,noUndo:a=!1,applyOverrides:r=!1,onlyActiveChart:l=!1}=t,d=await(n?Promise.resolve(w(i)):b(i)),c=!n;if(void 0!==d.content){const t=!n||l;r&&(void 0!==(u=d.content).chartProperties&&(0,o.applyDefaultsOverrides)(u.chartProperties),void 0!==u.mainSourceProperties&&(0,o.applyDefaultsOverrides)(u.mainSourceProperties,void 0,!0,"mainSeriesProperties")),await e.applyTheme({theme:d.content,onlyActiveChart:t,restoreNonThemeDefaults:c,themeName:i,standardTheme:n,syncState:s,noUndo:a})}var u;return d}function S(){(0,l.setTheme)((0,s.getThemeFromUserSettings)()||d.DEFAULT_THEME)}function y(){return(0,s.getThemeFromUserSettings)()}function g(){(0,s.saveThemeInUserSettings)(h().name)}function b(e){return a.loadTheme(e)}function v(){return a.loadThemes()}function f(){return r.getStdThemeNames()}function _(e){return f().includes(e)}function w(e){return r.getStdChartTheme(e)||{content:void 0}}function T(e,t){
const i=t||h().name,n=r.getStdChartTheme(i),o=0!==e.length&&e.split(".");return n&&n.content&&o?o.reduce(((e,t)=>e[t]),n.content):null}function I(e,t,i){const o=T(e,i);return null!==o&&(0,n.areEqualRgba)((0,n.parseRgba)(o),(0,n.parseRgba)(String(t)))}function C(e,t){return a.saveTheme(e,t)}function A(e){return a.removeTheme(e)}function W(e){return a.isThemeExist(e)}function L(e){return r.translateThemeName(e)}function P(e){return r.isStdTheme(e)}function k(e){var t,i;return{content:{chartProperties:{paneProperties:e.model().properties().childs().paneProperties.state(),scalesProperties:e.model().properties().childs().scalesProperties.state()},sessions:null!==(i=null===(t=e.model().sessions().state())||void 0===t?void 0:t.properties)&&void 0!==i?i:(0,o.factoryDefaults)("sessions"),mainSourceProperties:e.model().mainSeries().properties().state(),version:e.model().version()}}}},72368:(e,t,i)=>{i.d(t,{canShowNewSymbolSearch:()=>l,getCurrentLocaleInfoCountry:()=>d,isMobile:()=>a,isPlatformMobile:()=>r});var n=i(314802),o=i(764829),s=i(638456);function a(){const e=window.matchMedia("(min-width: 602px) and (min-height: 445px)").matches;return s.CheckMobile.any()&&!e}function r(){return!(0,n.isOnMobileAppPage)("any")&&a()}function l(){return!o.enabled("widget")&&!(0,n.isOnMobileAppPage)("any")}function d(){var e,t;return null===(t=null===(e=window.initData)||void 0===e?void 0:e.currentLocaleInfo)||void 0===t?void 0:t.flag.toUpperCase()}},515828:(e,t,i)=>{i.d(t,{MINDS_GROUP_PATH_PATTERN:()=>n,createMindsPath:()=>o});const n="/minds/groups/:symbol/";function o(e,t,i){let o=n.replace(":symbol",encodeURIComponent(e));if(!t)return o;const s=new URLSearchParams;return s.set("mind",t),i&&s.set("editable","true"),o+=`?${s.toString()}`,o}},951713:(e,t,i)=>{i.d(t,{getHideOptions:()=>c,getSavedHideMode:()=>h,toggleHideMode:()=>u});var n=i(650151),o=i(444372),s=i(62802),a=i(84281),r=i(419283),l=i(597101);let d=null;function c(){if(null!==d)return d;const e=(0,a.tradingService)();return d=new Map([["drawings",{label:o.t(null,void 0,i(703217)),dataName:"hide-drawing-tools",tooltip:{active:o.t(null,void 0,i(185891)),inactive:o.t(null,void 0,i(752563))},getBoxedValue:()=>(0,r.hideAllDrawings)(),trackLabel:"hide drawings"}],["indicators",{label:o.t(null,void 0,i(72351)),dataName:"hide-indicators",tooltip:{active:o.t(null,void 0,i(598753)),inactive:o.t(null,void 0,i(178525))},getBoxedValue:()=>(0,r.hideAllIndicators)(),trackLabel:"hide indicators"}],["positions",{label:o.t(null,void 0,i(492226)),dataName:"hide-positions-and-orders",tooltip:{active:o.t(null,void 0,i(420506)),inactive:o.t(null,void 0,i(842164))},getBoxedValue:()=>(0,n.ensureNotNull)(e).showTradedSources,inverted:!0,trackLabel:"hide positions"}],["all",{label:o.t(null,void 0,i(47074)),dataName:"hide-all",tooltip:{active:e?o.t(null,void 0,i(686738)):o.t(null,void 0,i(225881)),inactive:e?o.t(null,void 0,i(418216)):o.t(null,void 0,i(90763))},trackLabel:"hide all"}]]),e||d.delete("positions"),d}function u(e){e?s.setValue("ChartToolsHideMode",e):e=h();const t=p();let i=!t
;return"all"===e?(m(((e,t,n)=>{e.setValue(n?!i:i)})),l.hideStateChange.fire({hideMode:e,isActive:i}),i):(m(((n,o,s)=>{if(o===e){const e=t?!s:!n.value();n.setValue(e),i=s?!e:e}else n.setValue(Boolean(s))})),l.hideStateChange.fire({hideMode:e,isActive:i}),i)}function h(){const e=s.getValue("ChartToolsHideMode","drawings");return c().has(e)?e:"drawings"}function p(){let e=!0;return m(((t,i,n)=>{const o=t.value();e=e&&(n?!o:o)})),e}function m(e){c().forEach(((t,i)=>{var n;const o=null===(n=t.getBoxedValue)||void 0===n?void 0:n.call(t);o&&e(o,i,t.inverted)}))}},738600:(e,t,i)=>{i.d(t,{logger:()=>n});const n=(0,i(338619).getLogger)("Platform.Model.Watchlist")},306388:(e,t,i)=>{i.d(t,{initSymbolListService:()=>a});var n=i(564894),o=i(83871),s=i(764829);function a(){return Promise.all([Promise.all([i.e(56316),i.e(64592),i.e(75816),i.e(46445),i.e(93703),i.e(21356),i.e(62093),i.e(44524),i.e(53799),i.e(46489),i.e(74600),i.e(25480),i.e(88015),i.e(30614),i.e(82321),i.e(16388),i.e(5483),i.e(62526),i.e(83147),i.e(75560),i.e(1867),i.e(13520),i.e(90361),i.e(44692),i.e(1026)]).then(i.bind(i,999614)),Promise.all([i.e(56316),i.e(64592),i.e(75816),i.e(46445),i.e(93703),i.e(21356),i.e(62093),i.e(44524),i.e(53799),i.e(46489),i.e(74600),i.e(25480),i.e(88015),i.e(30614),i.e(82321),i.e(16388),i.e(5483),i.e(62526),i.e(83147),i.e(75560),i.e(1867),i.e(13520),i.e(90361),i.e(44692),i.e(1026)]).then(i.bind(i,38506)),Promise.all([i.e(56316),i.e(64592),i.e(75816),i.e(46445),i.e(93703),i.e(21356),i.e(62093),i.e(44524),i.e(53799),i.e(46489),i.e(74600),i.e(25480),i.e(88015),i.e(30614),i.e(82321),i.e(16388),i.e(5483),i.e(62526),i.e(83147),i.e(75560),i.e(1867),i.e(13520),i.e(90361),i.e(44692),i.e(1026)]).then(i.bind(i,850935)),Promise.all([i.e(56316),i.e(64592),i.e(75816),i.e(46445),i.e(93703),i.e(21356),i.e(62093),i.e(44524),i.e(53799),i.e(46489),i.e(74600),i.e(25480),i.e(88015),i.e(30614),i.e(82321),i.e(16388),i.e(5483),i.e(62526),i.e(83147),i.e(75560),i.e(1867),i.e(13520),i.e(90361),i.e(44692),i.e(1026)]).then(i.bind(i,244692)),s.enabled("widget")?null:Promise.all([i.e(56316),i.e(64592),i.e(75816),i.e(46445),i.e(93703),i.e(21356),i.e(62093),i.e(44524),i.e(53799),i.e(46489),i.e(74600),i.e(25480),i.e(88015),i.e(30614),i.e(82321),i.e(16388),i.e(5483),i.e(62526),i.e(83147),i.e(75560),i.e(1867),i.e(13520),i.e(90361),i.e(44692),i.e(1026)]).then(i.bind(i,216752))]).then((([e,t,i,s,a])=>{if((0,n.hasService)(o.SYMBOL_LIST_SERVICE))return(0,n.service)(o.SYMBOL_LIST_SERVICE);const{store:r,runner:l}=e.configureStore(),d=l.run(t.symbolListRepositorySaga);(0,n.registerService)(o.SYMBOL_LIST_SERVICE,{store:r,runner:l,actions:{addSymbols:s.addSymbolsThunk,initWidget:i.initWidget,saveListAs:s.saveListAsThunk,createNewWatchList:s.userCreateWatchlistThunk},task:d});const c=(0,n.service)(o.SYMBOL_LIST_SERVICE);return null!==a&&a.getCustomSymbolListSynchronizationServiceInstance(c),c}))}},643322:(e,t,i)=>{i.d(t,{accumulate:()=>r,combine:()=>a,combineWithFilteredUpdate:()=>s});var n=i(375397);function o(e,t,...i){let o=null
;const s=(...t)=>e(...t.map((e=>e.value())),null==o?void 0:o.value()),a=o=new n.WatchedValue(s(...i)),r=()=>{t(...i.map((e=>e.value())))&&a.setValue(s(...i))},l=i.map((e=>e.spawn()));for(const e of l)e.subscribe(r);return a.readonly().spawn((()=>{l.forEach((e=>e.destroy())),i.forEach((e=>e.release()))}))}function s(e,t,...i){return o(e,t,...i)}function a(e,...t){return o(e,(()=>!0),...t)}function r(e,t,i){var o;const s=(t,i)=>{const n=t.map((e=>e.value()));return e(n,i)},a=new n.WatchedValue(s(t.value(),null==i?void 0:i.value())),r=t.spawn();let l=[];const d=null!==(o=null==i?void 0:i.spawn())&&void 0!==o?o:new n.WatchedValue(void 0),c=()=>{a.setValue(s(l,d.value()))},u=e=>{l.forEach((e=>e.destroy())),l=e.map((e=>e.spawn())),l.forEach((e=>{e.subscribe(c)})),c()};u(r.value()),r.subscribe(u),d.subscribe(c);return a.readonly().spawn((()=>{l.forEach((e=>e.destroy())),r.destroy(),d.destroy(),t.release()}))}},394610:(e,t,i)=>{i.d(t,{ActionsProvider:()=>mi,createActionCopyPrice:()=>di,createActionToggleVisibilityDataSources:()=>hi,createActionTrade:()=>si,createChangeIntervalsVisibilitiesAction:()=>li,createLinesAction:()=>ci,createPasteAction:()=>ai,createSyncDrawingActions:()=>ui,createVisualOrderAction:()=>ri,defaultContextMenuOptions:()=>ni});var n=i(650151),o=i(338619),s=i(960521),a=i(124829),r=i(444372),l=i(764829),d=i(691371),c=i(109436),u=i(287741),h=i(434396),p=i(33052),m=i(716004),S=i(345848),y=i(995152),g=i(67326),b=i(427047),v=i(598631),f=i(84281),_=i(683833),w=i(130841),T=i(999872),I=i(284682),C=i(870408),A=i(622429),W=i(383557),L=i(938614),P=i(711496),k=i(597655),M=i(147117),N=i(599344),V=i(314802),F=i(638456),E=i(782014),D=i(354957),x=i(956250),R=i(845520),O=i(470316),B=i(104436),G=i(622161),$=i(519073),U=i(440075),H=i(898192),j=i(465836),q=i(487945),z=i(547777),Y=i(370407),K=i(419283),Z=i(378975),J=i(469805),Q=i(412788),X=i(793993),ee=i(218049),te=i(658843),ie=i(508918),ne=i(418638),oe=i(558634),se=i(971417),ae=i(306060),re=i(375308),le=i(314824);const de=(0,
o.getLogger)("Chart.ActionsProvider"),ce=new Y.TranslatedString("change visibility",r.t(null,void 0,i(201924))),ue=new Y.TranslatedString("pin to scale {label}",r.t(null,void 0,i(981566))),he=new Y.TranslatedString("pin to right scale",r.t(null,void 0,i(607495))),pe=new Y.TranslatedString("pin to left scale",r.t(null,void 0,i(778690))),me=new Y.TranslatedString("change earnings visibility",r.t(null,void 0,i(706819))),Se=new Y.TranslatedString("change dividends visibility",r.t(null,void 0,i(753929))),ye=new Y.TranslatedString("change splits visibility",r.t(null,void 0,i(347474))),ge=new Y.TranslatedString("change continuous contract switch visibility",r.t(null,void 0,i(818867))),be=new Y.TranslatedString("change futures contract expiration visibility",r.t(null,void 0,i(585532))),ve=new Y.TranslatedString("change latest news and Minds visibility",r.t(null,void 0,i(350243))),fe=new Y.TranslatedString("show all ideas",r.t(null,void 0,i(13336))),_e=new Y.TranslatedString("show ideas of followed users",r.t(null,void 0,i(791395))),we=new Y.TranslatedString("show my ideas only",r.t(null,void 0,i(757460))),Te=new Y.TranslatedString("change events visibility on chart",r.t(null,void 0,i(906119))),Ie=new Y.TranslatedString("add this symbol to entire layout",r.t(null,void 0,i(679290))),Ce=new Y.TranslatedString("add this indicator to entire layout",r.t(null,void 0,i(96677))),Ae=new Y.TranslatedString("add this strategy to entire layout",r.t(null,void 0,i(358156))),We=new Y.TranslatedString("add this financial metric to entire layout",r.t(null,void 0,i(267608))),Le=new Y.TranslatedString("apply drawing template",r.t(null,void 0,i(89720))),Pe=new Y.TranslatedString("lock objects",r.t(null,void 0,i(18942))),ke=new Y.TranslatedString("unlock objects",r.t(null,void 0,i(823230))),Me=new Y.TranslatedString("change visibility at current interval and above",r.t(null,void 0,i(545800))),Ne=new Y.TranslatedString("change visibility at current interval and below",r.t(null,void 0,i(175645))),Ve=new Y.TranslatedString("change visibility at current interval",r.t(null,void 0,i(584331))),Fe=new Y.TranslatedString("change visibility at all intervals",r.t(null,void 0,i(557916))),Ee=r.t(null,void 0,i(366823)),De=(0,
z.appendEllipsis)(r.t(null,void 0,i(800264))),xe=r.t(null,void 0,i(698334)),Re=r.t(null,void 0,i(327298)),Oe=r.t(null,void 0,i(703564)),Be=r.t(null,void 0,i(794559)),Ge=r.t(null,void 0,i(702165)),$e=r.t(null,void 0,i(16986)),Ue=r.t(null,void 0,i(312645)),He=r.t(null,void 0,i(544579)),je=r.t(null,void 0,i(429436)),qe=r.t(null,void 0,i(81054)),ze=r.t(null,void 0,i(32538)),Ye=r.t(null,void 0,i(172046)),Ke=r.t(null,void 0,i(590095)),Ze=r.t(null,void 0,i(14115)),Je=r.t(null,void 0,i(233110)),Qe=r.t(null,void 0,i(928280)),Xe=r.t(null,void 0,i(676150)),et=r.t(null,void 0,i(694210)),tt=r.t(null,void 0,i(960035)),it=r.t(null,void 0,i(210761)),nt=r.t(null,void 0,i(411254)),ot=r.t(null,void 0,i(635049)),st=r.t(null,void 0,i(319271)),at=r.t(null,void 0,i(715512)),rt=r.t(null,void 0,i(546545)),lt=r.t(null,void 0,i(752160)),dt=r.t(null,void 0,i(417293)),ct=r.t(null,void 0,i(21973)),ut=r.t(null,void 0,i(55481)),ht=r.t(null,void 0,i(171179)),pt=r.t(null,void 0,i(804077)),mt=r.t(null,void 0,i(754853)),St=r.t(null,void 0,i(720177)),yt=r.t(null,void 0,i(700494)),gt=r.t(null,void 0,i(960668)),bt=r.t(null,void 0,i(858026)),vt=r.t(null,void 0,i(156982)),ft=(0,z.appendEllipsis)(r.t(null,void 0,i(235088))),_t=(0,z.appendEllipsis)(r.t(null,void 0,i(702439))),wt=(0,z.appendEllipsis)(r.t(null,void 0,i(232514))),Tt=r.t(null,void 0,i(178358)),It=(0,z.appendEllipsis)(r.t(null,void 0,i(276266))),Ct=r.t(null,void 0,i(249680)),At=r.t(null,void 0,i(712537)),Wt=r.t(null,void 0,i(93553)),Lt=r.t(null,void 0,i(774975)),Pt=r.t(null,void 0,i(999894)),kt=r.t(null,void 0,i(205837)),Mt=r.t(null,void 0,i(537113)),Nt=r.t(null,void 0,i(629449)),Vt=r.t(null,void 0,i(350849)),Ft=r.t(null,void 0,i(833158)),Et=r.t(null,void 0,i(81465)),Dt=r.t(null,void 0,i(68112)),xt=r.t(null,void 0,i(555418)),Rt=r.t(null,void 0,i(510261)),Ot=r.t(null,void 0,i(644020)),Bt=(0,z.appendEllipsis)(r.t(null,void 0,i(232514))),Gt=r.t(null,void 0,i(897878)),$t=r.t(null,void 0,i(239010)),Ut=r.t(null,void 0,i(326090)),Ht=r.t(null,void 0,i(995754)),jt=r.t(null,void 0,i(535679)),qt=r.t(null,void 0,i(709140)),zt=r.t(null,void 0,i(846607)),Yt=r.t(null,void 0,i(639079)),Kt=(0,z.appendEllipsis)(r.t(null,void 0,i(975594))),Zt=(0,z.appendEllipsis)(r.t(null,void 0,i(288853))),Jt=r.t(null,void 0,i(735140)),Qt=r.t(null,void 0,i(163553)),Xt=r.t(null,void 0,i(792957)),ei=r.t(null,void 0,i(858764)),ti=r.t(null,void 0,i(910996)),ii=r.t(null,void 0,i(903061)),ni={general:!0,mainSeries:!0,mainSeriesTrade:!1,esdStudies:!0,studies:!0,fundamentals:!0,lineTools:!0,publishedCharts:!0,ordersAndPositions:!0,alerts:!0,chartEvents:!0,objectTree:!0,gotoLineTool:!1};function oi(e){return(0,q.isActingAsSymbolSource)(e)?e.symbolTitle(u.TitleDisplayTarget.StatusLine,!0,!0):(0,m.clean)(e.title(u.TitleDisplayTarget.StatusLine,!0),!0)}async function si(e,t,i){if(e.model().isInReplay().value())return null;const n=e.model().mainSeries(),o=n.symbolInfo();if(n.isConvertedToOtherCurrency()||n.isConvertedToOtherUnit()||(0,g.isNonTradableSymbolType)(null==o?void 0:o.type))return null;const s=await(async()=>{const t=(0,
f.tradingService)();if(null===t||0===(await t.brokersMetainfo()).length)return[];const n=e.model().mainSeries();let o;i&&(o=i.localY);try{const e=await(0,_.createTradeContext)(n,o);return await t.chartContextMenuActions(e,{hideNotExecutableAction:!0})}catch(e){return de.logError(e.message),[]}})();if(s.length>0){const e=()=>new Promise(((e,t)=>{0!==s.length?e({name:"trade",label:Ee,subItems:s,statName:"Trading"}):e({label:Ee,disabled:!0})}));return new d.Action({actionId:"Trading.TradeFromChart",options:{},optionsLoader:()=>(0,w.makeTimeLimited)(e(),5e3,"Action trade not received")})}return null}function ai(e,t){return!t.isEmpty()&&l.enabled("datasource_copypaste")?new le.ActionWithStandardIcon({actionId:"Chart.Clipboard.PasteSource",options:{label:Jt.trim(),shortcutHint:(0,O.humanReadableHash)(O.Modifiers.Mod+86),statName:"Paste",onExecute:()=>e.chartWidgetCollection().clipboard.uiRequestPaste(t)}}):null}function ri(e,t){const i=e.model(),n=i.availableZOrderOperations(t),o=[new le.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder.BringToFront",options:{label:dt,statName:"BringToFront",disabled:!n.bringToFrontEnabled,onExecute:()=>i.bringToFront(t)}}),new le.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder.SendToBack",options:{label:ct,statName:"SendToBack",disabled:!n.sendToBackEnabled,onExecute:()=>i.sendToBack(t)}}),new le.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder.BringForward",options:{label:ut,statName:"BringForward",disabled:!n.bringForwardEnabled,onExecute:()=>i.bringForward(t)}}),new le.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder.SendBackward",options:{label:ht,statName:"SendBackward",disabled:!n.sendBackwardEnabled,onExecute:()=>i.sendBackward(t)}})];return new le.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder",options:{label:pt,iconId:"Chart.VisualOrder",statName:"VisualOrder",subItems:o}})}function li(e,t){const i=e.model(),n=(e,n)=>{const o=Z.Interval.parse(i.mainSeries().interval()),s=(0,Q.getIntervalsVisibilitiesForMode)(o,e),a=[],r=[];t.forEach((e=>{const t=e.properties().intervalsVisibilities.childs();a.push(t.ticks),r.push(s.ticks),a.push(t.seconds),r.push(s.seconds),a.push(t.secondsFrom),r.push(s.secondsFrom),a.push(t.secondsTo),r.push(s.secondsTo),a.push(t.minutes),r.push(s.minutes),a.push(t.minutesFrom),r.push(s.minutesFrom),a.push(t.minutesTo),r.push(s.minutesTo),a.push(t.hours),r.push(s.hours),a.push(t.hoursFrom),r.push(s.hoursFrom),a.push(t.hoursTo),r.push(s.hoursTo),a.push(t.days),r.push(s.days),a.push(t.daysFrom),r.push(s.daysFrom),a.push(t.daysTo),r.push(s.daysTo),a.push(t.weeks),r.push(s.weeks),a.push(t.weeksFrom),r.push(s.weeksFrom),a.push(t.weeksTo),r.push(s.weeksTo),a.push(t.months),r.push(s.months),a.push(t.monthsFrom),r.push(s.monthsFrom),a.push(t.monthsTo),r.push(s.monthsTo),a.push(t.ranges),r.push(s.ranges)})),i.setProperties(a,r,n,(0,re.sourcesAffectState)(t))},o=[new le.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility.CurrentAndAbove",options:{label:St,statName:"currentAndAboveIntervals",
onExecute:()=>n(3,Me)}}),new le.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility.CurrentAndBelow",options:{label:yt,statName:"currentAndBelowIntervals",onExecute:()=>n(2,Ne)}}),new le.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility.Current",options:{label:gt,statName:"currentInterval",onExecute:()=>n(1,Ve)}}),new le.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility.All",options:{label:bt,statName:"allIntervals",onExecute:()=>n(0,Fe)}})];return new le.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility",options:{label:mt,statName:"IntervalsVisibility",subItems:o}})}function di(e,t){var i,n,o;const s=e.defaultPriceScale(),a=void 0!==t?s.coordinateToPrice(t,null!==(n=null===(i=e.mainDataSource())||void 0===i?void 0:i.firstValue())&&void 0!==n?n:0):e.model().mainSeries().lastValueData(4,!0,!0).price,r=null===(o=e.mainDataSource())||void 0===o?void 0:o.formatter();if(void 0===a||!r)return null;const l=r.format(a),d=r.format(a,{ignoreLocaleNumberFormat:!0});return new le.ActionWithStandardIcon({actionId:"Chart.Clipboard.CopyPrice",options:{label:`${Qt} ${l}`,statName:"CopyPrice",onExecute:()=>(0,X.getClipboard)().writeText(d)}})}function ci(e){const t=e.actions(),i=[t.showPriceLine];return i.push(t.showSeriesPrevCloseLine),i.push(t.showPrePostMarketPriceLine),i.push(t.showHighLowPriceLines),e.model().model().hasCustomSource("bidask")&&i.push(t.showBidAskLines),new le.ActionWithStandardIcon({actionId:"Chart.Lines",options:{label:vt,statName:"Lines",subItems:i}})}function ui(e,t){const i=[];{if(K.isToolCreatingNow.value())return i;const n=()=>t.some((e=>e.isSynchronizable()));{if(!window.user.is_pro)return i;if(!n())return i;let o=t[0].sharingMode().value();o=t.every((e=>e.sharingMode().value()===o))?o:null;const s=e.model();i.push(new d.Action({actionId:"Chart.LineTool.NoSync",options:{label:qt,statName:"NoSyncDrawing",checkable:!0,checked:0===o,onExecute:e=>{e.isChecked()&&s.shareLineTools(t,0)}}}),new d.Action({actionId:"Chart.LineTool.SyncInLayout",options:{label:zt,statName:"SyncDrawingInLayout",checkable:!0,checked:1===o,onExecute:e=>{e.isChecked()&&s.shareLineTools(t,1)}}}),new d.Action({actionId:"Chart.LineTool.SyncGlobally",options:{label:Yt,statName:"SyncDrawingGlobally",checkable:!0,checked:2===o,onExecute:e=>{e.isChecked()&&s.shareLineTools(t,2)}}}))}}return i}function hi(e,t){const i=t[0].properties().visible.value(),n=i?Re:xe,o=i?"Chart.Hide":"Chart.ShowObject",s=i?"Chart.SelectedObject.Hide":"Chart.SelectedObject.Show";return new le.ActionWithStandardIcon({actionId:s,options:{checkable:!0,statName:"ToggleVisibilitySelectedObject",label:n,iconId:o,onExecute:()=>{const n=e.model();n.withMacro(ce,(()=>{t.forEach((e=>{n.setProperty(e.properties().visible,!i,ce,J.lineToolsDoNotAffectChartInvalidation&&(0,j.isLineTool)(e))}))}))}}})}function pi(){var e,t;return!(0,F.onWidget)()&&!(0,V.isOnMobileAppPage)("any")&&!!(null===(t=null===(e=window.widgetbar)||void 0===e?void 0:e.layout)||void 0===t?void 0:t.canOpen())}class mi{constructor(e,t){
this._chartWidget=e,this._options=(0,a.merge)((0,a.clone)(ni),t||{})}async contextMenuActionsForSources(e,t,i,n,o){const s=e[0],a=this._options,r=[];if(s===this._chartWidget.model().mainSeries()&&a.mainSeries)r.push(...await this._contextMenuActionsForSeries(s,i));else if((0,h.isESDStudy)(s)&&a.esdStudies)r.push(...this._contextMenuActionsForESD());else if((0,h.isRollDatesStudy)(s))r.push(...this._contextMenuActionsForRollDates());else if((0,M.isFuturesContractExpiration)(s))r.push(...this._contextMenuActionsForFuturesContractExpiration());else if((0,N.isLatestUpdatesSource)(s))r.push(...this._contextMenuActionsForisLatestUpdates());else if((0,h.isStudy)(s)&&a.studies)r.push(...await this._contextMenuActionsForStudy(s,t,i));else if(s instanceof A.PublishedChartsTimeline&&a.publishedCharts)r.push(...this._contextMenuActionsForPublishedTimeline(s));else if((s instanceof T.LineToolOrder||s instanceof I.LineToolPosition)&&a.ordersAndPositions)r.push(...this._contextMenuActionsForTradingDrawings(s));else if((0,L.isAlertLabel)(s)&&s.alert().id().value()&&!s.alert().isNew()&&a.alerts)r.push(...await this._contextMenuActionsForAlertLabel(s.alert(),n));else if((0,j.isLineTool)(s)&&a.lineTools){const t=e.filter(j.isLineTool);r.push(...await this._contextMenuActionsForLineTool(t))}else(function(e){return e.name()===ie.ChartEventsSourceId.Value})(s)&&a.chartEvents&&r.push(...this._contextMenuActionsForChartEvents(s));return r.length&&(null==o?void 0:o.length)&&r.push(new d.Separator),r.push(...null!=o?o:[]),r}_isReadOnly(){return this._chartWidget.readOnly()}_createActionScale(e){const t=(0,n.ensureNotNull)(e.priceScale()),i=this._chartWidget.model().model(),o=(0,n.ensureNotNull)(i.paneForSource(e)),s=o.priceScalePosition(t),a=("left"===s?o.leftPriceScales():o.rightPriceScales()).indexOf(t),r=i.priceScaleSlotsCount().totallySlots<2?"dontneedname":"needname",l="overlay"===s?"":(0,c.getPriceAxisNameInfo)(s,a).label,d=Xe.format({label:l}),u={"left-needname":d,"left-dontneedname":tt,"right-needname":d,"right-dontneedname":it,"overlay-needname":et,"overlay-dontneedname":et}[s+"-"+r];return new le.ActionWithStandardIcon({actionId:"Chart.Source.ChangePriceScale",options:{label:u,iconId:"Chart.PriceScale",subItems:this._createActionScaleItems(e)}})}_createActionResetInputPoints(e){const t=e.metaInfo(),n=t.inputs.filter(ee.isTimeOrPriceNotHiddenInput);return 0===n.length?null:new le.ActionWithStandardIcon({actionId:"Chart.Source.ResetInputPoints",options:{label:Zt,onExecute:async()=>{let o;try{const s=e.properties().childs().inputs.state();for(const e of Object.keys(s))n.find((t=>t.id===e))||delete s[e];const a=new te.Property({inputs:s
}),r=await Promise.all([i.e(55073),i.e(75816),i.e(46445),i.e(93703),i.e(21356),i.e(62093),i.e(44524),i.e(2520),i.e(53953),i.e(49481),i.e(53799),i.e(62564),i.e(46489),i.e(74600),i.e(75826),i.e(82421),i.e(59258),i.e(25480),i.e(58985),i.e(67158),i.e(29800),i.e(65857),i.e(23141),i.e(36010),i.e(95083),i.e(29296),i.e(62234),i.e(72197),i.e(88015),i.e(22106),i.e(30422),i.e(16356),i.e(24125),i.e(97384),i.e(3782),i.e(49162),i.e(93523),i.e(98734),i.e(22602),i.e(30614),i.e(7001),i.e(94106),i.e(71329),i.e(63168),i.e(51488),i.e(75364),i.e(8222),i.e(79412),i.e(80089),i.e(25983),i.e(42513),i.e(16182),i.e(31085),i.e(82440),i.e(90303),i.e(89255),i.e(2573),i.e(12400),i.e(79184),i.e(76810),i.e(82321),i.e(87473),i.e(16388),i.e(83147),i.e(75560),i.e(66144),i.e(5428),i.e(59490),i.e(89178),i.e(26904),i.e(53030)]).then(i.bind(i,204564));o=(await r.selectInputValuesOnChart(this._chartWidget,n,a,t.shortDescription,t.inputs)).customSourceId,e.properties().mergeAndFire(a.state())}finally{void 0!==o&&this._chartWidget.model().model().removeCustomSource(o)}}}})}_createActionLayoutChartsSync(){return new E.LayoutChartsSyncContextMenuAction(this._chartWidget.linkingGroupIndex().readonly(),(e=>this._chartWidget.model().setLinkingGroupIndex(e)))}_createActionScaleDetach(e,t,i,o){const s=this._chartWidget.model().model(),a=(0,n.ensureNotNull)(s.paneForSource(e));if(!a.canCreateNewPriceScale())return null;const r=(0,n.ensureNotNull)(e.priceScale()),l=r.canDetachSource(e),d=a.priceScalePosition(r),u=l||d!==t;if(!u)return null;const h=s.priceScaleSlotsCount(),p={left:{labelled:je,sided:Je},right:{labelled:je,sided:Qe}},m="left"===t?a.leftPriceScales().length:a.rightPriceScales().length,S=h[t]>m?"labelled":"sided",y=(0,c.getPriceAxisNameInfo)(t,m).label,g=p[t][S].format({label:y});return new le.ActionWithStandardIcon({actionId:"Chart.Source.ChangePriceScale",options:{checkable:!1,disabled:!u,label:g,statName:o,payload:e,onExecute:i}})}_onDetachLeft(e){const t=e.getPayload(),i=this._chartWidget.model().model(),o=(0,n.ensureNotNull)(i.paneForSource(t));this._chartWidget.model().detachToLeft(t,o)}_onDetachRight(e){const t=e.getPayload(),i=this._chartWidget.model().model(),o=(0,n.ensureNotNull)(i.paneForSource(t));this._chartWidget.model().detachToRight(t,o)}_createActionScaleDetachLeft(e){return this._createActionScaleDetach(e,"left",this._onDetachLeft.bind(this),"ToggleScaleLeft")}_createActionScaleDetachRight(e){return this._createActionScaleDetach(e,"right",this._onDetachRight.bind(this),"ToggleScaleRight")}_onMoveToScale(e){const t=e.getPayload();if(t.datasource.priceScale()===t.priceScale)return;const i=this._chartWidget.model().model(),o=(0,n.ensureNotNull)(i.paneForSource(t.datasource));this._chartWidget.model().moveToScale(t.datasource,o,t.priceScale,t.undoText)}_createMoveToScaleAction(e,t,i,n){const o=e.priceScale()===t;return new le.ActionWithStandardIcon({actionId:"Chart.Source.MoveToOtherScale",options:{checkable:!0,checked:o,label:i,statName:"ToggleScale",payload:{datasource:e,priceScale:t,undoText:n},onExecute:this._onMoveToScale.bind(this)}})}
_onNoScale(e){const t=e.getPayload().datasource,i=this._chartWidget.model().model(),o=(0,n.ensureNotNull)(i.paneForSource(t));o.isOverlay(t)||this._chartWidget.model().detachNoScale(t,o)}_createActionNoScale(e){const t=this._chartWidget.model().model(),i=(0,n.ensureNotNull)(t.paneForSource(e)),o=i.actionNoScaleIsEnabled(e);return new le.ActionWithStandardIcon({actionId:"Chart.Source.MoveToNoScale",options:{checkable:!0,checked:i.isOverlay(e),label:nt,disabled:!o,statName:"ToggleNoScale",payload:{datasource:e},onExecute:this._onNoScale.bind(this)}})}_createActionScaleItems(e){const t=[],i=this._chartWidget.model().model(),o=(0,n.ensureNotNull)(i.paneForSource(e)),s=i.priceScaleSlotsCount().totallySlots>1,a=o.rightPriceScales(),r=o.leftPriceScales(),l=this._createActionScaleDetachRight(e),u=this._createActionScaleDetachLeft(e),h=a.length+r.length+(null===l?0:1)+(null===u?0:1)>2,p={right:{hidden:{checked:{labelled:Oe,sided:Be},unchecked:{labelled:Ge,sided:$e}},visible:{checked:{labelled:Ue,sided:He},unchecked:{labelled:je,sided:qe}}},left:{hidden:{checked:{labelled:Oe,sided:ze},unchecked:{labelled:Ge,sided:Ye}},visible:{checked:{labelled:Ue,sided:Ke},unchecked:{labelled:je,sided:Ze}}}},m={right:he,left:pe},S={left:o.visibleLeftPriceScales(),right:o.visibleRightPriceScales()},y=(t,i)=>{const n=("right"===i?a:r)[t],o=S[i].includes(n)?"visible":"hidden",l=e.priceScale()===n?"checked":"unchecked",d=s?"labelled":"sided",u=p[i],h=(0,c.getPriceAxisNameInfo)(i,t).label;return{actionText:u[o][l][d].format({label:h}),undoText:s?ue.format({label:h}):m[i]}};t.push(...a.map(((t,i)=>{const n=y(i,"right");return this._createMoveToScaleAction(e,t,n.actionText,n.undoText)}))),null!==l&&t.push(l);h&&(a.length>0||null!==l)&&t.push(new d.Separator);t.push(...r.map(((t,i)=>{const n=y(i,"left");return this._createMoveToScaleAction(e,t,n.actionText,n.undoText)}))),null!==u&&t.push(u);h&&(r.length>0||null!==u)&&t.push(new d.Separator);return t.push(this._createActionNoScale(e)),t}_createActionMergeUp(e){const t=this._chartWidget.model();return t.model().isMergeUpAvailableForSource(e)?new le.ActionWithStandardIcon({actionId:"Chart.Source.MergeUp",options:{label:st,statName:"MergeUp",onExecute:()=>t.mergeSourceUp(e)}}):null}_createActionUnmergeUp(e){const t=this._chartWidget.model();return t.model().isUnmergeAvailableForSource(e)?new le.ActionWithStandardIcon({actionId:"Chart.Source.UnmergeUp",options:{label:at,statName:"UnmergeUp",onExecute:()=>t.unmergeSourceUp(e)}}):null}_createActionMergeDown(e){const t=this._chartWidget.model();return t.model().isMergeDownAvailableForSource(e)?new le.ActionWithStandardIcon({actionId:"Chart.Source.MergeDown",options:{label:rt,statName:"MergeDown",onExecute:()=>t.mergeSourceDown(e)}}):null}_createActionUnmergeDown(e){const t=this._chartWidget.model();return t.model().isUnmergeAvailableForSource(e)?new le.ActionWithStandardIcon({actionId:"Chart.Source.UnmergeDown",options:{label:lt,statName:"UnmergeDown",onExecute:()=>t.unmergeSourceDown(e)}}):null}_mergeContentMenuItems(e){
return[this._createActionMergeUp(e),this._createActionUnmergeUp(e),this._createActionMergeDown(e),this._createActionUnmergeDown(e)].filter(a.notNull)}_createActionMove(e){const t=this._mergeContentMenuItems(e);return t.length>0?new le.ActionWithStandardIcon({actionId:"Chart.Source.MoveToPane",options:{label:ot,iconId:"Chart.Move",subItems:t}}):null}async _contextMenuActionsForSeries(e,t){var i;const o=[],s=this._chartWidget.model().model(),a=(0,n.ensureNotNull)(s.paneForSource(e)),r=this._chartWidget.actions(),c=t&&"localY"in t?t.localY:void 0;if(this._isReadOnly())o.push(hi(this._chartWidget,[e])),o.push(new d.Separator),o.push(this._createActionScale(e));else{if(e.alertCreationAvailable().value()){const t=(await(0,oe.getAlertsChartActionCreators)()).createAlert(this._chartWidget,{series:e,localY:c});null!==t&&o.push(t)}if(o.push(this._createActionAddChildStudy(e)),this._options.fundamentals){const t=this._createActionAddFundamentals(e);null!==t&&o.push(t)}if(this._options.mainSeriesTrade){const e=await si(this._chartWidget);null!==e&&o.push(e)}o.length>0&&!(o[o.length-1]instanceof d.Separator)&&o.push(new d.Separator),l.enabled("symbol_info")&&o.push(r.showSymbolInfoDialog),pi()&&o.push(this._chartWidget.actions().showDataWindow);const t=s.mainSeries().symbolInfo();if(r.showFinancials&&null!==t&&(0,P.hasFinancialsByTypespecs)(t.type,t.typespecs)&&o.push(r.showFinancials),o.length>0&&!(o[o.length-1]instanceof d.Separator)&&o.push(new d.Separator),!a.isEmpty()&&l.enabled("datasource_copypaste")){const e=di(a,c),t=ai(this._chartWidget,a);(e||t)&&(e&&o.push(e),t&&o.push(t),o.push(new d.Separator))}o.push(ri(this._chartWidget,[e]));const n=this._createActionMove(e);null!==n&&o.push(n),o.push(this._createActionScale(e)),this._chartWidget.isMultipleLayout().value()&&(this._chartWidget.chartWidgetCollection().lock.symbol.value()||this._chartWidget.chartWidgetCollection().lock.interval.value())&&o.push(this._createActionLayoutChartsSync()),o.push(hi(this._chartWidget,[e])),o.push(new d.Separator);Boolean(null===(i=window.widgetbar)||void 0===i?void 0:i.widget("watchlist"))&&r.addToWatchlist&&o.push(r.addToWatchlist),l.enabled("text_notes")&&o.push(r.addToTextNotes),o[o.length-1]instanceof d.Separator||o.push(new d.Separator),l.enabled("show_chart_property_page")&&!this._chartWidget.onWidget()&&o.push(r.mainSeriesPropertiesAction),o[o.length-1]instanceof d.Separator&&o.pop()}return o}_createActionAddChildStudy(e){const t=this._chartWidget.model().model();return new le.ActionWithStandardIcon({actionId:"Chart.Indicator.ApplyChildIndicator",options:{label:ft.format({studyTitle:oi(e)}),iconId:"Chart.ApplyIndicator",statName:"ApplyIndicator",onExecute:()=>{const i=this._chartWidget.showIndicators((0,h.isStudy)(e)?[e]:[]);if(i&&(0,h.isStudy)(e)){const e=()=>{(0,S.trackEvent)("SOS","Apply SOS","Apply by RC menu")},n=t.studyInserted();n.subscribe(this,e),i.visible().subscribe((t=>{t||n.unsubscribe(this,e)}),{once:!0})}}}})}_createActionAddFundamentals(e){{const t=e.symbolInfo();if(null!==t&&"forex"!==t.type&&!(0,
$.hasCryptoTypespec)(t.typespecs||[]))return new le.ActionWithStandardIcon({actionId:"Chart.Indicator.ApplyFinancials",options:{label:_t.format({instrumentName:oi(e)}),iconId:"Chart.Financials",statName:"ApplyFundamental",onExecute:()=>{this._chartWidget.showFundamentals(e!==this._chartWidget.model().mainSeries()?e:void 0)}}})}return null}_createActionShowSymbolInfoDialog(e,t){const i=this._chartWidget.model().model();return new le.ActionWithStandardIcon({actionId:"Chart.Dialogs.ShowSymbolInfo",options:{label:Kt,iconId:"Chart.SymbolInfo",checkable:!1,statName:"SymbolInfo",onExecute:()=>{const n={symbolInfo:e.symbolInfo(),unitDescription:e=>e?t.description(e):"",dateFormatter:i.dateFormatter()};(0,U.showSymbolInfoDialog)(n)}}})}_createActionShowProperties(e){return new le.ActionWithStandardIcon({actionId:"Chart.Indicator.ShowSettingsDialog",options:{label:wt,iconId:"Settings",statName:"EditSelectedObject",onExecute:()=>this._chartWidget.showSourceProperties(e)}})}async _contextMenuActionsForStudy(e,t,n){const o=this._chartWidget.model(),s=t!==o.paneForSource(e),a=this._chartWidget.actions(),c=n&&"localY"in n?n.localY:void 0,u=[];if(!e.userEditEnabled())return u;if(this._chartWidget.readOnly())u.push(hi(this._chartWidget,[e])),u.push(new d.Separator),(0,b.isNonSeriesStudy)(e)||u.push(this._createActionScale(e));else{if(e.alertCreationAvailable().value()){const t=(await(0,oe.getAlertsChartActionCreators)()).createAlert(this._chartWidget,{series:e,localY:c});null!==t&&u.push(t)}if(l.enabled("study_on_study")&&e.canHaveChildren()&&u.push(this._createActionAddChildStudy(e)),(0,h.isCompareOrOverlayStudy)(e)&&this._options.fundamentals){const t=this._createActionAddFundamentals(e);null!==t&&u.push(t)}const t=this._createApplyToEntireLayoutCommand(e);null!==t&&u.push(t);const n=this._createAddIndicatorToFavoritesCommand(e);if(n&&u.push(n),u.length>0&&!(u[u.length-1]instanceof d.Separator)&&u.push(new d.Separator),l.enabled("symbol_info")&&(0,h.isCompareOrOverlayStudy)(e)&&null!==e.symbolInfo()&&(u.push(this._createActionShowSymbolInfoDialog(e,this._chartWidget.model().model().availableUnits())),u.push(new d.Separator)),s||u.push(ri(this._chartWidget,[e])),u.push(li(this._chartWidget,[e])),!(0,b.isNonSeriesStudy)(e)&&!s){const t=this._createActionMove(e);null!==t&&u.push(t),u.push(this._createActionScale(e))}u.push(new d.Separator);const p=e.metaInfo();if(!(0,F.onWidget)()&&e.pineSourceCodeModel){const t=await e.pineSourceCodeModel();if(t){const[n,s]=await Promise.all([(0,ne.showAboutTheStudyHandler)(t),t.requestUpdateInformation()]);if(n){const t=(0,h.isFundamentalStudy)(e)?(0,z.appendEllipsis)(r.t(null,void 0,i(746135))):p.pine?(0,z.appendEllipsis)(r.t(null,void 0,i(657486))):(0,z.appendEllipsis)(r.t(null,void 0,i(717274)));u.push(new d.Action({actionId:"Chart.Indicator.About",options:{label:t,statName:"OpenSelectedObjectAbout",onExecute:n}}))}if(s&&s.lastVersion.isGreater(ae.Version.parse(s.currentVersion))){const n=(0,h.isFundamentalStudy)(e)?(0,z.appendEllipsis)(r.t(null,void 0,i(136339))):p.pine?(0,
z.appendEllipsis)(r.t(null,void 0,i(342524))):(0,z.appendEllipsis)(r.t(null,void 0,i(798451)));u.push(new d.Action({actionId:"Chart.Indicator.About",options:{label:n,statName:"UpdateStudyVersion",onExecute:async()=>{t.updateToVersion(o,s.lastVersion)}}}))}}}if(!(0,h.isFundamentalStudy)(e)&&p.pine&&a.viewSourceCode){const{scriptIdPart:t,pine:{version:i}}=p;u.push(a.viewSourceCode);const n=this._createActionResetInputPoints(e);n&&u.push(n),u.push(new d.Separator),a.viewSourceCode.update({disabled:!1}),(0,C.isAuthToGetPineSourceCode)(t,i).then((e=>{e||a.viewSourceCode.update({disabled:!0})})).catch((e=>{de.logError("Failed isAuthToGetPineSourceCode, reason: "+e)}))}if(window.is_authenticated&&(0,x.isUserStudyWithLogs)(e)&&(u.push(new d.Action({actionId:"Chart.Indicator.PineLogs",options:{label:r.t(null,void 0,i(69056)),statName:"PineLogs",onExecute:()=>{(0,R.openPineLogsInRightPanel)(e)}}})),u.push(new d.Separator)),e.copiable()){const t=new le.ActionWithStandardIcon({actionId:"Chart.Clipboard.CopySource",options:{label:Ct,shortcutHint:(0,O.humanReadableHash)(O.Modifiers.Mod+67),statName:"Copy",onExecute:()=>{this._chartWidget.chartWidgetCollection().clipboard.uiRequestCopy([e])}}});u.push(t)}u.push(hi(this._chartWidget,[e])),u.push(a.studyRemove);const m=!this._chartWidget.onWidget()&&this._options.objectTree&&a.paneObjectTree,S=pi();(m||S)&&(u.push(new d.Separator),m&&u.push(a.paneObjectTree),S&&u.push(this._chartWidget.actions().showDataWindow)),u.push(new d.Separator),l.enabled("property_pages")&&new v.MetaInfoHelper(p).hasUserEditableOptions()&&u.push(this._createActionShowProperties(e)),u[u.length-1]instanceof d.Separator&&u.pop()}return u}_createLineToolTemplateAction(e){{const t=this._chartWidget.model(),n=i=>{t.applyLineToolTemplate(e,i,Le)};return new d.Action({actionId:"Chart.LineTool.Templates",options:{},optionsLoader:async()=>{const{LinetoolTemplatesList:o}=await Promise.all([i.e(68541),i.e(5483),i.e(74087),i.e(3177)]).then(i.bind(i,670019)),s=new o(e.toolname,n),a=[];if(l.enabled("drawing_templates")){const t=new le.ActionWithStandardIcon({actionId:"Chart.LineTool.Templates.SaveAs",options:{label:It,statName:"SaveAs",onExecute:()=>{s.showSaveDialog((t=>{const i=JSON.stringify(e.template());s.saveTemplate(t,i)}))}}});a.push(t)}const r=new le.ActionWithStandardIcon({actionId:"Chart.LineTool.Templates.ApplyDefaults",options:{label:Tt,statName:"ApplyDefault",onExecute:()=>{t.restorePropertiesForSource(e),window.lineToolPropertiesToolbar.refresh()}}});return a.push(r),new Promise((e=>{s.templatesLoaded().then((()=>{var e;const t=null!==(e=s.getData())&&void 0!==e?e:[];t.length>0&&a.push(new d.Separator),t.forEach(((e,t)=>{const i=new le.ActionWithStandardIcon({actionId:"Chart.LineTool.Templates.Apply",options:{label:e,statName:"ApplyTemplate",onExecute:()=>s.loadTemplate(e),toolbox:{type:B.ToolboxType.Delete,action:()=>{s.deleteAction(e)}},showToolboxOnHover:!0}});a.push(i)}))}),(e=>{de.logWarn(e)})).then((()=>{e({label:Wt,statName:"Template",subItems:a})}))}))}})}}_createActionToggleLockLineTools(e){
const t=e[0].properties().frozen.value(),i=t?Pt:kt;return new le.ActionWithStandardIcon({actionId:"Chart.SelectedObject.ToggleLocked",options:{label:i,statName:"ToggleLockSelectedObject",checkable:!0,iconId:t?"Chart.UnlockObject":"Chart.LockObject",onExecute:()=>{if(1===e.length)this._chartWidget.toggleLockSelectedObject();else{const i=t?ke:Pe,n=this._chartWidget.model();n.withMacro(i,(()=>{e.forEach((e=>{n.setProperty(e.properties().frozen,!t,i,J.lineToolsDoNotAffectChartInvalidation)}))}))}}}})}async _contextMenuActionsForLineTool(e){const t=[],i=this._chartWidget.actions(),o=this._chartWidget.model().model(),a=()=>{t.push(ri(this._chartWidget,e))},r=()=>{t.push(li(this._chartWidget,e))},c=()=>{const i=e.filter((e=>e.cloneable()));if(i.length>0){const e=new le.ActionWithStandardIcon({actionId:"Chart.LineTool.Clone",options:{label:At,iconId:"Chart.Clone",shortcutHint:(0,O.humanReadableModifiers)(O.Modifiers.Mod)+"Drag",statName:"Clone",onExecute:()=>this._chartWidget.model().cloneLineTools(i,!1)},id:"Clone"});t.push(e)}return!!i.length},h=()=>{const i=e.filter((e=>e.copiable()));if(i.length>0){const e=new d.Action({actionId:"Chart.Clipboard.CopyLineTools",options:{label:Ct,shortcutHint:(0,O.humanReadableHash)(O.Modifiers.Mod+67),statName:"Copy",onExecute:()=>this._chartWidget.chartWidgetCollection().clipboard.uiRequestCopy(i)},id:"Copy"});t.push(e)}return!!i.length},p=()=>{const i=ui(this._chartWidget,e);return t.push(...i),i.length>0},m=async e=>{if(this._chartWidget.model().isInReplay().value())return;const i=e.getOrderTemplate();if(null===i)return;const a=(0,f.tradingService)();if(null!==a){const e=a.activeBroker();if(e&&1===e.connectionStatus()&&e.metainfo().configFlags.supportLimitOrders){const r=o.mainSeries(),{symbol:l}=await a.getActualSymbol(r.proSymbol()),{tradable:c}=await e.isTradable(l);if(c){const{qty:{step:o}}=await e.symbolInfo(l);i.symbol=l,i.qty=function(e,t){return(0,s.Big)(e).div(t).round(void 0,0).mul(t).toNumber()}(i.qty,o),t.push(new d.Separator),t.push(function(e){const t=(0,n.ensureNotNull)((0,f.tradingService)());return new le.ActionWithStandardIcon({actionId:"Chart.LineTool.CreateLimitOrderFromState",options:{label:De,statName:"CreateLimitOrder",onExecute:()=>{t.trackEvent("Chart Context Menu","RiskRewardCreateLimitOrder"),(0,n.ensureNotNull)(t.brokerCommandsUI()).placeOrder(e)}}})}(i))}}else null===e&&(t.push(new d.Separator),t.push((0,n.ensureNotNull)(function(){const e=(0,n.ensureNotNull)((0,f.tradingService)());return new d.Action({actionId:"Trading.ShowSelectBrokerPanel",options:{label:De,statName:"ShowSelectBrokerNotification",onExecute:()=>{var t;(0,k.isMobileTradingAvailable)()&&!(null===(t=window.TradingView.bottomWidgetBar)||void 0===t?void 0:t.isVisible().value())?e.toggleTradingPanelPopup():e.toggleTradingWidget(),e.onNeedSelectBroker.fire()}}})}())))}},S=e=>{const i=new le.ActionWithStandardIcon({actionId:"Chart.ScrollToLineTool",options:{label:Lt.format({lineToolName:e.title(u.TitleDisplayTarget.StatusLine)}),statName:"GoToLineTool",checkable:!1,
onExecute:async()=>this._chartWidget.model().scrollToLineTool(e)}});t.push(i)},y=e=>{const t=this._chartWidget.model().model().lineToolsGroupModel(),i=e.map((e=>t.groupForLineTool(e)));return new Set(i).size<=1};if(1===e.length){const n=e[0];if(this._chartWidget.readOnly())t.push(hi(this._chartWidget,[n]));else if(n.userEditEnabled()){if(D.alertsAvailable&&!this._chartWidget.onWidget()){const e=await(0,oe.getAlertsChartActionCreators)();if(n.hasAlert&&n.hasAlert().value())t.push(e.editAlertOnLineDataSource(n)),t.push(new d.Separator);else if(n.canHasAlert()&&n.alertCreationAvailable().value()){const i=e.createAlert(this._chartWidget,{drawing:n});null!==i&&(t.push(i),t.push(new d.Separator))}}{const e=this._createLineToolTemplateAction(n);null!==e&&t.push(e)}a(),r(),this._options.objectTree&&i.paneObjectTree&&t.push(i.paneObjectTree),await m(n),t.push(new d.Separator);let e=c();e=h()||e,e&&t.push(new d.Separator),e=p(),e&&t.push(new d.Separator),t.push(this._createActionToggleLockLineTools([n])),t.push(hi(this._chartWidget,[n])),t.push(i.lineRemove),n.points().length>0&&this._options.gotoLineTool&&(t.push(new d.Separator),S(n));const o=await this._chartWidget.propertiesDefinitionsForSource(n);if(l.enabled("property_pages")&&null!==o&&(t.push(new d.Separator),t.push(i.format)),n.additionalActions){t.push(new d.Separator);const e=n.additionalActions(this._chartWidget.model());t.push(...e)}}}else this._options.objectTree&&i.paneObjectTree&&t.push(i.paneObjectTree),y(e)&&a(),r(),t.length>0&&t.push(new d.Separator),c(),h(),p(),t.push(new d.Separator),t.push(this._createActionToggleLockLineTools(e)),t.push(hi(this._chartWidget,e)),t.push(i.lineRemove),l.enabled("property_pages")&&(t.push(new d.Separator),t.push(i.format));return t}_createEarningsShow(){const e=this._chartWidget.model().mainSeries().properties().childs().esdShowEarnings;return new d.Action({actionId:"Chart.ToggleVisibility.Earnings",options:{label:Mt,checkable:!0,checked:e.value(),name:"ToggleShowEarnings",statName:"ToggleShowEarnings",onExecute:t=>this._chartWidget.model().setProperty(e,t.isChecked(),me)}})}_createDividendsShow(){const e=this._chartWidget.model().mainSeries().properties().childs().esdShowDividends;return new d.Action({actionId:"Chart.ToggleVisibility.Dividends",options:{label:Nt,checkable:!0,checked:e.value(),name:"ToggleShowDividends",statName:"ToggleShowDividends",onExecute:t=>this._chartWidget.model().setProperty(e,t.isChecked(),Se)}})}_createSplitsShow(){const e=this._chartWidget.model().mainSeries().properties().childs().esdShowSplits;return new d.Action({actionId:"Chart.ToggleVisibility.Splits",options:{checkable:!0,label:Vt,checked:e.value(),name:"ToggleShowSplits",statName:"ToggleShowSplits",onExecute:t=>this._chartWidget.model().setProperty(e,t.isChecked(),ye)}})}_contextMenuActionsForESD(){const e=[];return this._chartWidget.readOnly()||e.push((0,n.ensureNotNull)(this._createDividendsShow()),(0,n.ensureNotNull)(this._createSplitsShow()),(0,n.ensureNotNull)(this._createEarningsShow())),e}_contextMenuActionsForRollDates(){const e=[]
;if(!this._chartWidget.readOnly()){const t=this._chartWidget.model().mainSeries().properties().childs().showContinuousContractSwitches;e.push(new d.Action({actionId:"Chart.ToggleVisibility.ContinuousContractSwitch",options:{label:Ft,checkable:!0,checked:t.value(),name:"ToggleShowContractSwitches",statName:"ToggleShowContractSwitches",onExecute:e=>this._chartWidget.model().setProperty(t,e.isChecked(),ge)}}))}return e}_contextMenuActionsForFuturesContractExpiration(){const e=[];if(!this._chartWidget.readOnly()){const t=this._chartWidget.model().mainSeries().properties().childs().showFuturesContractExpiration;e.push(new d.Action({actionId:"Chart.ToggleVisibility.ContractExpiration",options:{label:Et,checkable:!0,checked:t.value(),name:"ToggleShowFuturesContractExpirations",statName:"ToggleShowFuturesContractExpirations",onExecute:e=>this._chartWidget.model().setProperty(t,e.isChecked(),be)}}))}return e}_contextMenuActionsForisLatestUpdates(){const e=[];if(!this._chartWidget.readOnly()){const t=this._chartWidget.model().mainSeries().properties().childs().showLastNews;e.push(new d.Action({actionId:"Chart.ToggleVisibility.LatestNewsAndMinds",options:{label:Dt,checkable:!0,checked:t.value(),name:"ToggleShowLatestUpdates",statName:"ToggleShowLatestUpdates",onExecute:e=>this._chartWidget.model().setProperty(t,e.isChecked(),ve)}}))}return e}_contextMenuActionsForPublishedTimeline(e){const t=this._chartWidget.actions(),i=[];if(i.push(t.lineHide),window.is_authenticated){const t=e.properties().childs().filter,n=new d.Action({actionId:"Chart.ShowAllIdeas",options:{checked:t.value()===W.PublishedChartsFilter.None,checkable:!0,label:xt,name:"ToggleAllIdeas",statName:"ToggleAllIdeas",onExecute:()=>this._chartWidget.model().setProperty(t,W.PublishedChartsFilter.None,fe)}}),o=new d.Action({actionId:"Chart.ShowIdeasOfFollowedUsers",options:{checked:t.value()===W.PublishedChartsFilter.Following,checkable:!0,label:Rt,name:"ToggleIdeasOfPeopleAndUser",statName:"ToggleIdeasOfPeopleAndUser",onExecute:()=>this._chartWidget.model().setProperty(t,W.PublishedChartsFilter.Following,_e)}}),s=new d.Action({actionId:"Chart.ShowMyIdeasOnly",options:{checked:t.value()===W.PublishedChartsFilter.Private,checkable:!0,label:Ot,name:"ToggleUserIdeas",statName:"ToggleUserIdeas",onExecute:()=>this._chartWidget.model().setProperty(t,W.PublishedChartsFilter.Private,we)}});i.push(new d.Separator,n,o,s)}return i}_contextMenuActionsForTradingDrawings(e){return e.contextMenuItems()}async _contextMenuActionsForAlertLabel(e,t){if(D.alertsAvailable&&!this._chartWidget.onWidget()){const{getAlertLabelContextMenuActions:n}=await i.e(46745).then(i.bind(i,697395)),o=(0,y.getSettingsProperty)().childs().line.childs().visible,s=`chart_alert_context_menu_${null!=t?t:"line"}`,a="chart_alert";return n({alert:e,chartWidget:this._chartWidget,labelExtendProperty:o,analytics:{actionLabel:s,actionSource:a}})}return[]}_contextMenuActionsForChartEvents(e){const t=[];if(l.enabled("property_pages")){const e=new d.Action({actionId:"Chart.Dialogs.ShowGeneralSettings.EventsAndAlertsTab",
options:{label:Bt,statName:"Format",onExecute:()=>this._chartWidget.showGeneralChartProperties(p.TabNames.eventsAndAlerts)}});t.push(e)}const i=new d.Action({actionId:"Chart.ToggleVisibility.EconomicEvents",options:{label:Gt,name:"HideEvents",statName:"HideEvents",onExecute:()=>this._chartWidget.model().setProperty(e.properties().childs().visible,!1,Te)}});return t.push(i),t}_createApplyToEntireLayoutCommand(e){if(!this._chartWidget.chartWidgetCollection().applyIndicatorsToAllChartsAvailable())return null;const t=this._chartWidget.model().model();if(e.parentSources().length>0)return null;const i=(0,n.ensureNotNull)(t.paneForSource(e)),o=t.paneForSource(t.mainSeries())===i,s=e instanceof G.StudyCompare&&e.priceScale()===t.mainSeries().priceScale()&&(0,n.ensureNotNull)(e.priceScale()).isPercentage(),a=o?void 0:t.panes().indexOf(i);let r=Ut,l=Ce,c="AddStudyToEntireLayout";return(0,q.isActingAsSymbolSource)(e)&&(r=$t,l=Ie,c="AddSymbolToEntireLayout"),(0,h.isStudyStrategy)(e)&&(r=Ht,l=Ae,c="AddStrategyToEntireLayout"),(0,h.isFundamentalStudy)(e)&&(r=jt,l=We,c="AddFundamentalToEntireLayout"),new d.Action({actionId:"Chart.AddIndicatorToAllCharts",options:{label:r,statName:c,onExecute:()=>{const i=(0,n.ensureNotNull)((0,H.clipboardDataForSources)(t.id(),[e])),r=this._chartWidget.chartWidgetCollection(),d={isOnMainPane:o,asCompare:s,paneIndex:a};r.applyIndicatorToAllCharts(this._chartWidget,i,d,l)}},id:"applyStudyToEntireLayout"})}_createAddIndicatorToFavoritesCommand(e){const t=e.metaInfo();let n;if((0,F.onWidget)()||(0,h.isCompareOrOverlayStudy)(e))return null;if((0,h.isFundamentalStudy)(e)){const e=(0,se.extractPineId)(t.fullId);if(!e)return null;n=()=>i.e(69790).then(i.bind(i,257015)).then((({FavoriteFundamentals:t})=>{const i=t.getInstance();return{label:i.isFav(e)?ii:ti,onExecute:()=>i.toggleFavorite(e)}}))}else{const e=t.scriptIdPart||t.id;if(!e)return null;n=()=>i.e(69790).then(i.bind(i,725897)).then((({FavoriteScriptsModel:t})=>{const i=t.getInstance();return{label:i.isFav(e)?ei:Xt,onExecute:()=>i.toggleFavorite(e)}}))}return new d.Action({actionId:"Chart.Indicator.AddFavorites",id:"addIndicatorToFavorites",optionsLoader:n,options:{statName:"AddIndicatorToFavorites"}})}}},676962:(e,t,i)=>{i.r(t),i.d(t,{addSymbolDialogHasOpenedKey:()=>a,showAddSymbolDialog:()=>r});var n=i(457965),o=i(305514),s=i(251954);const a="addSymbolDialogHasOpenedKey";function r(e){(0,n.runOrSigninWithFeature)((()=>{(0,o.showWatchListsDialog)({addSymbols:e,onOpen:l})}),{feature:"watchList",source:"add symbol to watchlist"})}function l(){s.emit(a)}},553220:(e,t,i)=>{i.d(t,{DateFormatter:()=>s});var n=i(339709),o=i(246125);class s{constructor(e="yyyy-MM-dd",t=!1){this._dateFormatFunc=t?(0,o.getDateFormatWithWeekday)(e):o.dateFormatFunctions[e]}format(e){return n.customFormatters&&n.customFormatters.dateFormatter?n.customFormatters.dateFormatter.format(e):this._dateFormatFunc(e,!1)}formatLocal(e){
return n.customFormatters.dateFormatter?n.customFormatters.dateFormatter.formatLocal?n.customFormatters.dateFormatter.formatLocal(e):n.customFormatters.dateFormatter.format(e):this._dateFormatFunc(e,!0)}parse(e){if(""===e)return{res:!1};let t=e;return n.customFormatters&&n.customFormatters.dateFormatter&&!n.customFormatters.dateFormatter.parse&&console.warn("You need to provide a `parse` function as part of `dateFormatter`"),n.customFormatters&&n.customFormatters.dateFormatter&&n.customFormatters.dateFormatter.parse&&(t=String(n.customFormatters.dateFormatter.parse(e))),{res:!0,value:t}}}},287741:(e,t,i)=>{var n;i.d(t,{TitleDisplayTarget:()=>n}),function(e){e[e.DataWindow=2]="DataWindow",e[e.StatusLine=8]="StatusLine"}(n||(n={}))},378975:(e,t,i)=>{i.d(t,{Interval:()=>c,ResolutionKind:()=>s,SpecialResolutionKind:()=>a,isHour:()=>h});const n=/^(\d*)([TSHDWMR])$/,o=/^(\d+)$/;var s,a;!function(e){e.Ticks="ticks",e.Seconds="seconds",e.Minutes="minutes",e.Days="days",e.Weeks="weeks",e.Months="months",e.Range="range",e.Invalid="invalid"}(s||(s={})),function(e){e.Hours="hours"}(a||(a={}));const r={};r[s.Ticks]=1e3,r[s.Seconds]=1e3,r[s.Minutes]=60*r[s.Seconds],r[s.Days]=1440*r[s.Minutes],r[s.Weeks]=7*r[s.Days];const l={T:s.Ticks,S:s.Seconds,D:s.Days,W:s.Weeks,M:s.Months,R:s.Range},d=new Set([s.Ticks,s.Seconds,s.Minutes]);class c{constructor(e,t){this._kind=s.Invalid,this._multiplier=0,e!==s.Invalid&&t>0&&(this._kind=e,this._multiplier=t)}kind(){return this._kind}multiplier(){return this._multiplier}isValid(){return this.kind()!==s.Invalid&&this.multiplier()>0}isDWM(){return this.isValid()&&!this.isRange()&&!this.isIntraday()&&!this.isTicks()}isIntraday(){const e=d.has(this.kind());return this.isValid()&&e}isSeconds(){return this.kind()===s.Seconds}isMinutes(){return this.kind()===s.Minutes}isMinuteHours(){return this.kind()===s.Minutes&&h(this.multiplier())}isDays(){return this.kind()===s.Days}isWeeks(){return this.kind()===s.Weeks}isMonths(){return this.kind()===s.Months}isRange(){return this.kind()===s.Range}isTicks(){return this.kind()===s.Ticks}is1Tick(){return this.isTicks()&&1===this.multiplier()}isTimeBased(){return!this.isRange()}letter(){return this.isValid()&&this.kind()!==s.Minutes?this.kind()[0].toUpperCase():""}value(){return this.isValid()?this.kind()===s.Minutes?this.multiplier()+"":this.multiplier()+this.letter():""}isEqualTo(e){if(!(e instanceof c))throw new Error("Argument is not an Interval");return!(!this.isValid()||!e.isValid())&&(this.kind()===e.kind()&&this.multiplier()===e.multiplier())}inMilliseconds(e=Date.now()){if(!this.isValid()||this.isRange())return NaN;if(this.isMonths()){const t=new Date(e);t.setUTCMonth(t.getUTCMonth()+(this.multiplier()||1));return+t-e}const t=this.multiplier();return r[this.kind()]*t}static isEqual(e,t){return e===t||c.parse(e).isEqualTo(c.parse(t))}static parseExt(e){e=(e+"").toUpperCase().split(",")[0];let t=n.exec(e);return null!==t?"H"===t[2]?{interval:new c(s.Minutes,60*u(t[1])),guiResolutionKind:a.Hours}:{interval:new c(l[t[2]],u(t[1])),guiResolutionKind:l[t[2]]
}:(t=o.exec(e),null!==t?{interval:new c(s.Minutes,u(t[1])),guiResolutionKind:s.Minutes}:{interval:new c(s.Invalid,0),guiResolutionKind:s.Invalid})}static parse(e){return c.parseExt(e).interval}static kind(e){return c.parse(e).kind()}static isValid(e){return c.parse(e).isValid()}static isDWM(e){return c.parse(e).isDWM()}static isIntraday(e){return c.parse(e).isIntraday()}static isSeconds(e){return c.parse(e).isSeconds()}static isMinutes(e){return c.parse(e).isMinutes()}static isMinuteHours(e){return c.parse(e).isMinuteHours()}static isDays(e){return c.parse(e).isDays()}static isWeeks(e){return c.parse(e).isWeeks()}static isMonths(e){return c.parse(e).isMonths()}static isRange(e){return c.parse(e).isRange()}static isTicks(e){return c.parse(e).isTicks()}static isTimeBased(e){return c.parse(e).isTimeBased()}static normalize(e){const t=c.parse(e);return t.isValid()?t.value():null}}function u(e){return 0===e.length?1:parseInt(e,10)}function h(e){return e>=60&&!(e%60)}},465836:(e,t,i)=>{var n;i.r(t),i.d(t,{cloneLineTool:()=>R,createLineTool:()=>W,createLineToolProperties:()=>P,createStudyLineToolProperties:()=>k,getNewToolProperties:()=>w,initAllLineToolsFromContent:()=>A,initLineTool:()=>C,isEditableTextLineTool:()=>D,isLineTool:()=>N,isStudyLineTool:()=>V,isTrading:()=>F,lineToolByLinkKey:()=>O,prepareLineToolPropertiesByOwnerSource:()=>L,setNewToolProperties:()=>f,supportsPhantomMode:()=>M,tryFindStudyLineToolNameByStudyId:()=>x,unsetNewToolProperties:()=>_});var o=i(598279),s=i(650151),a=i(86441),r=i(412788),l=i(609466),d=i(817464),c=i(954877),u=i(926799),h=i(975179),p=i(627620),m=i(850723),S=i(850986);const y={},g={};Object.assign(y,n||(n=i.t(c,2)));const b=["LineToolRegressionTrend","LineToolAnchoredVWAP","LineToolFixedRangeVolumeProfile","LineToolVbPFixed"];b.push("LineToolAnchoredVolumeProfile");let v=null;function f(e,t,i){return null!==v&&v.tool===e&&v.toolData===t||(v={properties:P(e,void 0,i),tool:e,toolData:t}),v.properties}function _(){v=null}function w(e){return null!==v&&v.tool===e?v.properties:null}const T=new Map([["LineToolPriceNote",async()=>(await Promise.all([i.e(21955),i.e(77916),i.e(22093),i.e(96501),i.e(90108),i.e(380)]).then(i.bind(i,875943))).LineToolPriceNote],["LineToolNote",async()=>(await Promise.all([i.e(10601),i.e(77916),i.e(22093),i.e(96501),i.e(90108),i.e(92384),i.e(23248)]).then(i.bind(i,834447))).LineToolNote],["LineToolFibSpiral",async()=>(await Promise.all([i.e(82835),i.e(77916),i.e(22093),i.e(96501),i.e(90108),i.e(78090)]).then(i.bind(i,45244))).LineToolFibSpiral],["LineToolCircleLines",async()=>(await Promise.all([i.e(39850),i.e(77916),i.e(22093),i.e(96501),i.e(90108),i.e(59445)]).then(i.bind(i,763389))).LineToolCyclicLines]]);let I=new Map;async function C(e){if((0,p.isStudyLineToolName)(e)){if(await(0,m.studyMetaInfoRepository)().findAllJavaStudies(),g[e])return;const t=(0,s.ensureDefined)(I.get(e));return void(g[e]=await t())}if(y[e])return;if(!y.hasOwnProperty(e))return;const t=(0,s.ensureDefined)(T.get(e));y[e]=await t()}async function A(e){if(!e)return;const t=new Set
;("charts"in e?e.charts:[e]).forEach((e=>{e.panes.forEach((e=>{e.sources.forEach((e=>{(0,p.isLineToolName)(e.type)&&t.add(e.type)}))}))})),await Promise.all(Array.from(t).map((e=>C(e))))}function W(e,t,i,n,o,a){let r;if((0,s.assert)((0,p.isLineToolName)(e),"Unknown line tool: "+e),o||i||(i=w(e)||void 0),b.includes(e)){r=new((0,s.ensureDefined)(g[e]))(t,i,(0,s.ensureDefined)(n),o,a)}else{r=new((0,s.ensureDefined)(y[e]))(t,i,o,a)}return r.toolname=e,_(),r}function L(e,t){const i=(0,s.ensureNotNull)(t.symbolSource()),n=i.symbolInfo(),o=n?(0,h.extractLineToolSymbolFromSymbolInfo)(n,i.symbol()):i.symbol();e.childs().symbol.setValue(o),i.model().currencyConversionEnabled()&&i.isConvertedToOtherCurrency()&&e.childs().currencyId.setValue(i.currency()),i.model().unitConversionEnabled()&&i.isConvertedToOtherUnit()&&e.childs().unitId.setValue(i.unit()),e.childs().symbolStateVersion.setValue(2),e.childs().zOrderVersion.setValue(2)}function P(e,t,i,n){if((0,s.assert)((0,p.isLineToolName)(e),`${e} should be name of the line tool`),b.includes(e)){return(0,s.ensureDefined)(g[e]).createProperties(t)}return(0,s.ensureDefined)(y[e]).createProperties(t,n)}function k(e,t,i,n,o){if((0,s.assert)((0,p.isStudyLineToolName)(e),`${e} should be name of the study line tool`),b.includes(e)){return(0,s.ensureDefined)(g[e]).createPropertiesFromStudyMetaInfoAndState(t,i,n,o)}throw new Error(`Property creation is not implemented for study line tool ${e}`)}function M(e){(0,s.assert)((0,p.isLineToolName)(e),`${e} should be name of the line tool`);const t=(n||(n=i.t(c,2)))[e];return void 0!==t&&Boolean(t.supportPhantomMode)}function N(e){return e instanceof d.LineDataSource}function V(e){return e instanceof l.StudyLineDataSource}function F(e){return e instanceof u.LineToolTrading}T.set("LineToolNoteAbsolute",(async()=>(await Promise.all([i.e(10601),i.e(77916),i.e(22093),i.e(96501),i.e(90108),i.e(92384),i.e(23248)]).then(i.bind(i,834447))).LineToolNoteAbsolute)),I=new Map([["LineToolAnchoredVWAP",async()=>(await Promise.all([i.e(92013),i.e(10640),i.e(55500)]).then(i.bind(i,427322))).LineToolAnchoredVWAP],["LineToolRegressionTrend",async()=>(await i.e(99748).then(i.bind(i,741274))).LineToolRegressionTrend],["LineToolVbPFixed",async()=>(await Promise.all([i.e(10640),i.e(95695)]).then(i.bind(i,876947))).LineToolVbPFixed],["LineToolFixedRangeVolumeProfile",async()=>(await Promise.all([i.e(10640),i.e(95695)]).then(i.bind(i,573486))).LineToolFixedRangeVolumeProfile],["LineToolAnchoredVolumeProfile",async()=>(await Promise.all([i.e(10640),i.e(95695)]).then(i.bind(i,176592))).LineToolAnchoredVolumeProfile]]);const E=["editableTextStyle","editableText","editableTextProperties"];function D(e){return(0,o.default)(e)&&E.every((t=>t in e))}function x(e){let t=null;return e===S.lineToolsStudyIds.LineToolRegressionTrend?t="LineToolRegressionTrend":e===S.lineToolsStudyIds.LineToolVbPFixed?t="LineToolVbPFixed":e===S.lineToolsStudyIds.LineToolFixedRangeVolumeProfile&&(t="LineToolFixedRangeVolumeProfile"),t}function R(e,t,i,n){const o=t.toolname,l=t.properties().state()
;l.intervalsVisibilities=(0,r.mergeIntervalVisibilitiesDefaults)(null==l?void 0:l.intervalsVisibilities);const d=P(t.toolname,l);d.childs().visible.setValue(!0);const c=(0,s.ensureNotNull)(t.ownerSource()),u=W(o,e,d);void 0!==n&&u.setId(n),u.setOwnerSource(c),u.toolname=o;const h=u.clonePositionOffset();if(t.isFixed()){const e=(0,s.ensureDefined)(t.fixedPoint()),n=i?e.add(new a.Point(h.xCoordOffset,h.yCoordOffset)):e;u.addFixedPoint(n)}const p=t.normalizedPoints(),m=i?function(e,t,i){const n=(0,s.ensureNotNull)(t.priceScale()),o=(0,s.ensureNotNull)(t.firstValue());return e.map((e=>{const t=e.price,s=n.priceToCoordinate(t,o)+i.yCoordOffset,a=n.coordinateToPrice(s,o);return{time_t:e.time_t,price:a,offset:e.offset+i.barOffset}}))}(p,c,h):p,S=t.points();return u.restorePoints(m,S),u.cloneData&&u.cloneData(t),u.recalculateStateByData&&u.recalculateStateByData(),u}function O(e,t){var i;return null!==(i=e.dataSources().find((e=>N(e)&&e.linkKey().value()===t)))&&void 0!==i?i:null}},195121:(e,t,i)=>{i.d(t,{magnetEnabled:()=>m,magnetMode:()=>S,setIsMagnetEnabled:()=>y,setMagnetMode:()=>g});var n=i(868594),o=i(375397),s=i(205899),a=i(419283),r=i(627620),l=i(895366);const d=new o.WatchedValue(!1),c=new o.WatchedValue(s.MagnetMode.WeakMagnet),u=(0,l.modifierPressed)(),h=(0,l.shiftPressed)();function p(){const e=u.value();if(h.value()&&(a.isToolEditingNow.value()||a.isToolCreatingNow.value()))return void d.setValue(!1);let t,i;if(a.activePointSelectionMode.value()===a.SelectPointMode.Replay)t=i=!1;else{const n=a.tool.value(),o=a.isStudyEditingNow.value()||a.activePointSelectionMode.value()===a.SelectPointMode.Study;t=e&&((0,r.isLineToolName)(n)||a.isToolEditingNow.value()||(0,a.toolIsMeasure)(n)||o),i=(0,a.properties)().childs().magnet.value()}c.setValue(!i&&t?s.MagnetMode.StrongMagnet:(0,a.properties)().childs().magnetMode.value()),d.setValue(t?!i:i)}function m(){return d}function S(){return c}function y(e){(0,n.allowSavingDefaults)(!0),(0,a.properties)().childs().magnet.setValue(e),(0,n.allowSavingDefaults)(!1)}function g(e){(0,n.allowSavingDefaults)(!0),(0,a.properties)().childs().magnetMode.setValue(e),(0,a.properties)().childs().magnet.setValue(!0),(0,n.allowSavingDefaults)(!1)}(0,a.runOnDrawingStateReady)((()=>{(0,a.properties)().childs().magnet.subscribe(null,p),(0,a.properties)().childs().magnetMode.subscribe(null,p),u.subscribe(p),h.subscribe(p),a.tool.subscribe(p),a.isToolEditingNow.subscribe(p),p()}))},745397:(e,t,i)=>{i.d(t,{generateSplitTitleForGui:()=>u,generateTitleForGui:()=>h});var n=i(448874),o=i(650151),s=i(444372),a=i(151848),r=i(255866);function l(e,t){return(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toString()||""}function d(e){var t;switch(e.style){case"ATR":return s.t(null,{context:"input",replace:{atrValue:String(e.atrLength)}},i(550873));case"PercentageLTP":return s.t(null,{context:"input",replace:{percentageLTPValue:String(e.percentageLTP)}},i(428037));case"Traditional":return s.t(null,{context:"input"},i(640566));default:return null!==(t=e.style)&&void 0!==t?t:""}}const c=(0,n.default)((e=>{
const[,t="",i="",n="",o=""]=Array.from(e.match(/^(\d\d)(\d\d)-(\d\d)(\d\d)/)||[]);return`${t}:${i}−${n}:${o}`}));function u(e){const t="QUANDL"===(e=e||{}).exchange,n={title:"",description:"",interval:"",exchange:"",provider:"",chartStyle:"",sessionDescription:"",priceSource:""};let u="";if(e.description&&t)if(2===e.description.split("/").length)u=e.description.split("/")[1];else{e.description.split("'").filter((e=>e.length)).forEach((e=>{let t=[];t=e&&("/"===e[0]||/\d+\/\(?/.test(e))?[e]:e.split("/").filter((e=>e.length)),u+=t[2===t.length?1:0]}))}else u=e.description?e.description:e.symbol;if(e.ticker?(n.title=e.ticker,n.description=p(u)):n.title=p(u),e.interval&&(n.interval=(0,a.translatedIntervalString)(e.interval)),t&&e.description){const t=/[\w_]+\/[\w_]+/.exec(e.description);t&&t[0]?n.provider=p(t[0].split("/")[0]):n.provider=p(e.description.split("/")[0])}return e.exchange&&(n.exchange=p(e.exchange)),n.chartStyle=p(function(e){const t=e.inputs;switch(e.style){case 4:const n=d(t),a=(0,o.ensureDefined)(e.boxSize||t.boxSize);return`${s.t(null,void 0,i(188130))} [${n}, ${l(a,4)}]`;case 7:return`${s.t(null,void 0,i(469576))} [${t.lb}]`;case 5:const u=d(t),h=e.reversalAmount||t.reversalAmount,p=void 0!==h?`, ${l(h,8)}`:"";return`${s.t(null,void 0,i(383490))} [${u}${p}]`;case 6:const m=d(t),S=e.boxSize||t.boxSize;return`${s.t(null,void 0,i(560963))} [${m}, ${l((0,o.ensureDefined)(S),8)}, ${t.reversalAmount}]`;case 18:return`${s.t(null,void 0,i(604545))} [${t.periodsNum}, ${t.period}, ${t.blockSize}, ${t.ticksPerRow}]`;case 17:{const e="Auto"===t.rowSize?`ATR ${t.atrLength}`:`Manual ${t.ticksPerRow}`;let n;switch((0,o.ensureDefined)(t.type)){case r.VolumeFootprintTypeValues.BuyAndSell:n=s.t(null,void 0,i(388016));break;case r.VolumeFootprintTypeValues.Delta:n=s.t(null,void 0,i(571073));break;case r.VolumeFootprintTypeValues.Total:n=s.t(null,void 0,i(408007))}return`${s.t(null,void 0,i(292763))} [${e}, ${n}]`}case 20:{const e=s.t((0,o.ensureDefined)(t.profilesSessions),{context:"input"},i(932856)),n=s.t((0,o.ensureDefined)(t.volume),{context:"input"},i(932856)),a=s.t((0,o.ensureDefined)(t.rowsLayout),{context:"input"},i(932856));let r="";return"All"!==t.profilesSessions&&(r=`${c((0,o.ensureDefined)(t.customSession))}, ${t.customSessionTZ}, `),`${s.t(null,void 0,i(226590))} [${e}, ${r}${n}, ${t.vaVolume}, ${a}, ${t.rows}]`}}return 11===e.style?s.t(null,void 0,i(855169)):8===e.style?s.t(null,void 0,i(863876)):""}(e)),e.sessionDescription&&(n.sessionDescription=p(e.sessionDescription)),void 0!==e.priceSource&&(n.priceSource=p(e.priceSource)),n}function h(e){const t=u(e);return(e.ticker?t.description:t.title)+(t.interval?", "+t.interval:"")+function(e,t=", "){return(e.provider?`${t}${e.provider}`:"")+(e.exchange?`${t}${e.exchange}`:"")+(e.chartStyle?`${t}${e.chartStyle}`:"")+(e.branding?`${t}${e.branding}`:"")+(e.sessionDescription?`${t}${e.sessionDescription}`:"")+(e.priceSource?`${t}${e.priceSource}`:"")}(t)}function p(e){return e.replace(/'/g,"")}},434396:(e,t,i)=>{i.r(t),i.d(t,{createStudy:()=>w,
hasConfirmInputs:()=>A,hasPendingStudiesModuleLoading:()=>_,isCompareOrOverlayStudy:()=>v,isESDStudy:()=>y,isFundamentalStudy:()=>S,isOverlayStudy:()=>b,isRollDatesStudy:()=>g,isStudy:()=>u,isStudyStrategy:()=>p,isStudyStub:()=>m,isSymbolicStudy:()=>L,studyColorRotationMode:()=>T,useSameColorRotationComparator:()=>C});var n=i(650151),o=(i(764829),i(637761)),s=i(872842),a=i(296842),r=i(879938),l=i(903424);const d=(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,689052)).then((e=>e.Study))));(0,r.addStudyInfoToMap)("Study",d),(0,r.addStudyInfoToMap)("study_PivotPointsStandard",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,332764)).then((e=>e.study_PivotPointsStandard))))),(0,r.addStudyInfoToMap)("study_Overlay",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.t.bind(i,120269,19)).then((e=>e.study_Overlay))),"sexyColors")),(0,r.addStudyInfoToMap)("study_Compare",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,622161)).then((e=>e.StudyCompare))),"sexyColors")),(0,r.addStudyInfoToMap)("study_Volume",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,242829)).then((e=>e.VolumeStudy))))),(0,r.addStudyInfoToMap)("study_VbPVisible",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,759332)).then((e=>e.VbPVisibleWrapper))))),(0,r.addStudyInfoToMap)("study_ScriptWithDataOffset",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.t.bind(i,888849,19)).then((e=>e.study_ScriptWithDataOffset))))),(0,r.addStudyInfoToMap)("study_Earnings",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,266298)).then((e=>e.study_ESD$TV_EARNINGS))))),(0,r.addStudyInfoToMap)("study_Splits",(0,
r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,266298)).then((e=>e.study_ESD$TV_SPLITS))))),(0,r.addStudyInfoToMap)("study_Dividends",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,266298)).then((e=>e.study_ESD$TV_DIVIDENDS))))),(0,r.addStudyInfoToMap)("study_BarSetContinuousRollDates",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,517802)).then((e=>e.study_ESD$TV_ROLLDATES))))),(0,r.addStudyInfoToMap)(a.fundamentalsPrefix,(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,962608)).then((e=>e.Fundamental))),"loop",((e,t)=>(0,a.isFundamentalStudyMetaInfo)(t)))),(0,r.addStudyInfoToMap)("study_ElliottWave",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.t.bind(i,213079,19)).then((e=>e.study_ElliottWave))))),(0,r.addStudyInfoToMap)("study_LinearRegression",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,496327)).then((e=>e.LinearRegressionStudy))))),(0,r.addStudyInfoToMap)("study_PivotPointsHighLow",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.t.bind(i,65246,19)).then((e=>e.study_PivotPointsHighLow))))),(0,r.addStudyInfoToMap)("study_VbPSessions",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,2781)).then((e=>e.SessionVolumeStudy))))),(0,r.addStudyInfoToMap)("study_VbPPeriodic",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,759332)).then((e=>e.VolumeProfileWithPriceRangeStudy))))),(0,r.addStudyInfoToMap)("study_VbPSessionsRoughDetailed",(0,
r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,990627)).then((e=>e.SessionVolume2Study))))),(0,r.addStudyInfoToMap)("study_ZigZag",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.t.bind(i,550599,19)).then((e=>e.study_ZigZag))))),(0,r.addStudyInfoToMap)("study_VbPAutoAnchored",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,759332)).then((e=>e.VolumeProfileBaseStudy))))),(0,r.addStudyInfoToMap)("study_TPOPeriodic",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,997253)).then((e=>e.TpoPeriodicStudy))))),(0,r.addStudyInfoToMap)("study_TPOSessions",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,563371)).then((e=>e.TpoSessionsStudy))))),(0,r.addStudyInfoToMap)("study_VolumeFootprint",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,586043)).then((e=>e.VolumeFootprintStudy))))),(0,r.addStudyInfoToMap)("StudyStrategy",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,395104)).then((e=>e.StudyStrategy))))),(0,r.addStudyInfoToMap)("ReplayStudyStrategy",(0,r.createStudyInfo)((()=>Promise.all([i.e(32856),i.e(85785),i.e(32887),i.e(24951),i.e(49645),i.e(92013),i.e(88509),i.e(77916),i.e(89052),i.e(10640),i.e(87),i.e(87465),i.e(6927),i.e(21852),i.e(46896),i.e(57539)]).then(i.bind(i,912291)).then((e=>e.ReplayStudyStrategy)))));const c=["getStudyName","guiPlotName","isLinkedToSeries"];function u(e){return c.every((t=>t in e))}const h=["strategyOrdersPaneView","ordersData","reportData"];function p(e){return u(e)&&h.every((t=>t in e))}function m(e){return e instanceof s.StudyStub}function S(e){return u(e)&&(0,a.isFundamentalStudyMetaInfo)(e.metaInfo())}function y(e){return e instanceof l.DataSource&&("ESD$TV_EARNINGS"===e.id()||"ESD$TV_SPLITS"===e.id()||"ESD$TV_DIVIDENDS"===e.id())}function g(e){return e instanceof l.DataSource&&"ESD$TV_ROLLDATES"===e.id()}function b(e){
return u(e)&&"Overlay@tv-basicstudies"===e.metaInfo().id}function v(e){return b(e)||u(e)&&"Compare@tv-basicstudies"===e.metaInfo().id}let f=0;function _(){return f>0}async function w(e,t,i,s,l,c){var u;let h;const p=2===c;if(o.StudyMetaInfo.isReplayStrategy(s)&&(h=(0,r.getStudyInfoByName)("ReplayStudyStrategy")),o.StudyMetaInfo.isScriptStrategy(s)&&(h=(0,r.getStudyInfoByName)("StudyStrategy")),!h){const e=(0,a.studyNameByMetaInfo)(s);h=null!==(u=(0,r.getStudyInfoByName)(null!=e?e:"Study"))&&void 0!==u?u:d}h.studyConstructor||(f+=1,h.studyConstructor=await(0,n.ensureDefined)(h.studyConstructorAsyncGetter)(),f-=1);const m=new((0,n.ensureDefined)(null==h?void 0:h.studyConstructor))(e,t,i,s,p);return void 0!==l&&m.setId(l),m}function T(e){const t=(0,a.studyNameByMetaInfo)(e),i=(0,r.getStudyInfoByName)(t);return i?i.colorRotationMode:void 0===e.pine||o.StudyMetaInfo.isStandardPine(e.id)?1!==e.plots.length?"shift":"loop":null}function I(e,t){return e.id===t.id&&(n=t,((i=e).pine?i.pine.version:void 0)===(n.pine?n.pine.version:void 0));var i,n}function C(e){const t=(0,a.studyNameByMetaInfo)(e),i=(0,r.getStudyInfoByName)(t);if(i){const e=i.colorRotationComparator;if(void 0!==e)return e}return I}function A(e){return(null!=e?e:[]).some((e=>e.confirm))}const W=["Overlay@tv-basicstudies","CorrelationCoefficient@tv-basicstudies","Correlation Coeff@tv-basicstudies","Spread@tv-basicstudies","Ratio@tv-basicstudies"];function L(e){return W.includes(e.id)}},850723:(e,t,i)=>{i.d(t,{emptyPineId:()=>m,isStudyDescriptor:()=>S,studyMetaInfoRepository:()=>v});var n=i(895171),o=i(444372),s=i(650151),a=i(637761),r=i(874546),l=i(306060),d=i(500323),c=i(870408),u=i(338619),h=i(955273);const p=(0,u.getLogger)("Chart.Studies.StudyMetaInfoRepository",{color:"#606"}),m="";function S(e){return"object"==typeof e&&null!==e&&"type"in e&&("java"===e.type&&"studyId"in e||"pine"===e.type&&"pineId"in e)}class y{constructor(e){this._isReady=!1,this._studyVersioning=null,this._rawStudiesMetaInfo=[],this._rawStudiesMetaInfoDeferredPromise=null,this._javaStudiesMetaInfo=[],this._pineMetaInfoCache=[],this._studiesMigrations=[],this._chartApi=e}async requestMetaInfo(){if(null===this._rawStudiesMetaInfoDeferredPromise){this._rawStudiesMetaInfoDeferredPromise=(0,h.createDeferredPromise)();const e=await this._chartApi.requestMetadata(),t=e.params[1].metainfo.slice();{const i=e.params[1].migrations.slice();this._processSiteMetaInfo(t,i)}this._studyVersioning=new d.StudyVersioning(this._javaStudiesMetaInfo,this._studiesMigrations),this._requestFinished(),this._rawStudiesMetaInfoDeferredPromise.resolve(this._rawStudiesMetaInfo)}return this._rawStudiesMetaInfoDeferredPromise.promise}async findById(e){this._isReady||await this.requestMetaInfo();const t=this._findStudyMetaInfo(e);return null!==t?Promise.resolve(t):"pine"===e.type?this._compilePine(e):Promise.reject(`unexpected study id=${e.studyId} with type=${e.type}`)}findByIdSync(e){return this._findStudyMetaInfo(e)}isReady(){return this._isReady}async findAllJavaStudies(){
return this._isReady||await this.requestMetaInfo(),this._javaStudiesMetaInfo}studyVersioning(){return(0,s.ensureNotNull)(this._studyVersioning)}getInternalMetaInfoArray(){return this._javaStudiesMetaInfo}addPineMetaInfo(e){return b(this._pineMetaInfoCache,e)}async getLatestMetaInfoForPineStudy(e,t){const i=await(0,c.requestUserScripts)();let n;if(i){const o=i.find((t=>t.scriptIdPart===e));if(o){const e=l.Version.parse(t),i=l.Version.parse(o.version);e.isLess(i)&&(n=o.version)}}if(void 0!==n){const t={type:"pine",pineId:e,pineVersion:n};return this.findById(t)}return null}_processMigrations(e){this._studiesMigrations=[];for(let t=0;e&&t<e.length;t++)this._studiesMigrations.push(e[t])}_processSiteMetaInfo(e,t){for(const t of e)d.StudyVersioning.verifyInputsMaxValue(t),g(t);this._rawStudiesMetaInfo=e,this._processMigrations(t);for(const e of this._rawStudiesMetaInfo)b(this._javaStudiesMetaInfo,e);a.StudyMetaInfo.overrideDefaults(this._javaStudiesMetaInfo)}_processLibraryMetaInfo(e){}_requestFinished(){this._isReady=!0}_findStudyMetaInfo(e){return"java"===e.type?((0,s.assert)(0!==this._javaStudiesMetaInfo.length,"Java studies metainfo should be define here"),this._javaStudiesMetaInfo.find((t=>t.id===e.studyId))||null):this._pineMetaInfoCache.find((t=>t.scriptIdPart===e.pineId&&(void 0===e.pineVersion||(0,s.ensureDefined)(t.pine).version===e.pineVersion)))||null}_compilePine(e){p.logNormal(`Compiling ${e.pineId} script`);const t=(0,c.translateScriptAsync2)(e.pineId,e.pineVersion||"last").then((({metaInfo:t})=>(p.logNormal(`Compiling ${e.pineId} is successful`),this.addPineMetaInfo((0,s.ensureDefined)(t)))));return t.catch((()=>{p.logNormal(`Compiling ${e.pineId} is failed`)})),t}}function g(e){e.description_localized=o.t(e.description,{context:"study"},i(783477))}function b(e,t){const i=new a.StudyMetaInfo(t).state();(0,r.migrateMetaInfoAndPropState)(i);const n=new a.StudyMetaInfo(i);let o=!0;const s=e.findIndex((e=>e.id===n.id));if(-1===s)e.push(n);else{const t=e[s],i=void 0!==t.pine?l.Version.parse(t.pine.version):null,a=void 0!==n.pine?l.Version.parse(n.pine.version):null;null===a||null===i||a.isGreaterOrEqual(i)?(t.removeDefaults(),e[s]=n):o=!1}return o&&n.createDefaults(),n}const v=(0,n.default)((()=>new y(window.ChartApiInstance)))},454576:(e,t,i)=>{var n;i.d(t,{ConnectionStatus:()=>n}),function(e){e[e.Closed=0]="Closed",e[e.Connecting=1]="Connecting",e[e.Open=2]="Open"}(n||(n={}))},459423:(e,t,i)=>{i.d(t,{setSupportPortalProblemsHost:()=>o,supportPortalProblemsHost:()=>n});let n="";function o(e){n=e}},257288:(e,t,i)=>{i.d(t,{getTranslatedSymbolDescription:()=>s});var n=i(444372);function o(e){const t=`#${e}-symbol-description`,o=n.t(t,void 0,i(956316));return o===t?null:o}function s(e){if(void 0!==e.pro_name){const t=o(e.pro_name);if(null!==t)return t;if(void 0!==e.short_name){const t=o(e.short_name);if(null!==t)return t}}
return"en"!==e.language&&void 0!==e.local_description&&e.language===window.language||"en"===e.language&&void 0!==e.local_description&&e.language===window.language?e.local_description:e.description||""}}}]);
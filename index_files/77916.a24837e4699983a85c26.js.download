"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[77916],{281090:(t,e,n)=>{n.d(e,{drawSelection:()=>r,getSymbolCoordinatesInfo:()=>a});var i=n(881025),o=n(631088);function a(t){const{symbolPosition:e,textWidth:n,textByLines:a,lineHeight:r,font:s,textAlign:l,lineSpacing:d=0}=t;let h=-d,u=0;const c=(0,i.isRtl)(),g=r+d;let f=0,x=0,_="";for(let t=0;t<a.length;t++){let i=e-f;const{wrappedLinePart:r,wrappedLineEnd:d,hidden:p,text:b}=a[t],w=t<a.length-1?a[t+1]:null;if(p||(_=b),w&&i>b.length){f+=b.length+(r&&!d?0:1),p||(h+=g);continue}p&&(h-=g);const P=r&&!d&&b.length===i&&w&&!w.hidden;if(p&&(_+="â€¯",i=_.length),"center"===l)if(P)u=n/2;else{const t=(0,o.measureText)(_,s).width,e=(0,o.measureText)(_.slice(0,i),s).width,a=n/2;u=c?a+t/2-e:a-t/2+e}else if("right"===l&&!c||"left"===l&&c||"end"===l)if(P)u=n;else{const t=(0,o.measureText)(_.slice(i),s).width;u=c?t:n-t}else if(P)u=0;else{const t=(0,o.measureText)(_.slice(0,i),s).width;u=c?n-t:t}P?(x=t+1,h+=g):x=t;break}return{x:u,y:h,lineNumber:x}}function r(t,e,n){const{lines:a,selectionStart:r,selectionEnd:l,left:d,right:h,color:u,font:c,lineHeight:g,lineSpacing:f=0}=n;t.save();const x=(d+h)/2,_=g+f,p=(0,i.isRtl)();t.fillStyle=u;const{horizontalPixelRatio:b,verticalPixelRatio:w}=e;if(r.lineNumber===l.lineNumber){const e=Math.round(r.x*b),n=Math.round(r.y*w),i=Math.round(l.x*b);t.fillRect(Math.min(e,i),n,Math.abs(e-i),Math.round(_*w))}else{const e=(0,o.measureText)(" ",c).width;let n=0;for(let i=r.lineNumber;i<=l.lineNumber;i+=1){const o=i===r.lineNumber,u=i===l.lineNumber,g=a[i];if(g.hidden)continue;const f=s(g.text,c);let P,m,S=!1;"center"===t.textAlign?(P=o?r.x:p?x+f/2:x-f/2,m=u?l.x:p?x-f/2:x+f/2):"right"===t.textAlign||p&&"start"===t.textAlign||!p&&"end"===t.textAlign?(P=o?r.x:h-f,m=u?l.x:h,S=!0):(P=o?r.x:d,m=u?l.x:d+f);let v=Math.min(P,m),T=Math.max(P,m);u||g.wrappedLinePart&&!g.wrappedLineEnd||(S?v-=e:T+=e);const y=Math.round(v*b),R=Math.round(T*b),L=Math.round((r.y+n*_)*w),M=Math.round((r.y+(n+1)*_)*w);t.fillRect(y,L,R-y,M-L),n+=1}}t.restore()}function s(t,e){return(0,o.measureText)(t,e).width}},961970:(t,e,n)=>{n.d(e,{BitmapCoordinatesPaneRenderer:()=>o});var i=n(743068);class o{draw(t,e){new i.CanvasRenderingTarget2D(t,e.mediaSize,e.bitmapSize).useBitmapCoordinateSpace((t=>this._drawImpl(t)))}drawBackground(t,e){new i.CanvasRenderingTarget2D(t,e.mediaSize,e.bitmapSize).useBitmapCoordinateSpace((t=>this._drawBackgroundImpl(t)))}_drawBackgroundImpl(t){}}},982949:(t,e,n)=>{n.d(e,{CompositeRenderer:()=>i});class i{constructor(){this._renderers=[],this._globalAlpha=1}setGlobalAlpha(t){this._globalAlpha=t}append(t){this._renderers.push(t)}insert(t,e){this._renderers.splice(e,0,t)}clear(){this._renderers.length=0}isEmpty(){return 0===this._renderers.length}draw(t,e){for(let n=0;n<this._renderers.length;n++)t.save(),t.globalAlpha=this._globalAlpha,this._renderers[n].draw(t,e),t.restore()}drawBackground(t,e){t.save(),t.globalAlpha=this._globalAlpha;for(let n=0;n<this._renderers.length;n++){const i=this._renderers[n]
;i.drawBackground&&i.drawBackground(t,e)}t.restore()}hitTest(t,e){let n=null;for(let i=this._renderers.length-1;i>=0;i--){const o=this._renderers[i].hitTest(t,e);null!==o&&(null===n||o.target()>n.target())&&(n=o)}return n}doesIntersectWithBox(t,e){return this._renderers.some((n=>!!n.doesIntersectWithBox&&n.doesIntersectWithBox(t,e)))}}},367637:(t,e,n)=>{n.d(e,{MediaCoordinatesPaneRenderer:()=>o});var i=n(743068);class o{draw(t,e){new i.CanvasRenderingTarget2D(t,e.mediaSize,e.bitmapSize).useMediaCoordinateSpace((t=>this._drawImpl(t)))}drawBackground(t,e){new i.CanvasRenderingTarget2D(t,e.mediaSize,e.bitmapSize).useMediaCoordinateSpace((t=>this._drawBackgroundImpl(t)))}_drawBackgroundImpl(t){}}},539040:(t,e,n)=>{n.d(e,{TextRenderer:()=>k,calculateLabelPosition:()=>x,fontSize:()=>I,getTextBoundaries:()=>_,lineSpacing:()=>M,needTextExclusionPath:()=>p,wordWrap:()=>P});var i=n(86441),o=n(650151),a=n(934026),r=n(881025),s=n(509078),l=n(665798),d=n(281090),h=n(124829),u=n(631088),c=n(666574),g=n(828473),f=n(5486);function x(t,e,n,o,a){const r=.5*(e.x+n.x);let s=n.y;return e.y>n.y?(s-=t.height/2+o.y,s=Math.max(t.height/2,s)):(s+=t.height/2+o.y,s=Math.min(a-t.height/2,s)),new i.Point(r,s)}function _(t,e,n){if(t.isOutOfScreen(e,n))return null;const i=t.getPolygonPoints();return 0===i.length?null:i}function p(t){const e=t.getLinesInfo().lines;if(e.length%2==0)return!1;if(""===e[Math.floor(e.length/2)].text.trim())return!1;return!0}function b(t){const e=[];do{const n=t.match(/\s+/);if(!n||void 0===n.index||-1===n.index){e.push({word:t,spaces:""});break}e.push({word:t.slice(0,n.index),spaces:n[0]}),t=t.slice(n.index+n[0].length)}while(t.length);return e}function w(t,e,n,i){const o=[],a=[];for(let e=0;e<t.length;++e)a.push(e);for(;t.length;){const r=Math.max(1,(0,g.upperbound)(a,i,((i,o)=>(0,u.measureText)(t.slice(0,o+1),e,n).width>i),0,t.length));o.push(t.slice(0,r)),t=t.slice(r)}return o}function P(t,e,n,i=!0,o){o=(0,h.isString)(o)?parseInt(o):o;const a=(t+="").split(/\r\n|\r|\n|$/).map((t=>({text:t,hidden:!1,wrappedLinePart:!1,wrappedLineEnd:!1})));if(!(0,h.isNumber)(o)||!isFinite(o)||o<=0)return a;if((0,u.measureText)("x",e,n).width>o)return a;const r=[];for(let t=0;t<a.length;t++){const s=a[t];if((0,u.measureText)(s.text,e,n).width<=o){r.push(s);continue}const l=b(s.text),d=!0;let h="",c=0;for(;c<l.length;){const t=l[c];let a=`${h}${t.word}`,s=(0,u.measureText)(a,e,n).width;if(s>o){if(""!==h)r.push({text:h,hidden:!1,wrappedLinePart:d,wrappedLineEnd:!1}),h="";else if(1===a.length)r.push({text:a,hidden:!1,wrappedLinePart:d,wrappedLineEnd:!0}),t.word="";else{const i=w(a,e,n,o);for(let t=0;t<i.length-1;t+=1)r.push({text:i[t],hidden:!1,wrappedLinePart:d,wrappedLineEnd:!1});t.word=i[i.length-1]}continue}let g=a.length;if(a=`${h}${t.word}${t.spaces}`,s=(0,u.measureText)(a,e,n).width,s<o){h=a,c+=1;continue}const f=w(a,e,n,o);for(let t=0;t<f.length;t+=1){const e=f[t];g-=e.length;const n={text:e,hidden:t>0,wrappedLinePart:d,wrappedLineEnd:c===l.length-1&&t===f.length-1};n.hidden&&i||r.push(n)}h="",c+=1}""!==h&&r.push({text:h,
wrappedLinePart:d,hidden:!1,wrappedLineEnd:!0})}return r}function m(t,e,n){if(0===n)return t.clone();const o=(t.x-e.x)*Math.cos(n)-(t.y-e.y)*Math.sin(n)+e.x,a=(t.x-e.x)*Math.sin(n)+(t.y-e.y)*Math.cos(n)+e.y;return new i.Point(o,a)}function S(t,e){var n,i,o;const a=null===(n=t.decorator)||void 0===n?void 0:n.geometry(t),r=Math.round(e+R(t)+L(t)+(null!==(i=null==a?void 0:a.width)&&void 0!==i?i:0)+(0===t.text.length?0:null!==(o=null==a?void 0:a.decoratorAndTextMargin)&&void 0!==o?o:0));return r%2?r+1:r}function v(t,e){return I(t)*e+M(t)*(e-1)+2*T(t)}function T(t){return void 0!==t.boxPaddingVert?t.boxPaddingVert*z(t):void 0!==t.boxPadding?t.boxPadding*z(t):I(t)/3}function y(t){return void 0!==t.boxPaddingHorz?t.boxPaddingHorz*z(t):void 0!==t.boxPadding?t.boxPadding*z(t):I(t)/3}function R(t){return void 0!==t.boxPaddingLeft?t.boxPaddingLeft*z(t):y(t)}function L(t){return void 0!==t.boxPaddingRight?t.boxPaddingRight*z(t):y(t)}function M(t){return(t.padding||0)*z(t)}function I(t){return Math.ceil(W(t)*z(t))}function W(t){return t.fontsize||t.fontSize||30}function z(t){const e=Math.min(1,Math.max(.2,t.scale||1));if(1===e)return e;const n=W(t);return Math.ceil(e*n)/n}class k{constructor(t,e){this._data=null,this._textWidthCache=new f.TextWidthCache,this._internalData=null,this._boxSize=null,this._polygonPoints=null,this._linesInfo=null,this._fontInfo=null,this._centerTextRotationPoint=null,this._rotationPoint=null,this._hitTest=e||new s.HitTestResult(s.HitTarget.MovePoint,{areaName:s.AreaName.Text}),void 0!==t&&this.setData(t)}setHitTest(t){this._hitTest=t}data(){return this._data}updateData(t){this.setData({...(0,o.ensureNotNull)(this._data),...t})}setData(t){null!==t?((0,o.assert)(!t.decorator||void 0===t.wordWrapWidth,"Decorator is not supported with wordWrapWidth"),void 0===t.text&&(t.text=""),t.horzTextAlign||(t.horzTextAlign=t.horzAlign),!function(t,e){if(null===t||null===e)return null===t==(null===e);if(void 0===t.points!=(void 0===e.points))return!1;if(void 0!==t.points&&void 0!==e.points){if(t.points.length!==e.points.length)return!1;for(let o=0;o<t.points.length;++o)if(n=t.points[o],i=e.points[o],n.x!==i.x||n.y!==i.y)return!1}var n,i;return t.text===e.text&&t.decorator===e.decorator&&t.vertAlign===e.vertAlign&&t.horzAlign===e.horzAlign&&t.horzTextAlign===e.horzTextAlign&&t.font===e.font&&t.offsetX===e.offsetX&&t.offsetY===e.offsetY&&t.bold===e.bold&&t.italic===e.italic&&t.fontsize===e.fontsize&&t.fontSize===e.fontSize&&t.backgroundRoundRect===e.backgroundRoundRect&&t.forceTextAlign===e.forceTextAlign&&t.wordWrapWidth===e.wordWrapWidth&&t.forceCalculateMaxLineWidth===e.forceCalculateMaxLineWidth&&t.padding===e.padding&&t.scale===e.scale&&t.highlightBorder===e.highlightBorder&&t.boxPadding===e.boxPadding&&t.boxPaddingVert===e.boxPaddingVert&&t.boxPaddingLeft===e.boxPaddingLeft&&t.boxPaddingRight===e.boxPaddingRight&&t.boxPaddingHorz===e.boxPaddingHorz&&t.angle===e.angle&&t.maxHeight===e.maxHeight&&(0,h.deepEquals)(t.boxShadow,e.boxShadow)[0]}(this._data,t)?(this._data=t,this._internalData=null,this._boxSize=null,
this._polygonPoints=null,this._centerTextRotationPoint=null,this._rotationPoint=null,this._linesInfo=null,this._fontInfo=null):this._data=t):this._data=null}hitTest(t){return null===this._data||void 0===this._data.points||0===this._data.points.length?null:(0,a.pointInPolygon)(t,this.getPolygonPoints())?this._hitTest:null}doesIntersectWithBox(t){return null!==this._data&&void 0!==this._data.points&&0!==this._data.points.length&&(0,a.pointInBox)(this._data.points[0],t)}measure(){if(null===this._data)return{width:0,height:0};const t=this._getBoxSize();return{width:t.boxWidth,height:t.boxHeight}}rect(){if(null===this._data)return{x:0,y:0,width:0,height:0};const t=this._getInternalData();return{x:t.boxLeft,y:t.boxTop,width:t.boxWidth,height:t.boxHeight}}isOutOfScreen(t,e){if(null===this._data||void 0===this._data.points||0===this._data.points.length)return!0;const n=this._getInternalData();if(n.boxLeft+n.boxWidth<0||n.boxLeft>t){const n=(0,i.box)(new i.Point(0,0),new i.Point(t,e));return this.getPolygonPoints().every((t=>!(0,a.pointInBox)(t,n)))}return!1}setPoints(t,e){(0,o.ensureNotNull)(this._data).points=t,this._hitTest=e||new s.HitTestResult(s.HitTarget.MovePoint)}setPoint(t,e,n){const i=(0,o.ensureNotNull)(this._data);this.setData({...i,points:[t],offsetX:null!=e?e:i.offsetX,offsetY:null!=n?n:i.offsetY})}point(){var t,e,n;return null!==(n=null===(e=null===(t=this._data)||void 0===t?void 0:t.points)||void 0===e?void 0:e[0])&&void 0!==n?n:null}fontStyle(t){return null===this._data?"":this._getFontInfo().fontStyle}lineHeight(){return null===this._data?0:I(this._data)}lineSpacing(){return null===this._data?0:M(this._data)}draw(t,e){var n;if(null===this._data||void 0===this._data.points||0===this._data.points.length)return;const{mediaSize:a,horizontalPixelRatio:r,verticalPixelRatio:s}=e;if(this.isOutOfScreen(a.width,a.height))return;const d=this._getInternalData(),h=(0,o.ensureNotNull)(this.rotation()),g=(0,i.point)(h.x*r,h.y*s);t.save(),0!==h.angle&&(t.translate(g.x,g.y),t.rotate(h.angle),t.translate(-g.x,-g.y));const f=this._getFontInfo().fontSize;t.textBaseline=d.textBaseLine,t.textAlign=d.textAlign,t.font=this.fontStyle();const{scaledLeft:x,scaledRight:_,scaledTop:p,scaledBottom:b}=function(t,e){const{horizontalPixelRatio:n,verticalPixelRatio:i}=e,o=Math.round(t.boxLeft*n),a=Math.round(t.boxTop*i);return{scaledLeft:o,scaledRight:o+Math.round(t.boxWidth*n),scaledTop:a,scaledBottom:a+Math.round(t.boxHeight*i)}}(d,e);if(this._data.backgroundColor||this._data.borderColor||this._data.highlightBorder&&this._data.wordWrapWidth){const e=this._data.borderWidth||Math.max(f/12,1),n=Math.round(e*r),i=n/2;let o=!1;if(this._data.boxShadow){t.save();const{shadowColor:e,shadowBlur:n,shadowOffsetX:i=0,shadowOffsetY:a=0}=this._data.boxShadow;t.shadowColor=e,t.shadowBlur=n,t.shadowOffsetX=i,t.shadowOffsetY=a,o=!0}if(this._data.backgroundRoundRect)this._data.backgroundColor&&((0,l.drawRoundRect)(t,x,p,_-x,b-p,this._data.backgroundRoundRect*r),t.fillStyle=this._data.backgroundColor,t.fill(),o&&(t.restore(),o=!1)),
this._data.borderColor&&((0,l.drawRoundRect)(t,x-i,p-i,_-x+n,b-p+n,this._data.backgroundRoundRect*r+n),t.strokeStyle=this._data.borderColor,t.lineWidth=n,t.stroke(),o&&(t.restore(),o=!1));else if(this._data.backgroundColor&&(t.fillStyle=this._data.backgroundColor,t.fillRect(x,p,_-x,b-p),o&&(t.restore(),o=!1)),this._data.borderColor||this._data.highlightBorder){let e;this._data.borderColor?(t.strokeStyle=this._data.borderColor,e=n):(t.strokeStyle=this._data.highlightBorderColor||this._data.color,(0,l.setLineStyle)(t,c.LINESTYLE_DASHED),e=Math.max(1,Math.floor(r))),t.lineWidth=e,t.beginPath(),t.moveTo(x-e/2,p-e/2),t.lineTo(x-e/2,b+e/2),t.lineTo(_+e/2,b+e/2),t.lineTo(_+e/2,p-e/2),t.lineTo(x-e/2,p-e/2),t.stroke(),o&&t.restore()}}this._drawSelectionIfNeeded(t,e),t.fillStyle=this._data.color;const w=(x+Math.round(d.textHorizStart*r))/r,P=.05*f;let m=(p+Math.round((d.textVertStart+P)*s))/s;const S=M(this._data),v=this.getLinesInfo();for(const e of v.lines)(0,u.drawScaled)(t,r,s,(()=>t.fillText(e.text,w,m))),m+=f+S;null===(n=this._data.decorator)||void 0===n||n.draw(t,e,this._data,d),t.restore()}getPolygonPoints(){if(null!==this._polygonPoints)return this._polygonPoints;if(null===this._data)return[];const t=this._data.angle||0,{boxLeft:e,boxTop:n,boxWidth:o,boxHeight:a}=this._getInternalData(),r=this._getRotationPoint();return this._polygonPoints=[m(new i.Point(e,n),r,t),m(new i.Point(e+o,n),r,t),m(new i.Point(e+o,n+a),r,t),m(new i.Point(e,n+a),r,t)],this._polygonPoints}centerTextRotation(){var t;if(null===this._centerTextRotationPoint&&null!==this._data){const e=null!==(t=this._data.angle)&&void 0!==t?t:0,n=this._getRotationPoint(),{textLeft:o,textTop:a,textRight:r,textBottom:s}=this._getInternalData(),l=m(new i.Point((o+r)/2,(a+s)/2),n,e);this._centerTextRotationPoint={x:l.x,y:l.y,angle:e}}return this._centerTextRotationPoint}rotation(){var t;if(null===this._rotationPoint&&null!==this._data){const e=null!==(t=this._data.angle)&&void 0!==t?t:0,n=this._getRotationPoint();this._rotationPoint={x:n.x,y:n.y,angle:e}}return this._rotationPoint}getLinesInfo(){if(null===this._linesInfo){const t=(0,o.ensureNotNull)(this._data),e=P(t.text,this.fontStyle(),this._textWidthCache,!1,t.wordWrapWidth);let n=e.filter((t=>!t.hidden));if(void 0!==t.maxHeight){const e=function(t){const e=(0,o.ensureDefined)(t.maxHeight),n=I(t),i=M(t);return Math.floor((e+i)/(n+i))}(t);n.length>e&&(n=n.slice(0,e))}this._linesInfo={linesMaxWidth:this._getLinesMaxWidth(n),linesIncludingHidden:e,lines:n}}return this._linesInfo}positionToCoordinate(t){const e=(0,o.ensureNotNull)(this._data),n=this._getInternalData(),i=this.getLinesInfo(),{x:a,y:r,lineNumber:s}=(0,d.getSymbolCoordinatesInfo)({symbolPosition:t,textWidth:n.textRight-n.textLeft,textByLines:i.linesIncludingHidden,lineHeight:I(e),font:this.fontStyle(),textAlign:n.textAlign,lineSpacing:this.lineSpacing()});return{x:a+n.textLeft,y:r+n.textTop,lineNumber:s}}_getInternalData(){var t,e,n;if(null!==this._internalData)return this._internalData;const i=(0,
o.ensureNotNull)(this._data),a=this._getBoxSize(),s=a.boxWidth,l=a.boxHeight,d=(0,o.ensureDefined)(i.points)[0];let h=d.y;switch(i.vertAlign){case"bottom":h-=l+i.offsetY;break;case"middle":h-=l/2;break;case"top":h+=i.offsetY}let u=d.x;const c=R(i),g=L(i),f=T(i),x=null===(t=i.decorator)||void 0===t?void 0:t.geometry(i),_=null!==(e=null==x?void 0:x.width)&&void 0!==e?e:0,p=0===i.text.length?0:null!==(n=null==x?void 0:x.decoratorAndTextMargin)&&void 0!==n?n:0,b=null==x?void 0:x.ignoreRtl,w=_+p;let P;const m=h+f+I(i)/2;let S;switch(i.horzAlign){case"left":u+=i.offsetX;break;case"center":u-=s/2;break;case"right":u-=s+i.offsetX}const v=(0,r.isRtl)(),y=v&&!b,M=y?u+s-g-_:u+c;switch((0,o.ensureDefined)(i.horzTextAlign)){case"left":S="start",P=M+w,v&&(i.forceTextAlign?S="left":(P=y?M-p:u+s-g,S="right"));break;case"center":S="center";const t=s-c-g-w;P=y?M-p-t/2:M+w+t/2;break;case"right":S="end",P=y?M-p:u+s-g,v&&i.forceTextAlign&&(S="right")}return this._internalData={boxLeft:u,boxTop:h,boxWidth:s,boxHeight:l,textLeft:u+c+(y?0:w),textRight:u+s-g-(y?w:0),textTop:h+f,textBottom:h+l-f,textHorizStart:P-u,textVertStart:m-h,textAlign:S,textBaseLine:"middle",decoratorLeft:M,decoratorWidth:_},this._internalData}_getFontInfo(){if(null===this._fontInfo){const t=(0,o.ensureNotNull)(this._data),e=I(t),n=(t.bold?"bold ":"")+(t.italic?"italic ":"")+e+"px "+t.font;this._fontInfo={fontStyle:n,fontSize:e}}return this._fontInfo}_drawSelectionIfNeeded(t,e){const n=(0,o.ensureNotNull)(this._data),i=I((0,o.ensureNotNull)(this._data));if(n.selectionHighlight){const o=this.positionToCoordinate(n.selectionHighlight.start),a=this.positionToCoordinate(n.selectionHighlight.end),r=this._getInternalData();(0,d.drawSelection)(t,e,{lines:this.getLinesInfo().linesIncludingHidden,selectionStart:o,selectionEnd:a,left:r.textLeft,right:r.textRight,color:n.selectionHighlight.color,font:this.fontStyle(),lineHeight:i,lineSpacing:this.lineSpacing()})}}_getLinesMaxWidth(t){const e=this.fontStyle();if(null!==this._data&&this._data.wordWrapWidth&&!this._data.forceCalculateMaxLineWidth)return this._data.wordWrapWidth*z(this._data);let n=0;for(const i of t)n=Math.max(n,(0,u.measureText)(i.text,e,this._textWidthCache).width);return n}_getBoxSize(){if(null===this._boxSize){const t=this.getLinesInfo(),e=(0,o.ensureNotNull)(this._data);this._boxSize={boxWidth:S(e,t.linesMaxWidth),boxHeight:v(e,t.lines.length)}}return this._boxSize}_getRotationPoint(){const{boxLeft:t,boxTop:e,boxWidth:n,boxHeight:a}=this._getInternalData(),{horzAlign:r,vertAlign:s}=(0,o.ensureNotNull)(this._data);let l,d;switch(r){case"center":l=t+n/2;break;case"left":l=t;break;case"right":l=t+n}switch(s){case"middle":d=e+a/2;break;case"top":d=e;break;case"bottom":d=e+a}return new i.Point(l,d)}}}}]);